<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> ğŸ›¡ï¸ BlueTeam CheatSheet Â· yunshiuan</title><meta name="description" content="ğŸ›¡ï¸ BlueTeam CheatSheet - yunshiuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/assets/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yunshiuan.com/atom.xml" title="yunshiuan"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="yunshiuan" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/assets/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="https://github.com/YunshiuanOAO" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/assets/CV.pdf" target="_self" class="nav-list-link">CV</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">ğŸ›¡ï¸ BlueTeam CheatSheet</h1><div class="post-info">Aug 12, 2025</div><div class="post-content"><p>In this note, I organize the commons blue team skill</p>
<h2 id="Event-code"><a href="#Event-code" class="headerlink" title="Event code"></a>Event code</h2><h3 id="Winlog"><a href="#Winlog" class="headerlink" title="Winlog"></a>Winlog</h3><table>
<thead>
<tr>
<th>Event ID</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody><tr>
<td>4104</td>
<td>Windows powershell åŸ·è¡Œæ—¥è¨˜</td>
</tr>
<tr>
<td>4624</td>
<td>ç™»å…¥æˆåŠŸ</td>
</tr>
<tr>
<td>4625</td>
<td>ç™»å…¥å¤±æ•—</td>
</tr>
<tr>
<td>4648</td>
<td>æ˜ç¢ºå¸³è™Ÿç™»å…¥ï¼ˆå¦‚ RunAsï¼‰</td>
</tr>
<tr>
<td>4672</td>
<td>ç‰¹æ¬Šç™»å…¥ï¼ˆå¦‚ admin ç™»å…¥ï¼‰</td>
</tr>
<tr>
<td>4634</td>
<td>ä½¿ç”¨è€…ç™»å‡º</td>
</tr>
<tr>
<td>4662</td>
<td>Active Directory (AD) ç‰©ä»¶ä¸ŠåŸ·è¡Œäº†æŸé …æ“ä½œ ( åµæ¸¬ Dscync ï¼Œå°¤å…¶æ˜¯ä¸€èˆ¬ä½¿ç”¨è€…å­˜å–æ™‚)</td>
</tr>
<tr>
<td>4688</td>
<td>å»ºç«‹æ–°ç¨‹åºï¼ˆç¨‹å¼å•Ÿå‹•ï¼‰</td>
</tr>
<tr>
<td>4689</td>
<td>ç¨‹å¼çµæŸ</td>
</tr>
<tr>
<td>4697</td>
<td>å®‰è£æ–°æœå‹™ï¼ˆå¸¸ç”¨æ–¼æƒ¡æ„æŒä¹…åŒ–ï¼‰</td>
</tr>
<tr>
<td>4720</td>
<td>å»ºç«‹æ–°å¸³è™Ÿ</td>
</tr>
<tr>
<td>4722</td>
<td>å•Ÿç”¨å¸³æˆ¶</td>
</tr>
<tr>
<td>4723</td>
<td>å˜—è©¦è®Šæ›´è‡ªå·±çš„å¯†ç¢¼</td>
</tr>
<tr>
<td>4724</td>
<td>å˜—è©¦ç‚ºä»–äººè®Šæ›´å¯†ç¢¼</td>
</tr>
<tr>
<td>4725</td>
<td>åœç”¨å¸³æˆ¶</td>
</tr>
<tr>
<td>4726</td>
<td>åˆªé™¤å¸³æˆ¶</td>
</tr>
<tr>
<td>4732</td>
<td>ä½¿ç”¨è€…è¢«åŠ å…¥ç¾¤çµ„</td>
</tr>
<tr>
<td>4768</td>
<td>Kerberos TGT è«‹æ±‚</td>
</tr>
<tr>
<td>4769</td>
<td>Kerberos æœå‹™ç¥¨è­‰è«‹æ±‚</td>
</tr>
<tr>
<td>4776</td>
<td>NTLM é©—è­‰è«‹æ±‚</td>
</tr>
<tr>
<td>5140</td>
<td>å­˜å–å…±ç”¨è³‡æ–™å¤¾</td>
</tr>
<tr>
<td>5156</td>
<td>é˜²ç«ç‰†å…è¨±çš„ç¶²è·¯é€£ç·šï¼ˆNetConn äº‹ä»¶ï¼‰</td>
</tr>
<tr>
<td>7045</td>
<td>å®‰è£æœå‹™ï¼ˆSystem logï¼Œä¹Ÿå¯ç›£æ§æŒä¹…åŒ–ï¼‰</td>
</tr>
</tbody></table>
<h2 id="Sysmon"><a href="#Sysmon" class="headerlink" title="Sysmon"></a><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-tw/sysinternals/downloads/sysmon">Sysmon</a></h2><ul>
<li>å¯ä»¥çœ‹åˆ°æ›´åº•å±¤çš„è³‡è¨Šï¼ŒåŒ…å«æª”æ¡ˆçš„æ›´æ–°æˆ–è€…å‰µå»ºç­‰ç­‰</li>
<li>å¯ä»¥ç”¨ <a target="_blank" rel="noopener" href="https://github.com/nshalabi/SysmonTools">Sysmon view</a> æŸ¥çœ‹</li>
</ul>
<table>
<thead>
<tr>
<th>Event ID</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Process Createï¼ˆç¨‹å¼å•Ÿå‹•ï¼‰</td>
</tr>
<tr>
<td>2</td>
<td>File creation time changedï¼ˆæ™‚é–“æˆ³è¢«ä¿®æ”¹ï¼‰</td>
</tr>
<tr>
<td>3</td>
<td>Network connectionï¼ˆTCP é€£ç·šï¼‰</td>
</tr>
<tr>
<td>5</td>
<td>Process Terminateï¼ˆç¨‹å¼çµ‚æ­¢ï¼‰</td>
</tr>
<tr>
<td>6</td>
<td>Driver Loadedï¼ˆé©…å‹•è¼‰å…¥ï¼‰</td>
</tr>
<tr>
<td>7</td>
<td>Image Loadedï¼ˆDLLè¼‰å…¥ï¼‰</td>
</tr>
<tr>
<td>8</td>
<td>CreateRemoteThreadï¼ˆé ç«¯åŸ·è¡Œç·’æ³¨å…¥ï¼‰</td>
</tr>
<tr>
<td>9</td>
<td>RawAccessReadï¼ˆç£ç¢ŸåŸå§‹å­˜å–ï¼‰</td>
</tr>
<tr>
<td>10</td>
<td>ProcessAccessï¼ˆç¨‹å¼å­˜å–ä»–äººè¨˜æ†¶é«”ï¼‰</td>
</tr>
<tr>
<td>11</td>
<td>File Createï¼ˆæª”æ¡ˆå»ºç«‹ï¼‰</td>
</tr>
<tr>
<td>12</td>
<td>Registry Key Createï¼ˆè¨»å†Šè¡¨éµå»ºç«‹ï¼‰</td>
</tr>
<tr>
<td>13</td>
<td>Registry Value Setï¼ˆè¨»å†Šè¡¨å€¼ä¿®æ”¹ï¼‰</td>
</tr>
<tr>
<td>14</td>
<td>Registry Key Deleteï¼ˆè¨»å†Šè¡¨éµåˆªé™¤ï¼‰</td>
</tr>
<tr>
<td>15</td>
<td>FileCreateStreamHashï¼ˆå»ºç«‹ ADSï¼‰</td>
</tr>
<tr>
<td>22</td>
<td>DNS Queryï¼ˆDNS æŸ¥è©¢äº‹ä»¶ï¼‰</td>
</tr>
<tr>
<td>23</td>
<td>File Deleteï¼ˆæª”æ¡ˆåˆªé™¤ï¼‰</td>
</tr>
<tr>
<td>25</td>
<td>Process Tamperingï¼ˆç¨‹å¼è¨˜æ†¶é«”è¢«ä¿®æ”¹ï¼‰</td>
</tr>
<tr>
<td>26</td>
<td>File Deleted and Overwrittenï¼ˆé˜²æ­¢å–è­‰ï¼‰</td>
</tr>
<tr>
<td>255</td>
<td>Sysmon è¨­å®šè¢«ä¿®æ”¹ï¼ˆConfig changeï¼‰</td>
</tr>
</tbody></table>
<h2 id="IDS-IPS"><a href="#IDS-IPS" class="headerlink" title="IDS&#x2F;IPS"></a>IDS&#x2F;IPS</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://www.ossec.net/">OSSEC</a></p>
<ul>
<li>HIDS</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://suricata.io/">Suricata</a></p>
<ul>
<li><p>Suricata æ˜¯ä¸€å€‹é–‹æºçš„å…¥ä¾µåµæ¸¬ç³»çµ±ï¼ˆIDSï¼‰èˆ‡å…¥ä¾µé˜²ç¦¦ç³»çµ±ï¼ˆIPSï¼‰ï¼Œä»¥æ·±åº¦å°åŒ…æª¢æ¸¬ã€æµé‡åˆ†æèˆ‡å¨è„…åµæ¸¬èåã€‚èƒ½ä½¿ç”¨ Suricata çš„é¾å¤§è¦å‰‡é›†å¿«é€Ÿè©•ä¼°ç¶²è·¯è³‡æ–™ä¸¦è¾¨è­˜ç•°å¸¸ã€‚</p>
<p>æŒ‡ä»¤å¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">suricata -r B33F50up_blog.pcapng <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä»–æœƒç”¢ç”Ÿå››å€‹æª”æ¡ˆ</p>
<ul>
<li>eve.json : Suricataçš„çµæ§‹åŒ–æ—¥èªŒæª”æ¡ˆï¼ŒåŒ…å«å¤šç¨®äº‹ä»¶é¡å‹çš„è©³ç´°è¨˜éŒ„</li>
<li>fast.log : Suricata å¿«é€Ÿè­¦å ±æ—¥èªŒï¼ŒåŒ…å«æª¢æ¸¬åˆ°çš„å®‰å…¨å¨è„…è­¦å ±</li>
<li>stats.log : Suricata é‹è¡Œçµ±è¨ˆè³‡æ–™ï¼ŒåŒ…å«è©³ç´°çš„ç³»çµ±é‹è¡Œçµ±è¨ˆ</li>
<li>suricata.log : Suricata ä¸»è¦é‹è¡Œæ—¥èªŒï¼ŒåŒ…å«ç³»çµ±å•Ÿå‹•å’Œé‹è¡Œè³‡è¨Š</li>
</ul>
<p><img src="/assets/5LROwbAnig-tGtRpsi7V6Ig8OL3X9F9e3CxpqHcjWvs=.png"></p>
<p>ä»¥ä¸‹æ˜¯ fast.log è³‡è¨Š</p>
<pre class="line-numbers language-none"><code class="language-none">08&#x2F;09&#x2F;2025-02:53:47.165861  [**] [1:2019284:3] ET ATTACK_RESPONSE Output of id command from HTTP server [**] [Classification: Potentially Bad Traffic] [Priority: 2] &#123;TCP&#125; 192.168.1.125:5000 -&gt; 100.112.165.2:60865
08&#x2F;09&#x2F;2025-02:56:49.767871  [**] [1:2002034:13] ET ATTACK_RESPONSE Possible &#x2F;etc&#x2F;passwd via HTTP (linux style) [**] [Classification: Information Leak] [Priority: 2] &#123;TCP&#125; 192.168.1.125:5000 -&gt; 100.112.165.2:61207<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p><code>ls -lah /etc/suricata/rules/</code> see all rulus</p>
</li>
<li><p><code>suricata -r test.pcap</code> create various logs(etc eve.json,fast.logâ€¦)</p>
</li>
<li><p><code>suricata --pcap=ens160 -vv</code>  Suricataâ€™s (Live) LibPCAP mod</p>
</li>
<li><p><code>cat /var/log/suricata/old_eve.json | jq -c &#39;select(.event_type == &quot;http&quot;)&#39; | head -1 | jq </code>quury example</p>
</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/activecm/rita">RITA</a></p>
<ul>
<li>detect C2</li>
<li>&#96;&#96;</li>
<li><a target="_blank" rel="noopener" href="https://cn-sec.com/archives/1901157.html">simple tour</a></li>
<li><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/m/articles/10209273">simple tour2</a></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.snort.org/">Snort</a></p>
<ul>
<li>example:</li>
</ul>
  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sudo snort -c &#x2F;root&#x2F;snorty&#x2F;etc&#x2F;snort&#x2F;snort.lua --daq-dir &#x2F;usr&#x2F;local&#x2F;lib&#x2F;daq -R &#x2F;home&#x2F;htb-student&#x2F;local.rules -r &#x2F;home&#x2F;htb-student&#x2F;pcaps&#x2F;cerber.pcap -A cmg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sudo snort -c &#x2F;root&#x2F;snorty&#x2F;etc&#x2F;snort&#x2F;snort.lua --daq-dir &#x2F;usr&#x2F;local&#x2F;lib&#x2F;daq \
-r XXX.pcap<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sudo snort -c &#x2F;root&#x2F;snorty&#x2F;etc&#x2F;snort&#x2F;snort.lua --daq-dir &#x2F;usr&#x2F;local&#x2F;lib&#x2F;daq \
-i ens160<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>Zeek </p>
<ul>
<li><p>Zeek æ˜¯ä¸€å€‹é–‹æºçš„ç¶²è·¯å®‰å…¨ç›£æ§å·¥å…·ï¼Œä»¥å¼·å¤§çš„è³‡æ–™è¨˜éŒ„åŠŸèƒ½èåã€‚å®ƒèƒ½å°‡åŸå§‹çš„ pcap å°åŒ…æª”è½‰æ›æˆçµæ§‹åŒ–çš„æ—¥èªŒï¼Œæ–¹ä¾¿åœ¨ Zeek å…§æŸ¥è©¢èˆ‡åˆ†æï¼Œå¿«é€Ÿæä¾›ç¶²è·¯è¡Œç‚ºçš„æ¦‚è¦½ã€‚</p>
<p>æŒ‡ä»¤å¦‚ä¸‹</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">zeek -C -r B33F50up_blog.pcapng<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä»–æœƒç”¢ç”Ÿä»¥ä¸‹æª”æ¡ˆ</p>
<ul>
<li>conn.log  : è¨˜éŒ„äº†æ‰€æœ‰çš„ç¶²è·¯é€£æ¥</li>
<li>dns.logï¼šè¨˜éŒ„äº†æ‰€æœ‰çš„ DNSæŸ¥è©¢æ´»å‹•</li>
<li>files.logï¼šè¨˜éŒ„äº†é€šé HTTP å‚³è¼¸çš„æª”æ¡ˆ</li>
<li>http.logï¼šé€™æ˜¯ä¸€å€‹ HTTP å”è­°çš„æµé‡æ—¥èªŒï¼Œè¨˜éŒ„äº†ç¶²é ç€è¦½å’ŒAPI è«‹æ±‚</li>
<li>packet_filter.logï¼šè¨˜éŒ„äº†å°åŒ…éæ¿¾å™¨çš„é…ç½®</li>
</ul>
<p><img src="/assets/wEXC7MUEGLZqmjPBWvXxb9gL4cWzTN2L6JHdh9dc1cA=.png"></p>
<p>ä»¥ä¸‹æ˜¯http.log çš„å½¢å¼</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">#separator \x09
#set_separator	,
#empty_field	(empty)
#unset_field	-
#path	http
#open	2025-09-27-22-26-52
#fields	ts	uid	id.orig_h	id.orig_p	id.resp_h	id.resp_p	trans_depth	method	host	uri	referrer	version	user_agent	origin	request_body_len	response_body_len	status_code	status_msg	info_code	info_msg	tags	username	password	proxied	orig_fuids	orig_filenames	orig_mime_types	resp_fuids	resp_filenames	resp_mime_types
#types	time	string	addr	port	addr	port	count	string	string	string	string	string	string	string	count	count	count	string	count	string	set[enum]	string	string	set[string]	vector[string]	vector[string]	vector[string]	vector[string]	vector[string]	vector[string]
1754678828.272075	CAuRo91flufxXutAke	100.112.165.2	60665	192.168.1.125	5000	1	GET	192.168.1.125:5000	&#x2F;	-	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	-	0	24859	200	OK	-	-	(empty)	-	-	-	-	-	-	FA9Bk7Ikrr1LVrys	-	text&#x2F;html
1754678857.820963	CIRhMK1X97Z1MzFRD1	100.112.165.2	60676	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	15	727	200	OK	-	-	(empty)	-	-	-	FIUrzJ3sbt6deYBXf3	-	text&#x2F;plain	FyILV9CHbcmUMGtc6	-	text&#x2F;json
1754678865.293310	CZnidTF5LIgaMzbRe	100.112.165.2	60677	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;system	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	141	185	200	OK	-	-	(empty)	-	-	-	Fvs6lg41SIyuYsReh2	-	-	FqFYD91bNrEWRNR501	-	text&#x2F;json
1754679070.738945	CWlCIn4qK2ntw6CuJl	100.112.165.2	60757	192.168.1.125	5000	1	GET	192.168.1.125:5000	&#x2F;	-	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	-	0	24859	200	OK	-	-	(empty)	-	-	-	-	-	-	FG2QH72aF2jeG9CYC9	-	text&#x2F;html
1754679165.228123	C5V1Fn3nYAvFuSQeE	100.112.165.2	60778	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;system	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	141	287	200	OK	-	-	(empty)	-	-	-	FnwtMr2TZ1qIS6LLmj	-	-	Fq827u4xABcX563I21	-	text&#x2F;json
1754679173.669096	CWXpsv3zrBE7Lx66Sg	100.112.165.2	60779	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;system	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	144	13177	200	OK	-	-	(empty)	-	-	-	FxvTqN3Pid7VWQP7y3	-	-	Fi4rGH32Y4P77kznf3	-	text&#x2F;json
1754679180.268390	Co6odn3WTbf9HKGcO6	100.112.165.2	60780	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	15	728	200	OK	-	-	(empty)	-	-	-	FYW00SjDihqYC30xe	-	text&#x2F;plain	FQGbYm3SH1rsO8o9ng	-	text&#x2F;json
1754679196.383809	CGjLWoznypKV0Pgt	100.112.165.2	60809	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	16	738	200	OK	-	-	(empty)	-	-	-	FVCJDglco6ai9lzi4	-	text&#x2F;plain	FB2a4L3x3ZELSSdCQ1	-	text&#x2F;json
1754679223.696243	C0s1KA7ZrfQvnIpj	100.112.165.2	60865	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	30	851	200	OK	-	-	(empty)	-	-	-	FA2p79sD6MkhyaCEb	-	text&#x2F;plain	FwUGICEULGQRyBs78	-	text&#x2F;json
1754679257.891805	CtwrhY2Kw9bscBOsX7	100.112.165.2	60874	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	34	755	200	OK	-	-	(empty)	-	-	-	FybSTDKXBk5dCiaYl	-	text&#x2F;plain	F55jsD1S1vWW8IVBY4	-	text&#x2F;json
1754679265.650887	CFgfqH2IasZxXsovkd	100.112.165.2	60875	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	30	869	200	OK	-	-	(empty)	-	-	-	FtvRcZ3D5kRIP1ijy5	-	text&#x2F;plain	FTYdr5iKtJX11Efma	-	text&#x2F;json
1754679315.090163	CEAuN63ly0lHS2zRrj	100.112.165.2	60895	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	30	869	200	OK	-	-	(empty)	-	-	-	Fyt7jP30AEKPs4C0Uj	-	text&#x2F;plain	F0zHt852ycC25Gpkf	-	text&#x2F;json
1754679319.217264	CRWcyt2bda4K3g6Xub	100.112.165.2	60912	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	36	900	200	OK	-	-	(empty)	-	-	-	FUAgus1sr4pPeGnidg	-	text&#x2F;plain	FqnOWw20dfXD0koyIi	-	text&#x2F;json
1754679354.845803	CulPOq3A9IP8ab4Zqd	100.112.165.2	60981	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	48	769	200	OK	-	-	(empty)	-	-	-	FZw17aZHAnZltVkJ	-	text&#x2F;plain	FQvAYSOVPIbUCfRm7	-	text&#x2F;json
1754679406.575000	C9iy0scrJKJuDpi07	100.112.165.2	61207	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	49	2621	200	OK	-	-	(empty)	-	-	-	FiejrYnJjwTaJ5db7	-	text&#x2F;plain	FKZoSb4yddnL4uzkZf	-	text&#x2F;json
1754679827.575533	CV2dqm3aNuGOi4EC0h	100.112.165.2	63113	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	36	912	200	OK	-	-	(empty)	-	-	-	FDaXYp2bh8hJpHMYCi	-	text&#x2F;plain	FdsBU41nDrcCQ9mTV9	-	text&#x2F;json
1754679851.757452	CWSzgl4AsTyJVyRpJf	100.112.165.2	63213	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	44	800	200	OK	-	-	(empty)	-	-	-	FAGwfWDdjCLhcrZX2	-	text&#x2F;plain	F89dhl1uFy7r4oRtf	-	text&#x2F;json
1754679859.655497	C0LErP2jTxCqKmUESd	100.112.165.2	63216	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	47	781	200	OK	-	-	(empty)	-	-	-	FoNYJj2QlLyZkd9tEe	-	text&#x2F;plain	FUaGCH2RbcOlDQcaOi	-	text&#x2F;json
1754679875.655339	CqC0qj2SMoQnSfaju6	100.112.165.2	63217	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	31	762	200	OK	-	-	(empty)	-	-	-	FRGjia4iHeyPzIDRC3	-	text&#x2F;plain	FwGgDTGi2gHDik2P5	-	text&#x2F;json
1754679999.499748	CtN1Vk4RrwIRGOgwHc	100.112.165.2	63280	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	142	836	200	OK	-	-	(empty)	-	-	-	FFJx4j4PnbpIi0mfD6	-	text&#x2F;plain	FYpDmc37JMpCuz4Zac	-	text&#x2F;json
#close	2025-09-27-22-26-52
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦å¤–ä»–ä¹Ÿæœƒæ ¹æ“š pcap æª”ç”¢ç”Ÿå…¶ä»–log ï¼Œåƒè€ƒç¶²å€ï¼š<a target="_blank" rel="noopener" href="https://docs.zeek.org/en/master/logs/index.html">https://docs.zeek.org/en/master/logs/index.html</a></p>
</li>
</ul>
</li>
</ul>
<p>xml filter example</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>QueryList</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Query</span> <span class="token attr-name">Id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">Path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Sysmon/Operational<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Select</span> <span class="token attr-name">Path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Microsoft-Windows-Sysmon/Operational<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      *[
        System[
          (EventID=3)
          and TimeCreated[
            @SystemTime >= '2022-01-01T07:41:36.000Z'
            and @SystemTime &lt;= '2022-10-02T07:41:36.999Z'
          ]
        ]
        and EventData[
          Data[@Name='ProcessGuid']='a79137ec-af0f-6338-b702-00000000e901'
        ]
      ]
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Select</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Query</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>QueryList</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>




<h2 id="SIEM"><a href="#SIEM" class="headerlink" title="SIEM"></a>SIEM</h2><p>Continuously, for ongoing detection and alerting</p>
<h3 id="ELK-Stack"><a href="#ELK-Stack" class="headerlink" title="ELK Stack"></a><a target="_blank" rel="noopener" href="https://www.elastic.co/elastic-stack">ELK Stack</a></h3><p>ç›´æ¥ç”¨ docker æ¶èµ·ä¾†çš„æ–¹å¼ : <a target="_blank" rel="noopener" href="https://hackmd.io/@CHW/S1vy8V8ca#Elastic-stackELK-%E5%AE%89%E8%A3%9D-on-docker-%E4%B8%80%E9%8D%B5%E5%AE%89%E8%A3%9D">é€£çµ</a>  </p>
<h4 id="Elastic-Common-Schema-ECS"><a href="#Elastic-Common-Schema-ECS" class="headerlink" title="Elastic Common Schema (ECS)"></a>Elastic Common Schema (ECS)</h4><table>
<thead>
<tr>
<th>å­—æ®µé¡å‹</th>
<th>æè¿°</th>
<th>KQL ç¯„ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>event.category</td>
<td>å°‡äº‹ä»¶æŒ‰å¤§å‹é‚è¼¯é¡åˆ¥åˆ†çµ„ï¼Œé€šå¸¸èˆ‡â€event.categoryâ€å­—æ®µçµåˆä½¿ç”¨é€²è¡Œéæ¿¾æœç´¢</td>
<td>â€¢ event.category: authentication<br>â€¢ event.category: process<br>â€¢ event.category: file<br>â€¢ event.category: malware<br>â€¢ event.category: network</td>
</tr>
<tr>
<td>event.type</td>
<td>ä½œç‚ºå­åˆ†é¡ï¼Œé€šå¸¸èˆ‡â€event.categoryâ€å­—æ®µçµåˆä½¿ç”¨éæ¿¾æœç´¢</td>
<td>â€¢ event.type: creation<br>â€¢ event.type: deletion<br>â€¢ event.type: access</td>
</tr>
<tr>
<td>event.outcome</td>
<td>æŒ‡ç¤ºäº‹ä»¶æ˜¯å¦æˆåŠŸæˆ–å¤±æ•—</td>
<td>â€¢ event.outcome: success<br>â€¢ event.outcome: failure</td>
</tr>
</tbody></table>
<h4 id="Common-Search-Fields"><a href="#Common-Search-Fields" class="headerlink" title="Common Search Fields"></a>Common Search Fields</h4><table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>KQL ç¯„ä¾‹</th>
<th>è¼¸å‡º</th>
</tr>
</thead>
<tbody><tr>
<td>@timestamp</td>
<td>@timestamp: 2023-01-25</td>
<td>äº‹ä»¶ç™¼ç”Ÿæ™‚é–“çš„æ™‚é–“æˆ³ï¼ˆäº‹ä»¶ä¾†æºæ–¼è©²æ™‚é–“è€Œéæ›´æ—©æˆ–æ›´æ™šï¼‰</td>
</tr>
<tr>
<td>agent.name</td>
<td>agent.name: â€œDESKTOP*â€</td>
<td>å¾ä»£ç†åç¨±ä¸­æœç´¢æŒ‡å®šå­—ç¬¦ä¸¦é¡¯ç¤ºçµæœ</td>
</tr>
<tr>
<td>message</td>
<td>message: powershell</td>
<td>åœ¨ä»»ä½•å«æœ‰â€powershellâ€å­—ç¬¦çš„æ¶ˆæ¯ä¸­æœç´¢</td>
</tr>
</tbody></table>
<h4 id="Process-Related-Fields"><a href="#Process-Related-Fields" class="headerlink" title="Process Related Fields"></a>Process Related Fields</h4><table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>KQL ç¯„ä¾‹</th>
<th>è¼¸å‡º</th>
</tr>
</thead>
<tbody><tr>
<td>process.name</td>
<td>event.category: process and process.name: svchost</td>
<td>å°‹æ‰¾é€²ç¨‹åç‚ºsvchostçš„æ‰€æœ‰é€²ç¨‹</td>
</tr>
<tr>
<td>process.command_line</td>
<td>process.command_line: (cmd or â€œ&#x2F;câ€)</td>
<td>å°‹æ‰¾ä½¿ç”¨cmdä¸¦ä¸”å«æœ‰å‘½ä»¤è¡Œåƒæ•¸ç‚ºâ€&#x2F;câ€çš„é€²ç¨‹</td>
</tr>
<tr>
<td>process.pid</td>
<td>event.category: process and process.pid: 4360</td>
<td>å°‹æ‰¾PIDç‚º4360çš„é€²ç¨‹</td>
</tr>
<tr>
<td>process.parent.name</td>
<td>event.category: process and process.parent.name: cmd.exe and process.name: powershell.exe</td>
<td>å°‹æ‰¾çˆ¶é€²ç¨‹ç‚ºcmd.exeä¸”è©²é€²ç¨‹åç‚ºpowershellçš„é€²ç¨‹ï¼›å°‹æ‰¾ç”±cmd.exeçˆ¶é€²ç¨‹å•Ÿå‹•çš„PowerShellé€²ç¨‹</td>
</tr>
<tr>
<td>process.parent.pid</td>
<td>event.category: process and process.parent.pid: 1240</td>
<td>å°‹æ‰¾çˆ¶é€²ç¨‹PIDç‚º1240çš„é€²ç¨‹</td>
</tr>
</tbody></table>
<h4 id="Network-Related-Fields"><a href="#Network-Related-Fields" class="headerlink" title="Network Related Fields"></a>Network Related Fields</h4><table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>KQL ç¯„ä¾‹</th>
<th>è¼¸å‡º</th>
</tr>
</thead>
<tbody><tr>
<td>source.ip</td>
<td>source.ip: 127.0.0.1</td>
<td>å°‹æ‰¾æºIPåœ°å€ä¸­çš„ä»»ä½•å‡ºç«™æµé‡</td>
</tr>
<tr>
<td>destination.ip</td>
<td>destination.ip: 23.184.192.62</td>
<td>å°‹æ‰¾ç›®çš„IPåœ°å€ä¸­çš„ä»»ä½•å…¥ç«™æµé‡</td>
</tr>
<tr>
<td>destination.port</td>
<td>destination.port: 443</td>
<td>å°‹æ‰¾ç›®çš„ç«¯å£ä¸­çš„ä»»ä½•å…¥ç«™æµé‡ï¼Œä¾‹å¦‚ç›®çš„ç«¯å£443</td>
</tr>
<tr>
<td>dns.question.name</td>
<td>dns.question.name: â€œ<a target="_blank" rel="noopener" href="http://www.youtube.com/">www.youtube.com</a>â€œ</td>
<td>å°‹æ‰¾DNSæŸ¥è©¢è¨˜éŒ„æŸ¥çœ‹DNSè§£æï¼ŒåŒ…æ‹¬ç¶²ç«™youtube.com</td>
</tr>
<tr>
<td>dns.response_code</td>
<td>dns.response_code: â€œNXDOMAINâ€</td>
<td>å°‹æ‰¾DNSéŸ¿æ‡‰ä»£ç¢¼çš„è¿”å›ç¢¼ï¼ŒåŒ…å«NXDOMAIN</td>
</tr>
<tr>
<td>destination.geo.country_name</td>
<td>destination.geo.country_name: â€œCanadaâ€</td>
<td>å°‹æ‰¾ç›®çš„åœ°ç†åœ‹å®¶æ¬„ä½ï¼Œä¾‹å¦‚Canada</td>
</tr>
</tbody></table>
<h4 id="Authentication-Related-Fields"><a href="#Authentication-Related-Fields" class="headerlink" title="Authentication Related Fields"></a>Authentication Related Fields</h4><table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>KQL ç¯„ä¾‹</th>
<th>è¼¸å‡º</th>
</tr>
</thead>
<tbody><tr>
<td>user.name</td>
<td>event.category: â€œauthenticationâ€ and user.name: john</td>
<td>å°‹æ‰¾ç”¨æˆ¶åjohnçš„ç™»éŒ„å˜—è©¦</td>
</tr>
<tr>
<td>winlog.logon.type</td>
<td>event.category: â€œauthenticationâ€ and winlog.logon.type: 3</td>
<td>å°‹æ‰¾logon typeç‚º3ï¼ˆç¶²è·¯ç™»éŒ„ï¼‰çš„é©—è­‰äº‹ä»¶</td>
</tr>
<tr>
<td>winlog.event_data.AuthenticationPackageName</td>
<td>event.category: â€œauthenticationâ€ and winlog.event_data.AuthenticationPackageName: â€œNTLMâ€</td>
<td>å°‹æ‰¾ä½¿ç”¨NTLMé©—è­‰åŒ…çš„é©—è­‰äº‹ä»¶</td>
</tr>
</tbody></table>
<h4 id="å¸¸ç”¨æŸ¥è©¢èªæ³•"><a href="#å¸¸ç”¨æŸ¥è©¢èªæ³•" class="headerlink" title="å¸¸ç”¨æŸ¥è©¢èªæ³•"></a>å¸¸ç”¨æŸ¥è©¢èªæ³•</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">event.provider: &quot;Microsoft-Windows-Sysmon&quot; and event.code: 11  and winlog.event_data.TargetFilename  : *.aspx

# DNSç›¸é—œæŸ¥è©¢
agent.type : &quot;packetbeat&quot; and type:&quot;dns&quot;  
dns.question.registered_domain : &quot;XXX&quot;

# ç¨‹åºç›£æ§
event.category: process and process.name: powershell.exe
process.command_line: *encoded* and event.category: process

# ç¶²è·¯æµé‡åˆ†æ
source.ip: 192.168.1.0&#x2F;24 and destination.port: (443 or 80)
event.category: network and destination.geo.country_name: &quot;China&quot;

# é©—è­‰äº‹ä»¶
event.category: authentication and event.outcome: failure
winlog.event_id: 4625 and user.name: administrator

# æª”æ¡ˆæ“ä½œ
event.category: file and event.type: creation
file.extension: (exe or dll) and file.path: *temp*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.splunk.com/zh_tw">splunk</a></p>
</li>
<li><p>chainsaw</p>
<ul>
<li>use sigma</li>
</ul>
</li>
</ul>
<h2 id="DFIR"><a href="#DFIR" class="headerlink" title="DFIR"></a>DFIR</h2><p>after an incident has occurred </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.velociraptor.app/">Velociraptor</a></li>
</ul>
<h2 id="CTI"><a href="#CTI" class="headerlink" title="CTI"></a>CTI</h2><ul>
<li><a href="">MISP</a></li>
<li><a target="_blank" rel="noopener" href="https://yeti-platform.io/">YETI</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/OpenCTI-Platform/opencti">openCTI</a></li>
</ul>
<h2 id="Malware-Analysis"><a href="#Malware-Analysis" class="headerlink" title="Malware Analysis"></a>Malware Analysis</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/Rurik/Noriben">Noriben</a></p>
<ul>
<li>Noriben is a Python-based script that works in conjunction with Sysinternals Procmon to automatically collect, analyze, and report on runtime indicators of malware.</li>
<li><code>python Noriben.py</code> launch the script</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/home/upload">VirusTotal</a></p>
<p>  VirusTotal æ˜¯ä¸€å€‹ç·šä¸Šæœå‹™ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥ä¸Šå‚³æª”æ¡ˆã€URLã€Domainã€IP æˆ– Hash é€²è¡Œåˆ†æï¼Œä»¥æª¢æ¸¬æ˜¯å¦å«æœ‰æƒ¡æ„è»Ÿé«”ã€æƒ¡æ„é€£çµã€é‡£é­šç­‰å¨è„…ï¼ŒVirusTotal å…§æŠŠå¤šå€‹é˜²æ¯’å¼•æ“ã€ç¶²é æƒæå™¨ã€å¨è„…æƒ…å ±ä¾†æºå½™æ•´åœ¨ä¸€èµ·ï¼Œä¸¦ä¸”è£¡é¢æœƒè·‘æ²™ç®±ç²å¾—æƒ¡æ„ç¨‹å¼è¡Œç‚º</p>
<p>  <img src="/assets/gMfDOnx2P7vfSTa0t39KTSF4X51TsNEZ1JieQp1GN9Y=.png"></p>
<p>  ä½¿ç”¨æ–¹å¼æ˜¯åœ¨ä¸Šæ–¹çš„æœå°‹æ¬„è¼¸å…¥ Hashã€IPã€Domainï¼Œæˆ–è‡³ä¸Šå‚³é é¢ä¸Šå‚³æƒ¡æ„ç¨‹å¼</p>
<p>  <img src="/assets/wVcdSKbGTJgrc4GYZeCk1VWOvjD2NKPOKSYt9_s5xPg=.png"></p>
<p>  é€™è£¡ä»‹ç´¹ä¸€ä¸‹ VirusTotal åˆ†æå®Œå¾Œæä¾›çš„é é¢è³‡è¨Š</p>
<h3 id="Detection"><a href="#Detection" class="headerlink" title="Detection"></a>Detection</h3><p>  é€™å€‹é é¢æä¾›äº†å¤šå®¶çš„ antivirus å¼•æ“çš„åµæ¸¬çµæœï¼Œæœƒé¡¯ç¤ºå‡ºè¾¨è­˜çš„æƒ¡æ„ç¨‹å¼å®¶æ—èˆ‡æ¨™ç±¤</p>
<p>  <img src="/assets/z3PpmUJlTskTOc-_l2CYf5VAZNTDMKlxMQ3i28g1sos=.png"></p>
<h3 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h3><p>  é€™å€‹é é¢æœƒåˆ—å‡ºæƒ¡æ„ç¨‹å¼çš„å¤§å°ã€å‹æ…‹ã€é›œæ¹Šï¼Œä»¥åŠç·¨è­¯ã€ä¿®æ”¹æ™‚é–“</p>
<p>  <img src="/assets/tvFgDnMjsBkHGBDXWKh2CtBid7nsv75o1We8A6U8X1E=.png"></p>
<p>  PE çµæ§‹ï¼ˆSectionsã€Imports&#x2F;Exportsï¼‰ã€ç°½ç« è³‡è¨Šã€å­—ä¸²ç­‰</p>
<p>  <img src="/assets/-yTNwLT3_1naezKvF3WWA6if8ccs7-ctpuBf63FxELQ=.png"></p>
<h3 id="Relations"><a href="#Relations" class="headerlink" title="Relations"></a>Relations</h3><p>  é€™å€‹é é¢æœƒåˆ—å‡ºæƒ¡æ„ç¨‹å¼é€£ç·šçš„ IPã€Domain </p>
<p>  <img src="/assets/rGfLfkJ0NLPqqubsITDG8YcSD_oXKpVZ90nQ10vh7T0=.png"></p>
<p>  ä»¥åŠåŸ·è¡Œæƒ¡æ„ç¨‹å¼æ™‚ç”¢ç”Ÿçš„æª”æ¡ˆ</p>
<p>  <img src="/assets/hNljM3GQjeIAib7Jbc6JH5X6n9aESH8pVix3NyaGWp4=.png"></p>
<h3 id="Behavior"><a href="#Behavior" class="headerlink" title="Behavior"></a>Behavior</h3><p>  é€™è£¡æœƒåˆ—å‡ºæƒ¡æ„ç¨‹å¼è·‘åœ¨å¤šç¨®æ²™ç®±ä¸­çš„è¡Œç‚º</p>
<p>  <img src="/assets/FbaXPCeyc1-V85aF3NNLqvM8J-bA8NuaXak9nMfQ4d8=.png"></p>
<p>  ç•¶ä¸­æœƒæœ‰ Network çš„åˆ†æ</p>
<p>  <img src="/assets/OhyS62SmzrqyOeKDsNXGOIr1k3M7VSM5kGmzncOPy9M=.png"></p>
<p>  ç•¶ä¸­ä¹Ÿæœ‰æª”æ¡ˆçš„æ“ä½œï¼ŒåŒ…å«æª”æ¡ˆé–‹å•Ÿã€ä¿®æ”¹ã€åˆªé™¤ã€å‰µå»º</p>
<p>  <img src="/assets/6-oZNV1IMKjgu5wbtjl5TjhnAu7kPSfdVJ4m-kjurNA=.png"></p>
<p>  Process çš„å‰µå»ºä»¥åŠ Command çš„è¨˜éŒ„</p>
<p>  <img src="/assets/zJdkjUtwInk-OW6R7zFKZaWdJmPniYZuo9vIRsHfHsk=.png"></p>
<h3 id="Community"><a href="#Community" class="headerlink" title="Community"></a>Community</h3><p>  é€™å€‹é é¢å¤§å¤šæ•¸æœƒæœ‰äººåˆ†äº«å…¶ä»–æƒ¡æ„ç¨‹å¼æª¢æ¸¬å¹³å°çš„ Report </p>
<p>  <img src="/assets/KXXwfCJI5ITKqJD8oFD6YiINevnuM8DAk7YjVPM9kG0=.png"></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://any.run/">ANY.RUN</a></p>
<p>  ANY.RUN æ˜¯ä¸€å€‹äº’å‹•å¼ç·šä¸Šæƒ¡æ„ç¨‹å¼æ²™ç®±ï¼Œå…è¨±ä½¿ç”¨è€…åœ¨å—æ§çš„è™›æ“¬ç’°å¢ƒä¸­å‹•æ…‹åŸ·è¡Œå¯ç–‘æª”æ¡ˆæˆ–ç¶²å€ï¼Œè§€å¯Ÿå…¶è¡Œç‚ºã€ç¶²è·¯æ´»å‹•ã€æª”æ¡ˆï¼ç™»éŒ„è¡¨æ“ä½œç­‰ç­‰</p>
<p>  <img src="/assets/-ipWo-VWZ1bBq9M0ip9AO1AW3ijwawfUVE_86kzXMPU=.png"></p>
<p>  å¦‚æœè¦ä½¿ç”¨å®ƒçš„æ²™ç®±åŠŸèƒ½ï¼Œå°±åƒ VirusTotal ä¸€æ¨£å¯ä»¥ç›´æ¥ä¸Ÿæƒ¡æ„ç¨‹å¼é€²å»åˆ†æçš„è©±ï¼Œæœƒéœ€è¦å…ˆè¨»å†Šå¸³æˆ¶ï¼Œå¦‚æœä¸æƒ³è¨»å†Šçš„è©±ï¼Œå¯ä»¥ç›´æ¥å‰å¾€ <a target="_blank" rel="noopener" href="https://app.any.run/submissions">https://app.any.run/submissions</a> ä¸¦ä½¿ç”¨ Hash æŸ¥è©¢æœ‰æ²’æœ‰äººä¹‹å‰ä¸Ÿéçš„æƒ¡æ„ç¨‹å¼</p>
<p>  å‡è¨­æˆ‘æŸ¥è©¢ hash ç‚º <code>ced525930c76834184b4e194077c8c4e7342b3323544365b714943519a0f92af</code> çš„æƒ¡æ„ç¨‹å¼</p>
<p>  <img src="/assets/wf3oQc9EpL8An_hXnvPKekdTlcrO5clXLA2HHXto9Gs=.png"></p>
<p>  ç„¶å¾Œé»é¸å…¶ä¸­ä¸€å€‹ï¼Œä¹Ÿå¯ä»¥é€²å…¥åˆ°æ²™ç®±åˆ†æçµæœé é¢</p>
<p>  <img src="/assets/rgOQ9BgqW3CpsBVaEnONX00EBqyz8ce9z1Eoq5GmGQE=.png"></p>
<p>  é€™é‚Šä»‹ç´¹ä¸€ä¸‹ Report ä»‹é¢ï¼Œé¦–å…ˆå¯ä»¥å…ˆçœ‹å³é‚Šçš„åŠŸèƒ½åˆ—ï¼ŒåŠŸèƒ½åŒ…å«ä½ å¯ä»¥ä¸‹è¼‰é€™å€‹æƒ¡æ„ç¨‹å¼ï¼Œä»¥åŠåœ¨æƒ¡æ„ç¨‹å¼å•Ÿå‹•æ™‚åŸ·è¡Œäº†ä»€éº¼è¡Œç‚º</p>
<p>  <img src="/assets/Pb8iPUJignS3owgETQh_oKV0DrQJy8eDm7t2yfmFQx0=.png"></p>
<p>  å¦‚æœæƒ³è¦è©³ç´°åˆ†æå…¶ä¸­ä¸€å€‹æª”æ¡ˆï¼Œé»æ“Šä»–å°±æœƒå‡ºç¾è©³ç´°è¨Šæ¯</p>
<p>  <img src="/assets/uDYCE6z7kaaGJyXNgruAqM7W3SB-CmNOx9XFiV8wLcY=.png"></p>
<p>  é»é¸ More Info ä¹‹å¾Œå°±æœƒé€²å…¥åˆ°é€™å€‹ç¨‹å¼çš„å®Œæ•´åˆ†æå…§å®¹</p>
<p>  <img src="/assets/TuHLpPHsOnJkkZGA_e4CjCrF45L98ZXRK9mWvHOIq9s=.png"></p>
<p>  é€™å€‹é é¢æœ‰ä¸€å€‹å¾ˆæ–¹ä¾¿çš„åŠŸèƒ½ï¼Œå®ƒæœƒåˆ—å‡ºæƒ¡æ„ç¨‹å¼è¡Œç‚ºçš„åš´é‡ç¨‹åº¦ï¼Œå‡è¨­æˆ‘æƒ³è¦äº†è§£ <code>T1053.005 Scheduled Task (1)</code> é€™å€‹è¡Œç‚ºï¼Œä¸¦ä¸”æƒ³è¦çŸ¥é“å®ƒä¸‹çš„ Cmdlineï¼Œå¯ä»¥é»æ“Šä¸‹æ–¹çš„ <code>Uses Task Scheduler to run other applications</code> å°±æœƒè·³å‡ºè¦–çª—ä¸¦é¡¯ç¤ºè©³ç´°å…§å®¹</p>
<p>  <img src="/assets/ZL3yijW5pBAeEDHXbe6EVXN0sc9pld1JxCrkcPeBQDo=.png"></p>
<p>  å›åˆ°åˆ†æä¸»é ï¼Œä¸‹æ–¹æ˜¯é¡¯ç¤º Network ç›¸é—œåˆ†æçµæœï¼Œä¹Ÿæœ‰çœ‹æª”æ¡ˆæ“ä½œçš„é é¢</p>
<p>  <img src="/assets/yyT6D73zz3KtGYHdOElmGIztskP0I4j4MQNd2N0-Rj8=.png"></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://bazaar.abuse.ch/browse/">MalwareBazaar</a></p>
<p>  MalwareBazaar æ˜¯ç”± abuse.ch æ‰€é‹ç‡Ÿçš„æƒ¡æ„è»Ÿé«”æ¨£æœ¬åˆ†äº«å¹³å°ï¼Œæ—¨åœ¨è®“è³‡å®‰ç ”ç©¶äººå“¡ã€antivirus å» å•†ã€å¨è„…æƒ…å ±åœ˜éšŠèƒ½å¤ æ›´å®¹æ˜“åœ°äº¤æ›èˆ‡å–å¾—æƒ¡æ„è»Ÿé«”æ¨£æœ¬ï¼Œå¦‚æœæœ‰æƒ³è¦æŸ¥è©¢çš„æƒ¡æ„ç¨‹å¼å¯ä»¥ä¾†é€™å€‹ç¶²ç«™æŸ¥</p>
<p>  <img src="/assets/WjzEU8V90NjOlZCZa8f61be1PPxTNpUIJ-_39gDptlo=.png"></p>
<p>  å®ƒæœ‰ä¸€å€‹æŸ¥è©¢çš„èªæ³•ï¼Œéœ€è¦ç…§è‘—å®ƒçš„èªæ³•ä¸ç„¶æœƒæ‰¾ä¸åˆ°</p>
  <pre class="line-numbers language-none"><code class="language-none">Search syntax is as follow: keyword:search_term

Following is a list of accepted keywords along with an example search_term

md5:1b109efade90ace7d953507adb1f1563 ( run)
sha256:11b16ba733f2f4f10ac58021eecaf5668551a73e2a1acfae99745c50bfccbb44 ( run)
signature:CobaltStrike ( run)
tag:TA505 ( run)
file_type:rtf ( run)
user:malware_traffic ( run)
clamav:SecuriteInfo.com.Artemis1FBB04F6EAF7.17086.UNOFFICIAL ( run)
yara:win_asyncrat_j1 ( run)
serial_number:51CD5393514F7ACE2B407C3DBFB09D8D ( run)
issuer_cn:Sectigo RSA Code Signing CA ( run)
imphash:756fdea446bc618b4804509775306c0d ( run)
tlsh:8DD484F440EF10A2F25F852936ADBE9401B2B1C7DBDA5E08137DE5311BBDA633A0564D ( run)
telfhash:52d0a7c198b4972c99e60578ed5c5bb29106216620070b20cf10a5d4d83b440f40db59 ( run)
gimphash:b43f35a8610180bcb184238555a0858a6c160a2d872566e7e9633221308b34fd ( run)
dhash_icon:f8dcbeffbffecee8 ( run)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>  å‡è¨­æˆ‘ç¾åœ¨è¦æŸ¥sha256 æ˜¯<code>ced525930c76834184b4e194077c8c4e7342b3323544365b714943519a0f92af</code> çš„æƒ¡æ„ç¨‹å¼</p>
<p>  <img src="/assets/h5BRvZtDGV6UzkjnyWHJoiFVyPj1qiOAVfCeJ7KTCa8=.png"></p>
<p>  é€™æ¨£å°±æˆåŠŸæ‰¾åˆ°äº†ï¼Œé¦–å…ˆæœƒåˆ—å‡ºåŸºæœ¬çš„è¨Šæ¯</p>
<p>  <img src="/assets/dhEkCdxVv7tqQkAy65vx9ZPsWCww_ZVAfR4ES2eojPM=.png"></p>
<p>  é€™å€‹ç¶²ç«™ä¸éŒ¯çš„åœ°æ–¹æ˜¯å®ƒæœƒå»æ•´ç†å„å¤§æƒ¡æ„ç¨‹å¼æª¢æ¸¬å¹³å°çš„ Reportï¼Œä¸¦åˆ—å‡ºä¾† Report ç¶²å€æˆ–è€…æª¢æ¸¬çµæœ</p>
<p>  <img src="/assets/MPS_tDeEXUcke389E3C6h51m7s3_fHIANLYQh00okQ=.png"></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://malpedia.caad.fkie.fraunhofer.de/">Malpedia</a></p>
<p>  Malpedia æ˜¯ç”± Fraunhofer FKIEæ‰€ç¶­é‹çš„ä¸€å€‹ã€Œæƒ¡æ„è»Ÿé«”ç™¾ç§‘ + åƒè€ƒæ¨£æœ¬é›†ã€å¹³å°ï¼Œæƒ¡æ„è»Ÿé«”å®¶æ—ç™¾ç§‘èˆ‡ç ”ç©¶è³‡æºï¼Œæä¾›å®¶æ—æè¿°ã€åˆ¥åã€å·²çŸ¥æ¨£æœ¬åƒè€ƒã€YARA è¦å‰‡ã€ç›¸é—œç ”ç©¶é€£çµã€‚</p>
<p>  <img src="/assets/2dvHSIedbNMendmEHvAO8F2RepgjV8q_V2Of8pGfZi0=.png"></p>
<p>  å‡è¨­æˆ‘å€‘å‰›å‰›çš„ XWorm æƒ¡æ„ç¨‹å¼ï¼Œå¯ä»¥ç›´æ¥åœ¨æœå°‹æ¬„æ‰“ä¸Š XWorm</p>
<p>  <img src="/assets/QbiEpyzJnEPDzDRdwNEz7JdUil3UzOlx_OD_1ug3E_8=.png"></p>
<p>  é€™äº›çš†æ˜¯é‡å°æ–¼ XWorm çš„ç ”ç©¶ï¼Œå¯ä»¥é»é€²å»åƒè€ƒ</p>
<p>  å¦å¤–ä¹Ÿå¯ä»¥å°‹æ‰¾é€™æ˜¯å“ªå€‹çµ„ç¹”ç™¼å‡ºä¾†çš„</p>
<p>  å¯ä»¥åœ¨ Family é é¢ä¸­æœå°‹ XWorm</p>
<p>  <img src="/assets/NSHxGJOQdrVMnCIB7qpIba_49beBljRTv3kp9hmIss=.png"></p>
<p>  é»é€²å»å¾Œå¯ä»¥çœ‹åˆ°é€™éš»æƒ¡æ„ç¨‹å¼ç›¸é—œçš„è¨Šæ¯ï¼ŒåŒ…å« Actor</p>
<p>  <img src="/assets/w6h7nMg7-aII3T313yGWoVOqf72mqCKIPX7RPRfIQZU=.png"></p>
<p>  é‚£é€™é‚Šå°±å¯ä»¥çœ‹åˆ° Actor æ˜¯ <code>Hive0137</code> </p>
<p>  é»æ“Šå¾Œå¯ä»¥çœ‹åˆ°è©² Actor çš„ç›¸é—œè³‡è¨Š</p>
<p>  <img src="/assets/QzHW9EOxvKz5xMAcFYHqeUAO6nFinJiYTmo4Tdfx9cc=.png"></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://tria.ge/reports/public">Triage</a></p>
<p>  Triage æ˜¯ç”± Hatching æä¾›çš„ç·šä¸Šæƒ¡æ„ç¨‹å¼æ²™ç®±å°ï¼Œç”¨ä¾†è‡ªå‹•åŸ·è¡Œã€åˆ†æå¯ç–‘æª”æ¡ˆä¸¦ç”Ÿæˆè¡Œç‚ºå ±å‘Šï¼Œå”åŠ©å®‰å…¨åˆ†æå¸«å¿«é€Ÿç¯©é¸èˆ‡åˆ†é¡å¨è„…æ¨£æœ¬ã€‚</p>
<p>  <img src="/assets/tur58FvV11eeExk1BKcPqd2fqstHnhwZd39997p7hCI=.png"></p>
<p>  å®ƒå¯ä»¥åƒ VirusTotal ä¸€æ¨£ä¸Šå‚³æƒ¡æ„ç¨‹å¼ä¸¦åˆ†ææˆ–è€…æœå°‹ä¹‹å‰å·²ç¶“ä¸Šå‚³éçš„æƒ¡æ„ç¨‹å¼</p>
<p>  æœå°‹çš„æ–¹å¼å°±æ˜¯é»é¸å³ä¸Šè§’çš„ Search å¾Œä¹Ÿæ˜¯å¯ä»¥ç”¨ Hash æœå°‹</p>
<p>  <img src="/assets/fgbYNIkhdgIgR5syn8hEHZAzsxh33-q_IKZMooswMmI=.png"></p>
<p>  é»é€²å»å¾Œå°±æœƒå‡ºç¾åˆ†æå ±å‘Š</p>
<p>  <img src="/assets/LSq6C5CnL3srr-davFhRkk2fxAeZAvhPQnt6kGkVyAk=.png"></p>
<p>  è€Œå¦‚æœæ˜¯è¦ä¸Šå‚³æƒ¡æ„ç¨‹å¼ï¼Œéœ€è¦å…ˆé€²è¡Œç™»å…¥ï¼Œç™»å…¥å¾Œä¸Šé¢åˆ—çš„ Submit æ˜¯ä¸Šå‚³æƒ¡æ„ç¨‹å¼çš„é é¢</p>
<p>  <img src="/assets/XLiYnj_Z4f0BPL-Azp2DnSM75KXVZGJUKYSCCspUbus=.png"></p>
<p>  ä¸Šå‚³å®Œå¾Œä¹Ÿæœƒå‡ºç¾ Report çš„é é¢</p>
<p>  Report é é¢æœ‰åŒ…å«</p>
<ul>
<li>ç’°å¢ƒèˆ‡ metadata</li>
<li>æ¨£æœ¬åŸºæœ¬è³‡è¨Šï¼ˆé›œæ¹Šã€å¤§å°ã€è©•åˆ†ã€æ¨™ç±¤ï¼‰</li>
<li>æå–å‡ºçš„æƒ¡æ„è¨­å®šï¼ˆC2ã€å®‰è£ä½ç½®ã€æª”æ¡ˆåï¼‰</li>
<li>åµæ¸¬ç°½ç«  &#x2F; è¡Œç‚ºæ¨™è¨˜</li>
<li>é€²ç¨‹è¡Œç‚º</li>
<li>ç¶²è·¯è¡Œç‚º</li>
<li>MITRE ATT&amp;CK å°æ‡‰æŠ€è¡“</li>
<li>å¯ä¸‹è¼‰çš„è¨˜æ†¶é«” &#x2F; ç”Ÿæˆæª”æ¡ˆ</li>
</ul>
</li>
</ul>
<h2 id="Memory-Forensics"><a href="#Memory-Forensics" class="headerlink" title="Memory Forensics"></a>Memory Forensics</h2><h3 id="Volatility-Framework"><a href="#Volatility-Framework" class="headerlink" title="Volatility Framework"></a>Volatility Framework</h3><p>è¨˜æ†¶é«”å–è­‰åˆ†æå·¥å…·ï¼Œç”¨æ–¼åˆ†æè¨˜æ†¶é«”æ˜ åƒæª”æ¡ˆ</p>
<h3 id="pslist-pstree"><a href="#pslist-pstree" class="headerlink" title="pslist&#x2F;pstree"></a>pslist&#x2F;pstree</h3><p>å¯ä»¥å¹«åŠ©æˆ‘å€‘å»æŸ¥çœ‹é€™å°é›»è…¦è·‘äº†ä»€éº¼processï¼Œä»–å€‘åˆ†æçš„æ–¹å¼æ˜¯æœƒæ ¹æ“šSymbol Table æ‰¾åˆ°Windows Kernelçš„ PsActiveProcessHead çš„ä½å€ï¼Œç„¶å¾Œå¾é‚£å€‹éˆè¡¨é–‹å§‹æ²¿ ActiveProcessLinks æŒ‡æ¨™é€ä¸€è®€å‡º EPROCESS çµæ§‹ä¸¦è§£æå¿…è¦æ¬„ä½ï¼Œå¦‚ï¼šImageFileNameã€UniqueProcessIdã€CreateTimeã€ExitTime ç­‰</p>
<p><img src="/assets/cghIGl_AaCJnL5zsvyk6TDeHL4Zf5T7ugVayuyE-uDo=.png" title="source:https:&#x2F;&#x2F;www.tophertimzen.com&#x2F;resources&#x2F;cs407&#x2F;slides&#x2F;week02_02-Processes.html#slide13"></p>
<p>å¦å¤–çš„pstree ä»¥ pslist çš„çµæœç‚ºåŸºç¤ï¼Œè½‰æˆçˆ¶å­æ¨¹ç‹€ã€‚</p>
<p>é‚£å¦‚æœåƒè€ƒ <a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/m/articles/10321120">https://ithelp.ithome.com.tw/m/articles/10321120</a> æˆ–è€… <a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10335699">https://ithelp.ithome.com.tw/articles/10335699</a> çš„å…¶ä¸­ä¸€å€‹æ–¹å¼ï¼Œ å¯ä»¥ç™¼ç¾å…¶å¯¦æƒ¡æ„ç¨‹å¼æ˜¯å¯ä»¥å»å°‡process éš±è—èµ·ä¾†çš„ï¼Œä¸¦ä¸”è®“pslist èˆ‡ pstree ç„¡æ³•åµæ¸¬ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥ä½¿ç”¨ psscan å˜—è©¦å»åµæ¸¬</p>
<h3 id="psscan"><a href="#psscan" class="headerlink" title="psscan"></a>psscan</h3><p>é¦–å…ˆè¦èªªæ˜ï¼ŒWindows kernel åœ¨ç‚ºè¨±å¤šæ ¸å¿ƒç‰©ä»¶ï¼ˆä¾‹å¦‚ EPROCESSã€ETHREADã€FILE_OBJECTï¼‰åˆ†é…è¨˜æ†¶é«”æ™‚ï¼Œæœƒåœ¨ <code>_POOL_HEADER</code> ä¸­æ”¾ç½®ä¸€å€‹ 4-byte çš„ pool tagï¼Œç”¨ä¾†æ¨™ç¤ºè©²åˆ†é…çš„ç”¨é€”æˆ–ä¾†æºã€‚</p>
<p>psscanæ˜¯ä¸€å€‹ä½¿ç”¨ pool-tag scanning çš„æƒæå™¨ï¼šå®ƒæœƒåœ¨ memory dump ä¸­æœå°‹<code>_POOL_HEADER</code> èˆ‡ pool tagï¼Œä¸¦ä¸”å°æ‰¾åˆ°çš„å€™é¸å€å¡Šåšçµæ§‹ä¸€è‡´æ€§æª¢æŸ¥ï¼ˆä¾‹å¦‚æ¬„ä½ç¯„åœã€æŒ‡æ¨™æ˜¯å¦æŒ‡å‘å¯è®€è¨˜æ†¶é«”ã€ProcessName æ˜¯å¦å¯è®€ç­‰ï¼‰ï¼Œä¾†åˆ¤å®šè©²å€å¡Šæ˜¯å¦ç‚ºä¸€å€‹æœ‰æ•ˆçš„ EPROCESSï¼ETHREADã€‚å› æ­¤ï¼Œå³ä½¿è©²ç¨‹åºç‰©ä»¶å·²è¢«å¾ kernel çš„ active list unlinkï¼ˆä¾‹å¦‚è¢«æŸäº› rootkit éš±è—ï¼‰ï¼Œåªè¦å…¶ pool åˆ†é…å°šå­˜åœ¨è¨˜æ†¶é«”ä¸”å°šæœªè¢«è¦†å¯«ï¼Œpsscan é€šå¸¸å¯ä»¥æŠŠå®ƒæ‰¾åˆ°ã€‚</p>
<h3 id="psxview"><a href="#psxview" class="headerlink" title="psxview"></a>psxview</h3><p>é€™å€‹plugin æœƒå°‡æˆ‘å€‘å‰›å‰›æåˆ°çš„pslist&#x2F;pstreeèˆ‡psscanä»¥åŠå…¶ä»–thrdscanã€csrssä½œæ¯”è¼ƒï¼Œå¦‚æœæ²’æœ‰å‡ºç¾åœ¨ç›¸å°æ‡‰çš„æƒæä¸Šå°±æœƒå‡ºç¾ Falseï¼Œ å¦å‰‡å°±æœƒå‡ºç¾ trueï¼Œå› æ­¤å¦‚æœæœ‰ä¸€å€‹process ä»–åœ¨pslist å‡ºç¾False ä½†åœ¨psscanå‡ºç¾True é‚£å°±å¯ä»¥å˜—è©¦å»åˆ†æçœ‹çœ‹æ˜¯ä¸æ˜¯rootkit</p>
<h4 id="System-Profiling"><a href="#System-Profiling" class="headerlink" title="System Profiling"></a>System Profiling</h4><table>
<thead>
<tr>
<th>åˆ†æé …ç›®</th>
<th>æ’ä»¶</th>
<th>å‘½ä»¤è¡Œ</th>
</tr>
</thead>
<tbody><tr>
<td>è­˜åˆ¥ä½œæ¥­ç³»çµ±ç‰ˆæœ¬</td>
<td>imageinfo</td>
<td><code>python vol.py -f memory.dump imageinfo</code></td>
</tr>
<tr>
<td>åˆ†æKDBGçµæ§‹</td>
<td>kdbgscan</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 kdbgscan</code></td>
</tr>
</tbody></table>
<h4 id="Processes-Analysis"><a href="#Processes-Analysis" class="headerlink" title="Processes Analysis"></a>Processes Analysis</h4><table>
<thead>
<tr>
<th>åˆ†æé …ç›®</th>
<th>æ’ä»¶</th>
<th>å‘½ä»¤è¡Œ</th>
</tr>
</thead>
<tbody><tr>
<td>ç¨‹åºåˆ—è¡¨</td>
<td>pslist</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 pslist</code></td>
</tr>
<tr>
<td>ç¨‹åºçˆ¶å­é—œä¿‚</td>
<td>pstree</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 pstree</code></td>
</tr>
<tr>
<td>æƒæç¨‹åº (å«éš±è—&#x2F;çµ‚æ­¢)</td>
<td>psscan</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 psscan</code></td>
</tr>
<tr>
<td>éš±è—ç¨‹åºæª¢æŸ¥</td>
<td>psxview</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 psxview</code></td>
</tr>
<tr>
<td>ç¨‹åºè©³ç´°è³‡è¨Š</td>
<td>psinfo</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 psinfo -p 1640</code></td>
</tr>
<tr>
<td>ç¨‹åºæ¬Šé™</td>
<td>privs</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 privs -p 1640</code></td>
</tr>
<tr>
<td>ç¨‹åºåŸ·è¡Œç·’</td>
<td>threads</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 threads -p 1640</code></td>
</tr>
<tr>
<td>ç¨‹åºSID</td>
<td>getsids</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 getsids -p 1640</code></td>
</tr>
<tr>
<td>ç¨‹åºä»¤ç‰Œ</td>
<td>tokens</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 tokens -p 1640</code></td>
</tr>
<tr>
<td>è½‰å„²ç¨‹åºåŸ·è¡Œæª”</td>
<td>procdump</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 procdump -p 1640 --dump-dir=./</code></td>
</tr>
<tr>
<td>è™›æ“¬ä½å€æè¿°ç¬¦</td>
<td>vadinfo</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 vadinfo -p 1640</code></td>
</tr>
<tr>
<td>VADæ¨¹çµæ§‹</td>
<td>vadtree</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 vadtree -p 1640</code></td>
</tr>
<tr>
<td>éæ­·VAD</td>
<td>vadwalk</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 vadwalk -p 1640</code></td>
</tr>
</tbody></table>
<h4 id="Network-Connections"><a href="#Network-Connections" class="headerlink" title="Network Connections"></a>Network Connections</h4><table>
<thead>
<tr>
<th>åˆ†æé …ç›®</th>
<th>æ’ä»¶</th>
<th>å‘½ä»¤è¡Œ</th>
</tr>
</thead>
<tbody><tr>
<td>ç¶²è·¯é€£ç·š&#x2F;ç¶²è·¯æ´»å‹•</td>
<td>netscan</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 netscan</code></td>
</tr>
</tbody></table>
<h4 id="Persistence-Techniques"><a href="#Persistence-Techniques" class="headerlink" title="Persistence Techniques"></a>Persistence Techniques</h4><table>
<thead>
<tr>
<th>åˆ†æé …ç›®</th>
<th>æ’ä»¶</th>
<th>å‘½ä»¤è¡Œ</th>
</tr>
</thead>
<tbody><tr>
<td>è¨»å†Šè¡¨éµå€¼</td>
<td>printkey</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 printkey -K &quot;Software\Microsoft\Windows\CurrentVersion\Run&quot;</code></td>
</tr>
<tr>
<td>æŸ¥æ‰¾æ‰€æœ‰æŒä¹…åŒ–æ©Ÿåˆ¶</td>
<td>autoruns</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 autoruns</code></td>
</tr>
</tbody></table>
<h4 id="Filesystem"><a href="#Filesystem" class="headerlink" title="Filesystem"></a>Filesystem</h4><table>
<thead>
<tr>
<th>åˆ†æé …ç›®</th>
<th>æ’ä»¶</th>
<th>å‘½ä»¤è¡Œ</th>
</tr>
</thead>
<tbody><tr>
<td>è§£æMFTé …ç›®</td>
<td>mftparser</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 mftparser</code></td>
</tr>
<tr>
<td>æƒææª”æ¡ˆç‰©ä»¶</td>
<td>filescan</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 filescan</code></td>
</tr>
<tr>
<td>è½‰å„²æª”æ¡ˆ</td>
<td>dumpfiles</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 dumpfiles -Q 0x000000007e410890 --dump-dir=./</code></td>
</tr>
</tbody></table>
<h4 id="Advanced-Analysis"><a href="#Advanced-Analysis" class="headerlink" title="Advanced Analysis"></a>Advanced Analysis</h4><table>
<thead>
<tr>
<th>åˆ†æé …ç›®</th>
<th>æ’ä»¶</th>
<th>å‘½ä»¤è¡Œ</th>
</tr>
</thead>
<tbody><tr>
<td>æƒæDLL</td>
<td>dlllist</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 dlllist -p 1640</code></td>
</tr>
<tr>
<td>æª¢æŸ¥è™•ç†ç¨‹åºå¥æŸ„</td>
<td>handles</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 handles -p 1640 -t Process,Thread</code></td>
</tr>
<tr>
<td>å‘½ä»¤è¡Œæ­·å²</td>
<td>cmdline</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 cmdline</code></td>
</tr>
<tr>
<td>ç’°å¢ƒè®Šæ•¸</td>
<td>envars</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 envars</code></td>
</tr>
<tr>
<td>è¨˜æ†¶é«”å­—ä¸²æœå°‹</td>
<td>strings</td>
<td><code>strings memory.dump | grep -i password</code></td>
</tr>
<tr>
<td>è½‰å„²ç¨‹åºè¨˜æ†¶é«”</td>
<td>memdump</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 memdump -p 1640 --dump-dir=./</code></td>
</tr>
</tbody></table>
<p>é€é Volatility æ‹¿åˆ° evtx</p>
<h2 id="Volatility-2"><a href="#Volatility-2" class="headerlink" title="Volatility 2"></a>Volatility 2</h2><pre class="line-numbers language-none"><code class="language-none">vol.py -f .&#x2F;memory.dmp --profile&#x3D;Win10x64_14393 -g 0xf8004a000b20 filescan | grep &#39;.evtx&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="Volatility-3"><a href="#Volatility-3" class="headerlink" title="Volatility 3"></a>Volatility 3</h2><pre class="line-numbers language-none"><code class="language-none">vol -f memory.dmp windows.filescan | grep &#39;.evtx&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/2lVDyAjMs3yOlsZxMikXlj2nIgpeJqE_tenYg-RGAog=.png"></p>
<p>æˆ‘å€‘å¯ä»¥åˆ©ç”¨ FileScan çš„ pugin å¹«åŠ©æˆ‘å€‘æª¢æŸ¥æ˜¯å¦æœ‰æˆ‘å€‘æƒ³è¦çš„æª”æ¡ˆï¼Œåœ–ç‰‡ä¸­å¯ä»¥å¾—çŸ¥åˆ°èªªç¢ºå¯¦æœ‰ï¼Œæ¥ä¸‹ä¾†å°±å¯ä»¥å°‡ä»–å€‘dumpä¸‹ä¾†ï¼ŒVolatility 2 ä»¥åŠVolatility 3 çš„ Dumpfile æ”¯æ´ regex ï¼Œå¯ä»¥ä½¿ç”¨å®ƒå¹«åŠ©æˆ‘å€‘æ‰¾åˆ°æ‰€æœ‰æˆ‘å€‘éœ€è¦çš„ evtx</p>
<h2 id="Volatility-2-1"><a href="#Volatility-2-1" class="headerlink" title="Volatility 2"></a>Volatility 2</h2><pre class="line-numbers language-none"><code class="language-none">vol.py -f .&#x2F;memory.dmp --profile&#x3D;Win10x64_14393 -g 0xf8004a000b20  dumpfiles --regex .evtx$ --ignore-case --dump-dir output<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="Volatility-3-1"><a href="#Volatility-3-1" class="headerlink" title="Volatility 3"></a>Volatility 3</h2><pre class="line-numbers language-none"><code class="language-none">vol -f memory.dmp windows.dumpfiles.DumpFiles --filter .evtx$<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é€™å€‹æŒ‡ä»¤ç°¡å–®ä¾†èªªå°±æ˜¯å¾memory.dump ä¸­ å°‡çµå°¾ç‚º.evtxçš„æª”æ¡ˆå…¨éƒ¨æŠ“å‡ºä¾†ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šçœ‹ä½ æƒ³è¦çœ‹ä»€éº¼evtxï¼Œå†å»æ›´æ”¹regexå³å¯ã€‚</p>
<p>å‡è¨­æˆ‘æƒ³è¦dump Security.evtxä¸‹ä¾†çœ‹</p>
<h2 id="Volatility-2-2"><a href="#Volatility-2-2" class="headerlink" title="Volatility 2"></a>Volatility 2</h2><pre class="line-numbers language-none"><code class="language-none">vol.py -f .&#x2F;memory.dmp --profile&#x3D;Win10x64_14393 -g 0xf8004a000b20 --regex Security.evtx$ --ignore-case --dump-dir output<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="Volatility-3-2"><a href="#Volatility-3-2" class="headerlink" title="Volatility 3"></a>Volatility 3</h2><pre class="line-numbers language-none"><code class="language-none">vol -f memory.dmp windows.dumpfiles.DumpFiles --filter Security.evtx$<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/n11TvjQIvmkx_EM-nMo45tSov2D461awpBgTU_khL3o=.png"></p>
<p>åœ–ç‰‡ä¸­ç™¼ç¾æˆåŠŸDumpå‡ºä¾†æ±è¥¿äº†ï¼Œä½†æ˜¯æ€éº¼æœƒæœ‰å…©å€‹æª”æ¡ˆï¼Œè€Œä¸”é€™å…©å€‹æª”æ¡ˆä¸€å€‹æ˜¯ vacb ï¼Œä¸€å€‹æ˜¯ datï¼Œè·Ÿ evtx çš„é—œä¿‚ä¸æ˜¯èªªæ²’æœ‰æ„Ÿè¦ºæ˜¯ä¸€é»é—œä¿‚éƒ½æ²’æœ‰ï¼Œé‚£ä»€éº¼æ˜¯ vacbï¼Œä»€éº¼æ˜¯ dat ?</p>
<ul>
<li>vacb : Caching Data</li>
<li>dat : Less Fragile File</li>
</ul>
<p>ç°¡å–®ä¾†èªªé€™å…©å€‹éƒ½å„²å­˜äº† evtx çš„è³‡æ–™ï¼Œåªæ˜¯ dat çš„å„²å­˜æ–¹å¼æ¯”è¼ƒç©©å®šå¯é </p>
<p>å› æ­¤å…¶å¯¦ä¹Ÿå¯ä»¥ç›´æ¥æŠŠ vacb æˆ– dat å‰¯æª”åç›´æ¥æ”¹æˆ evtx ï¼Œå°±å¯ä»¥ç›´æ¥ç”¨å…§å»ºçš„ Event viewer æŸ¥çœ‹</p>
<p><img src="/assets/Chv6PtoCP5Pxr6ytsdD9dJ-t5cpcGlqVz_joyxsW87c=.png"></p>
<p>ä½†å¦å¤–å…¶å¯¦ä¹Ÿå¯ä»¥ç”¨Evtxcmd å°‡å®ƒè®Šæˆ CSV æª”æŸ¥çœ‹</p>
<p>æ ¹æ“š <a target="_blank" rel="noopener" href="https://github.com/EricZimmerman/evtx?tab=readme-ov-file">https://github.com/EricZimmerman/evtx?tab=readme-ov-file</a> å®˜æ–¹çµ¦çš„ä½¿ç”¨èªªæ˜ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤å°‡æˆ‘å€‘çš„ evtx è½‰æ›æˆ csv </p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">.\EvtxECmd.exe -f &quot;..\..\file.0xca82b31c5990.0xca82b3848c70.SharedCacheMap.Security.evtx.vacb&quot; --csv .&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ¥ä¸‹ä¾†å°±å¯ä»¥ç²å¾—ä¸€å€‹csvæª”ï¼Œä¸¦ä¸”è£¡é¢çš„å…§å®¹æ˜¯evtxçš„å…§å®¹</p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">PS C:\Users\yunshiuan\Desktop\net9\EvtxeCmd &gt; .\EvtxECmd.exe -f &quot;..\..\file.0xca82b31c5990.0xca82b3848c70.SharedCacheMap.Security.evtx.vacb&quot; --csv .&#x2F;
EvtxECmd version 1.5.2.0

Author: Eric Zimmerman (saericzimmerman@gmail.com)
https:&#x2F;&#x2F;github.com&#x2F;EricZimmerman&#x2F;evtx

Command line: -f ..\..\file.0xca82b31c5990.0xca82b3848c70.SharedCacheMap.Security.evtx.vacb --csv .&#x2F;

Warning: Administrator privileges not found!

CSV output will be saved to .&#x2F;20250904074916_EvtxECmd_Output.csv

Maps loaded: 453

Processing C:\Users\yunshiuan\Desktop\file.0xca82b31c5990.0xca82b3848c70.SharedCacheMap.Security.evtx.vacb...
Chunk count: 30, Iterating records...
Record # 68 (Event Record Id: 68): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessName&quot;] not found! Replacing with empty string
Record # 68 (Event Record Id: 68): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessId&quot;] not found! Replacing with empty string
Record # 69 (Event Record Id: 69): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessName&quot;] not found! Replacing with empty string
Record # 69 (Event Record Id: 69): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessId&quot;] not found! Replacing with empty string
Record # 70 (Event Record Id: 70): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessName&quot;] not found! Replacing with empty string
Record # 70 (Event Record Id: 70): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessId&quot;] not found! Replacing with empty string
Record # 71 (Event Record Id: 71): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessName&quot;] not found! Replacing with empty string
Record # 71 (Event Record Id: 71): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessId&quot;] not found! Replacing with empty string
Record # 72 (Event Record Id: 72): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessName&quot;] not found! Replacing with empty string
Record # 72 (Event Record Id: 72): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessId&quot;] not found! Replacing with empty string
Record # 73 (Event Record Id: 73): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessName&quot;] not found! Replacing with empty string
Record # 73 (Event Record Id: 73): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessId&quot;] not found! Replacing with empty string
Record # 78 (Event Record Id: 78): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessName&quot;] not found! Replacing with empty string
Record # 78 (Event Record Id: 78): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessId&quot;] not found! Replacing with empty string
Record # 79 (Event Record Id: 79): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessName&quot;] not found! Replacing with empty string
Record # 79 (Event Record Id: 79): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessId&quot;] not found! Replacing with empty string
Record # 83 (Event Record Id: 83): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessName&quot;] not found! Replacing with empty string
Record # 83 (Event Record Id: 83): In map for event 4718, Property &#x2F;Event&#x2F;EventData&#x2F;Data[@Name&#x3D;&quot;ProcessId&quot;] not found! Replacing with empty string
Record # 2529 (Event Record Id: 2529): In map for event 1100, Property &#x2F;Event&#x2F;UserData[@Name&#x3D;&quot;ServiceShutdown&quot;] not found! Replacing with empty string

Event log details
Flags: IsDirty
Chunk count: 30
Stored&#x2F;Calculated CRC: B5FC0719&#x2F;B5FC0719
Earliest timestamp: 2024-01-31 23:47:41.1765022
Latest timestamp:   2024-02-01 19:48:31.0253493
Total event log records found: 246

Records included: 246 Errors: 0 Events dropped: 0

Metrics (including dropped events)
Event ID        Count
1100            1
4608            2
4624            58
4625            1
4647            1
4648            7
4672            51
4688            23
4696            2
4717            10
4718            9
4720            1
4725            2
4728            1
4731            11
4732            3
4735            11
4738            6
4739            1
4797            5
4798            7
4799            3
4826            2
4902            2
4907            1
5024            1
5033            1
5379            23

Processed 1 file in 1.8517 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¹‹å¾Œå°±å¯ä»¥ç”¨Timeline Explorer æˆ–å…¶ä»–å¯ä»¥é–‹ csv çš„è»Ÿé«”å»åšæƒ³è¦çš„Event IDæŸ¥è©¢æˆ–è€…å­—ä¸²çš„æœå°‹ã€‚</p>
<p><img src="/assets/M9NLjmdw8XqYgsflY7NZPbn3tEQ6x0CqxY7Zf7XbbPU=.png"></p>
<h4 id="Malware-Detection"><a href="#Malware-Detection" class="headerlink" title="Malware Detection"></a>Malware Detection</h4><table>
<thead>
<tr>
<th>åˆ†æé …ç›®</th>
<th>æ’ä»¶</th>
<th>å‘½ä»¤è¡Œ</th>
</tr>
</thead>
<tbody><tr>
<td>æª¢æŸ¥ç¨‹åºæ³¨å…¥</td>
<td>malfind</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 malfind</code></td>
</tr>
<tr>
<td>Hookæª¢æ¸¬</td>
<td>apihooks</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 apihooks</code></td>
</tr>
<tr>
<td>SSDT Hookæª¢æ¸¬</td>
<td>ssdt</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 ssdt</code></td>
</tr>
<tr>
<td>é©…å‹•ç¨‹å¼æƒæ</td>
<td>driverscan</td>
<td><code>python vol.py -f memory.dump --profile=Win7SP1x64 driverscan</code></td>
</tr>
</tbody></table>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>å¦‚æœä½ åœ¨ Win10 çš„è¨˜æ†¶é«” dump ä½¿ç”¨ Volatility 2 çš„ psscan æ™‚ï¼Œæœ‰å¯èƒ½æœƒå‡ºç¾ä»¥ä¸‹çš„éŒ¯èª¤</p>
<pre class="line-numbers language-none"><code class="language-none">$ vol.py -f MemoryDump.mem --profile&#x3D;Win10x64_19041 psscan

Volatility Foundation Volatility Framework 2.6.1
Offset(P)          Name                PID   PPID PDB                Time created                   Time exited
------------------ ---------------- ------ ------ ------------------ ------------------------------ ------------------------------
WARNING : volatility.debug    : Cannot find nt!ObGetObjectType
WARNING : volatility.debug    : Cannot find nt!ObGetObjectType
Traceback (most recent call last):
  File &quot;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;vol.py&quot;, line 192, in &lt;module&gt;
    main()
  File &quot;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;vol.py&quot;, line 183, in main
    command.execute()
  File &quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python2.7&#x2F;dist-packages&#x2F;volatility&#x2F;commands.py&quot;, line 147, in execute
    func(outfd, data)
  File &quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python2.7&#x2F;dist-packages&#x2F;volatility&#x2F;plugins&#x2F;filescan.py&quot;, line 428, in render_text
    for eprocess in data:
  File &quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python2.7&#x2F;dist-packages&#x2F;volatility&#x2F;poolscan.py&quot;, line 252, in scan
    skip_type_check &#x3D; skip_type_check)
  File &quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python2.7&#x2F;dist-packages&#x2F;volatility&#x2F;plugins&#x2F;overlays&#x2F;windows&#x2F;windows.py&quot;, line 1258, in get_object
    return self.get_object_top_down(struct_name, object_type, skip_type_check)
  File &quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python2.7&#x2F;dist-packages&#x2F;volatility&#x2F;plugins&#x2F;overlays&#x2F;windows&#x2F;windows.py&quot;, line 1231, in get_object_top_down
    header.get_object_type() &#x3D;&#x3D; object_type):
  File &quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python2.7&#x2F;dist-packages&#x2F;volatility&#x2F;plugins&#x2F;overlays&#x2F;windows&#x2F;win7.py&quot;, line 155, in get_object_type
    return self.type_map.get(int(self.TypeIndex), &#39;&#39;)
  File &quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python2.7&#x2F;dist-packages&#x2F;volatility&#x2F;plugins&#x2F;overlays&#x2F;windows&#x2F;win10.py&quot;, line 334, in TypeIndex
    return ((addr &gt;&gt; 8) ^ cook ^ indx) &amp; 0xFF
TypeError: unsupported operand type(s) for ^: &#39;int&#39; and &#39;NoneType&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é€™å€‹éŒ¯èª¤æ˜¯å› ç‚ºwin10.py ä¸­åœ¨åŸ·è¡Œæ™‚åœ¨<code>return ((addr &gt;&gt; 8) ^ cook ^ indx) &amp; 0xFF</code>é€™æ®µç¨‹å¼å‡ºç¾äº† NoneType çš„è®Šæ•¸ã€‚</p>
<h4 id="nt-ObGetObjectType-æ˜¯ä»€éº¼ï¼Ÿ"><a href="#nt-ObGetObjectType-æ˜¯ä»€éº¼ï¼Ÿ" class="headerlink" title="nt!ObGetObjectType æ˜¯ä»€éº¼ï¼Ÿ"></a>nt!ObGetObjectType æ˜¯ä»€éº¼ï¼Ÿ</h4><p>æ ¹æ“š<a target="_blank" rel="noopener" href="https://medium.com/%40ashabdalhalim/a-light-on-windows-10s-object-header-typeindex-value-e8f907e7073a">é€™ç¯‡æ–‡ç« </a>çš„åˆ†æï¼Œå¯ä»¥çŸ¥é“èªª Win 10 çš„ TypeInde&#x78;<strong>&#x20;</strong>&#x88AB;æ··æ·†éï¼Œä¸¦ä¸”æ˜¯æ ¹æ“š</p>
<pre class="line-numbers language-none"><code class="language-none">Index &#x3D; TypeIndex ^ 2nd least significate byte of OBJECT_HEADER address ^ nt!ObHeaderCookie<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é€™æ¨£çš„å…¬å¼é€²è¡Œæ··æ·†ï¼Œnt!ObGetObjectType çš„åŠŸç”¨å°±æ˜¯å°‡TypeIndex é€²è¡Œè§£æ··æ·†ä¸¦å›å‚³è§£æ··æ·†çš„TypeIndexã€‚</p>
<p>å› ç‚º Volatility 2 æ˜¯é–‹æºçš„ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹ win10.py çš„<a target="_blank" rel="noopener" href="https://github.com/volatilityfoundation/volatility/blob/master/volatility/plugins/overlays/windows/win10.py">sourcecode</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">class _OBJECT_HEADER_10(win8._OBJECT_HEADER):
        
    @property
    def TypeIndex(self):
        &quot;&quot;&quot;Wrap the TypeIndex member with a property that decodes it 
        with the nt!ObHeaderCookie value.&quot;&quot;&quot;

        cook &#x3D; obj.VolMagic(self.obj_vm).ObHeaderCookie.v()
        addr &#x3D; self.obj_offset 
        indx &#x3D; int(self.m(&quot;TypeIndex&quot;))

        return ((addr &gt;&gt; 8) ^ cook ^ indx) &amp; 0xFF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é€™é‚Šå°±å¯ä»¥æ˜é¡¯çš„çœ‹åˆ°é€™ä¸‰å€‹è®Šæ•¸åˆ†åˆ¥ä»£è¡¨ä»€éº¼ï¼Œä¸¦ä¸”åˆ©ç”¨é€™ä¸‰å€‹è®Šæ•¸è§£æ··æ·†</p>
<ul>
<li>addr : OBJECT_HEADER_address</li>
<li>cook : nt!ObHeaderCookie è®€å‡ºçš„cookie å€¼ï¼ŒWindows 10 æ˜¯æ¯æ¬¡é–‹æ©Ÿéš¨æ©Ÿç”Ÿæˆçš„</li>
<li>indx : æ··æ·†éå¾Œçš„TypeIndex</li>
</ul>
<p>é‚£é€™é‚Šå°±æ˜¯å› ç‚º Volatlity2 è®€ä¸åˆ° nt!ObHeaderCookieï¼Œå› æ­¤ cook æœƒæ˜¯NoneType ï¼Œ è€Œå¦‚æœä½ æœ‰åœ¨Volatility 2ä¸‹é <code>-h</code> æœ‰å¯èƒ½æœƒçœ‹éå¯ä»¥ä¸‹<code>--cookie</code>ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">$ vol.py -h

Volatility Foundation Volatility Framework 2.6.1
Usage: Volatility - A memory forensics analysis platform.

Options:
  -h, --help            list all available options and their default values.
                        Default values may be set in the configuration file
                        (&#x2F;etc&#x2F;volatilityrc)
  --conf-file&#x3D;&#x2F;home&#x2F;yunshiuan&#x2F;.volatilityrc
                        User based configuration file
  -d, --debug           Debug volatility
  --plugins&#x3D;PLUGINS     Additional plugin directories to use (colon separated)
  --info                Print information about all registered objects
  --cache-directory&#x3D;&#x2F;home&#x2F;yunshiuan&#x2F;.cache&#x2F;volatility
                        Directory where cache files are stored
  --cache               Use caching
  --tz&#x3D;TZ               Sets the (Olson) timezone for displaying timestamps
                        using pytz (if installed) or tzset
  -f FILENAME, --filename&#x3D;FILENAME
                        Filename to use when opening an image
  --profile&#x3D;WinXPSP2x86
                        Name of the profile to load (use --info to see a list
                        of supported profiles)
  -l LOCATION, --location&#x3D;LOCATION
                        A URN location from which to load an address space
  -w, --write           Enable write support
  --dtb&#x3D;DTB             DTB Address
  --shift&#x3D;SHIFT         Mac KASLR shift address
  --output&#x3D;text         Output in this format (support is module specific, see
                        the Module Output Options below)
  --output-file&#x3D;OUTPUT_FILE
                        Write output in this file
  -v, --verbose         Verbose information
  --physical_shift&#x3D;PHYSICAL_SHIFT
                        Linux kernel physical shift address
  --virtual_shift&#x3D;VIRTUAL_SHIFT
                        Linux kernel virtual shift address
  -g KDBG, --kdbg&#x3D;KDBG  Specify a KDBG virtual address (Note: for 64-bit
                        Windows 8 and above this is the address of
                        KdCopyDataBlock)
  --force               Force utilization of suspect profile
  -k KPCR, --kpcr&#x3D;KPCR  Specify a specific KPCR address
  --cookie&#x3D;COOKIE       Specify the address of nt!ObHeaderCookie (valid for
                        Windows 10 only)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‚£é€™å€‹å°±æ˜¯è®“æˆ‘å€‘æ”¾ nt!ObHeaderCookie çš„ address çµ¦ Volatility 2 ï¼Œ å› æ­¤æ¥ä¸‹ä¾†åªè¦ç²å–åˆ°nt!ObHeaderCookie ä½ç½®çš„ cookie æ‡‰è©²å°±å¯ä»¥è§£æ±ºé€™å€‹å•é¡Œäº†ã€‚è€Œ nt!ObHeaderCookie åœ¨ ntoskrnl.exe ä¸­å¯ä»¥æ‰¾åˆ°ã€‚</p>
<p>å› æ­¤æˆ‘å€‘ç¾åœ¨è¦æŠŠmemory ä¸­çš„ntoskrnl.exe dumpå‡ºä¾†ï¼Œvolatility 2 æœ‰ä¸€å€‹å¾ˆçŒ›çš„ <code>moddump</code> Plugin ï¼Œä»–å¯ä»¥å°‡ Kernel Driver å…¨éƒ¨ dump å‡ºä¾†</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ vol.py -f MemoryDump.mem --profile&#x3D;Win10x64_19041 moddump --dump-dir .&#x2F;

Volatility Foundation Volatility Framework 2.6.1
Module Base        Module Name          Result
------------------ -------------------- ------
0xfffff8076221a000 ntoskrnl.exe         OK: driver.fffff8076221a000.sys
0xfffff80762070000 hal.dll              OK: driver.fffff80762070000.sys
0xfffff80767340000 ucx01000.sys         OK: driver.fffff80767340000.sys
0xfffff80764530000 NETIO.SYS            OK: driver.fffff80764530000.sys
0xfffff80767570000 UsbHub3.sys          OK: driver.fffff80767570000.sys
0xfffff80767020000 USBPORT.SYS          OK: driver.fffff80767020000.sys
0xfffff80767db0000 vm3dmp.sys           OK: driver.fffff80767db0000.sys
0xfffff807643c0000 ndis.sys             OK: driver.fffff807643c0000.sys
0xfffff807679d0000 cldflt.sys           OK: driver.fffff807679d0000.sys
0xfffff80767a80000 bindflt.sys          OK: driver.fffff80767a80000.sys
0xfffff80763fe0000 EhStorClass.sys      OK: driver.fffff80763fe0000.sys
0xfffff807635f0000 CI.dll               OK: driver.fffff807635f0000.sys
0xfffff80763c00000 pdc.sys              OK: driver.fffff80763c00000.sys
0xfffff80767af0000 rspndr.sys           OK: driver.fffff80767af0000.sys
0xfffff80767210000 e1i65x64.sys         OK: driver.fffff80767210000.sys
0xfffff80763e00000 vsock.sys            OK: driver.fffff80763e00000.sys
0xfffff80767440000 rdpbus.sys           OK: driver.fffff80767440000.sys
0xfffff80774a50000 tcpipreg.sys         OK: driver.fffff80774a50000.sys
0xfffff8077a5f0000 ad_driver.10.sys     OK: driver.fffff8077a5f0000.sys
0xfffff80765670000 cdrom.sys            OK: driver.fffff80765670000.sys
0xfffff80774c80000 mpsdrv.sys           OK: driver.fffff80774c80000.sys
0xfffff80763eb0000 storahci.sys         OK: driver.fffff80763eb0000.sys
0xfffff8077a4c0000 condrv.sys           OK: driver.fffff8077a4c0000.sys
0xfffff80765ad0000 watchdog.sys         OK: driver.fffff80765ad0000.sys
0xfffff807656f0000 Beep.SYS             OK: driver.fffff807656f0000.sys
0xfffff80764b70000 mup.sys              OK: driver.fffff80764b70000.sys
0xfffff80767d90000 serenum.sys          OK: driver.fffff80767d90000.sys
0xfffff80763b50000 msisadrv.sys         OK: driver.fffff80763b50000.sys
0xfffff80762160000 FLTMGR.SYS           OK: driver.fffff80762160000.sys
0xfffff80767390000 vmgencounter.sys     OK: driver.fffff80767390000.sys
0xfffff80763fb0000 stornvme.sys         OK: driver.fffff80763fb0000.sys
0xfffff807635c0000 werkernel.sys        OK: driver.fffff807635c0000.sys
0xfffff80765720000 dxgkrnl.sys          OK: driver.fffff80765720000.sys
0xfffff807637f0000 WMILIB.SYS           OK: driver.fffff807637f0000.sys
0xfffff80763d90000 volmgrx.sys          Error: Cannot acquire AS
0xfffff80774a20000 Ndu.sys              OK: driver.fffff80774a20000.sys
0xfffff80763ef0000 storport.sys         OK: driver.fffff80763ef0000.sys
0xfffff80767990000 wcifs.sys            OK: driver.fffff80767990000.sys
0xfffff80763c50000 partmgr.sys          OK: driver.fffff80763c50000.sys
0xfffff80767870000 dxgmms2.sys          OK: driver.fffff80767870000.sys
0xfffff80766e80000 kdnic.sys            OK: driver.fffff80766e80000.sys
0xfffff80767b70000 peauth.sys           OK: driver.fffff80767b70000.sys
0xfffff80764aa0000 volsnap.sys          OK: driver.fffff80764aa0000.sys
0xfffff80763b10000 IntelTA.sys          OK: driver.fffff80763b10000.sys
0xfffff807676c0000 HIDPARSE.SYS         OK: driver.fffff807676c0000.sys
0xfffff80767cd0000 umbus.sys            OK: driver.fffff80767cd0000.sys
0xfffff80767720000 dump_storport.sys    OK: driver.fffff80767720000.sys
0xfffff807673b0000 BATTC.SYS            OK: driver.fffff807673b0000.sys
0xfffff80766da0000 dfsc.sys             OK: driver.fffff80766da0000.sys
0xfffff80763b20000 WindowsTr...roxy.sys OK: driver.fffff80763b20000.sys
0xfffff80764b10000 rdyboost.sys         OK: driver.fffff80764b10000.sys
0xfffff80763d50000 PCIIDEX.SYS          OK: driver.fffff80763d50000.sys
0xfffff80766f80000 afunix.sys           OK: driver.fffff80766f80000.sys
0xfffff80767da0000 vm3dmp_loader.sys    OK: driver.fffff80767da0000.sys
0xfffff80764ba0000 iorate.sys           OK: driver.fffff80764ba0000.sys
0xfffff80767420000 NdisVirtualBus.sys   OK: driver.fffff80767420000.sys
0xfffff80766dd0000 CompositeBus.sys     OK: driver.fffff80766dd0000.sys
0xfffff80774a00000 mmcss.sys            OK: driver.fffff80774a00000.sys
0xfffff80764000000 fileinfo.sys         OK: driver.fffff80764000000.sys
0xfffff80764610000 tcpip.sys            OK: driver.fffff80764610000.sys
0xfffff807637a0000 WDFLDR.SYS           OK: driver.fffff807637a0000.sys
0xfffff80766c20000 rdbss.sys            OK: driver.fffff80766c20000.sys
0xfffff80762080000 kdcom.dll            OK: driver.fffff80762080000.sys
0xfffff80766ca0000 csc.sys              OK: driver.fffff80766ca0000.sys
0xfffffb54a32b0000 win32k.sys           Error: Cannot acquire AS
0xfffff807674e0000 USBD.SYS             OK: driver.fffff807674e0000.sys
0xfffffb54a2c00000 win32kbase.sys       OK: driver.fffffb54a2c00000.sys
0xfffff80763af0000 WindowsTrustedRT.sys OK: driver.fffff80763af0000.sys
0xfffff80774ca0000 mrxsmb.sys           OK: driver.fffff80774ca0000.sys
0xfffff80767d20000 kbdclass.sys         OK: driver.fffff80767d20000.sys
0xfffff80766d40000 nsiproxy.sys         OK: driver.fffff80766d40000.sys
0xfffff80767560000 ksthunk.sys          OK: driver.fffff80767560000.sys
0xfffff80765b70000 crashdmp.sys         OK: driver.fffff80765b70000.sys
0xfffff80763b30000 pcw.sys              OK: driver.fffff80763b30000.sys
0xfffff807643b0000 Fs_Rec.sys           Error: Cannot acquire AS
0xfffff807649c0000 fvevol.sys           OK: driver.fffff807649c0000.sys
0xfffff807635e0000 ntosext.sys          OK: driver.fffff807635e0000.sys
0xfffff80764c00000 CLASSPNP.SYS         OK: driver.fffff80764c00000.sys
0xfffff80766bf0000 winhvr.sys           OK: driver.fffff80766bf0000.sys
0xfffff80762130000 PSHED.dll            OK: driver.fffff80762130000.sys
0xfffff80763e20000 vmci.sys             OK: driver.fffff80763e20000.sys
0xfffff80767430000 swenum.sys           OK: driver.fffff80767430000.sys
0xfffff80767660000 hidusb.sys           OK: driver.fffff80767660000.sys
0xfffff80766b20000 netbios.sys          OK: driver.fffff80766b20000.sys
0xfffff80766ea0000 CimFS.SYS            OK: driver.fffff80766ea0000.sys
0xfffff80774ac0000 HTTP.sys             OK: driver.fffff80774ac0000.sys
0xfffff80767ab0000 lltdio.sys           OK: driver.fffff80767ab0000.sys
0xfffff807670d0000 portcls.sys          OK: driver.fffff807670d0000.sys
0xfffff807656e0000 Null.SYS             Error: Cannot acquire AS
0xfffff80767cf0000 i8042prt.sys         OK: driver.fffff80767cf0000.sys
0xfffff80763910000 mssecflt.sys         OK: driver.fffff80763910000.sys
0xfffff80766f20000 netbt.sys            OK: driver.fffff80766f20000.sys
0xfffff80766b40000 Vid.sys              OK: driver.fffff80766b40000.sys
0xfffff80762150000 BOOTVID.dll          OK: driver.fffff80762150000.sys
0xfffff80767760000 dump_stornvme.sys    OK: driver.fffff80767760000.sys
0xfffff80763d70000 volmgr.sys           OK: driver.fffff80763d70000.sys
0xfffff80763990000 ACPI.sys             OK: driver.fffff80763990000.sys
0xfffff807636e0000 cng.sys              OK: driver.fffff807636e0000.sys
0xfffff80766fa0000 ahcache.sys          OK: driver.fffff80766fa0000.sys
0xfffff80774d90000 vmmemctl.sys         OK: driver.fffff80774d90000.sys
0xfffff80767b10000 msquic.sys           OK: driver.fffff80767b10000.sys
0xfffff807621d0000 cmimcext.sys         OK: driver.fffff807621d0000.sys
0xfffff80766df0000 fastfat.SYS          OK: driver.fffff80766df0000.sys
0xfffff80763400000 clipsp.sys           OK: driver.fffff80763400000.sys
0xfffff807637c0000 SleepStudyHelper.sys OK: driver.fffff807637c0000.sys
0xfffff80764020000 Wof.sys              OK: driver.fffff80764020000.sys
0xfffff80763e70000 ataport.SYS          OK: driver.fffff80763e70000.sys
0xfffff80764a90000 volume.sys           OK: driver.fffff80764a90000.sys
0xfffff807670a0000 HDAudBus.sys         OK: driver.fffff807670a0000.sys
0xfffff807656b0000 filecrypt.sys        OK: driver.fffff807656b0000.sys
0xfffff807638e0000 acpiex.sys           OK: driver.fffff807638e0000.sys
0xfffff80766ef0000 TDI.SYS              OK: driver.fffff80766ef0000.sys
0xfffff8077a4e0000 vmhgfs.sys           OK: driver.fffff8077a4e0000.sys
0xfffff80765b10000 BasicRender.sys      OK: driver.fffff80765b10000.sys
0xfffff80767d50000 mouclass.sys         OK: driver.fffff80767d50000.sys
0xfffff80763d40000 intelide.sys         OK: driver.fffff80763d40000.sys
0xfffffb54a3350000 cdd.dll              Error: Cannot acquire AS
0xfffff80767960000 luafv.sys            OK: driver.fffff80767960000.sys
0xfffff80774c50000 bowser.sys           OK: driver.fffff80774c50000.sys
0xfffff807676e0000 mouhid.sys           OK: driver.fffff807676e0000.sys
0xfffff807677b0000 dump_dumpfve.sys     OK: driver.fffff807677b0000.sys
0xfffff807673d0000 intelppm.sys         OK: driver.fffff807673d0000.sys
0xfffff80765be0000 Msfs.SYS             OK: driver.fffff80765be0000.sys
0xfffff8077a550000 WdFilter.sys         OK: driver.fffff8077a550000.sys
0xfffff80766ff0000 tap0901.sys          OK: driver.fffff80766ff0000.sys
0xfffff80774da0000 srvnet.sys           OK: driver.fffff80774da0000.sys
0xfffff807640d0000 Ntfs.sys             OK: driver.fffff807640d0000.sys
0xfffff80763e40000 mountmgr.sys         OK: driver.fffff80763e40000.sys
0xfffff80767450000 usbhub.sys           OK: driver.fffff80767450000.sys
0xfffff80767a60000 storqosflt.sys       OK: driver.fffff80767a60000.sys
0xfffff80767680000 HIDCLASS.SYS         OK: driver.fffff80767680000.sys
0xfffff80763c90000 spaceport.sys        OK: driver.fffff80763c90000.sys
0xfffff807672a0000 USBXHCI.SYS          OK: driver.fffff807672a0000.sys
0xfffff80766ec0000 tdx.sys              OK: driver.fffff80766ec0000.sys
0xfffff80766ad0000 pacer.sys            OK: driver.fffff80766ad0000.sys
0xfffff80765700000 vmrawdsk.sys         OK: driver.fffff80765700000.sys
0xfffff80767000000 usbuhci.sys          OK: driver.fffff80767000000.sys
0xfffff80763550000 msrpc.sys            Error: Cannot acquire AS
0xfffff80763b60000 pci.sys              OK: driver.fffff80763b60000.sys
0xfffff80767ad0000 mslldp.sys           OK: driver.fffff80767ad0000.sys
0xfffff80767170000 ks.sys               OK: driver.fffff80767170000.sys
0xfffff80766d90000 gpuenergydrv.sys     OK: driver.fffff80766d90000.sys
0xfffff807673a0000 CmBatt.sys           OK: driver.fffff807673a0000.sys
0xfffff807645d0000 ksecpkg.sys          OK: driver.fffff807645d0000.sys
0xfffff80763be0000 vdrvroot.sys         OK: driver.fffff80763be0000.sys
0xfffff807671f0000 usbehci.sys          OK: driver.fffff807671f0000.sys
0xfffff80763800000 Wdf01000.sys         OK: driver.fffff80763800000.sys
0xfffff80764be0000 disk.sys             OK: driver.fffff80764be0000.sys
0xfffff80766d70000 mssmbios.sys         OK: driver.fffff80766d70000.sys
0xfffff80774d40000 mrxsmb20.sys         OK: driver.fffff80774d40000.sys
0xfffff807677d0000 dxgmms1.sys          OK: driver.fffff807677d0000.sys
0xfffff80767d70000 serial.sys           OK: driver.fffff80767d70000.sys
0xfffff80766ab0000 vwififlt.sys         OK: driver.fffff80766ab0000.sys
0xfffff807620c0000 CLFS.SYS             OK: driver.fffff807620c0000.sys
0xfffff807656d0000 tbs.sys              OK: driver.fffff807656d0000.sys
0xfffff80764900000 fwpkclnt.sys         OK: driver.fffff80764900000.sys
0xfffff80766f10000 ws2ifsl.sys          OK: driver.fffff80766f10000.sys
0xfffff80763520000 ksecdd.sys           OK: driver.fffff80763520000.sys
0xfffff80765b30000 Npfs.SYS             OK: driver.fffff80765b30000.sys
0xfffff80767140000 drmk.sys             OK: driver.fffff80767140000.sys
0xfffff80766d60000 npsvctrig.sys        OK: driver.fffff80766d60000.sys
0xfffff80764980000 wfplwfs.sys          OK: driver.fffff80764980000.sys
0xfffff80767d40000 vmmouse.sys          OK: driver.fffff80767d40000.sys
0xfffff807637d0000 WppRecorder.sys      OK: driver.fffff807637d0000.sys
0xfffff80761de0000 mcupdate.dll         OK: driver.fffff80761de0000.sys
0xfffff8077a3f0000 srv2.sys             OK: driver.fffff8077a3f0000.sys
0xfffff80766a00000 afd.sys              OK: driver.fffff80766a00000.sys
0xfffff80763970000 SgrmAgent.sys        OK: driver.fffff80763970000.sys
0xfffff80767620000 usbccgp.sys          OK: driver.fffff80767620000.sys
0xfffff80763c30000 CEA.sys              OK: driver.fffff80763c30000.sys
0xfffff80767700000 vmusbmouse.sys       OK: driver.fffff80767700000.sys
0xfffff80767850000 monitor.sys          OK: driver.fffff80767850000.sys
0xfffff80763e60000 atapi.sys            OK: driver.fffff80763e60000.sys
0xfffff80763a80000 intelpep.sys         OK: driver.fffff80763a80000.sys
0xfffff80762090000 tm.sys               OK: driver.fffff80762090000.sys
0xfffff80766e60000 bam.sys              OK: driver.fffff80766e60000.sys
0xfffffb54a2ee0000 win32kfull.sys       Error: Cannot acquire AS
0xfffff807674f0000 HdAudio.sys          OK: driver.fffff807674f0000.sys
0xfffff80766b00000 ndiscap.sys          OK: driver.fffff80766b00000.sys
0xfffff80765af0000 BasicDisplay.sys     OK: driver.fffff80765af0000.sys<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>&#x20;ç¬¬ä¸€å€‹å°±æ˜¯ntoskrnl.exe ï¼ŒæŠŠå®ƒæ‹¿å»åç·¨è­¯ä¹‹å¾Œæ‰¾åˆ° ObGetObjectType æ¥ä¸‹ä¾†æŠŠå‰é¢çš„8 bytes çš„ opcode è¨˜ä½</p>
<p><img src="/assets/TvYuVt1MEA0AH8i7s_0FELoY5njlVr0iMo2in0PMfRc=.png"></p>
<p>æ¥ä¸‹ä¾†ç”¨yarascan æŠŠä»–å¾è¨˜æ†¶é«”ä¸­çš„ä½ç½®æŠ“å‡ºä¾† </p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ sudo python2.7 vol.py -f ..&#x2F;temp_extract_dir&#x2F;MemoryDump.mem --profile&#x3D;Win10x64_19041 yarascan -K -Y &quot;&#123;48 8D 41 D0 0F B6 49 E8&#125;&quot;

Volatility Foundation Volatility Framework 2.6.1
Rule: r1
Owner: ntoskrnl.exe
0xf8076291d470  48 8d 41 d0 0f b6 49 e8 48 c1 e8 08 0f b6 c0 48   H.A...I.H......H
0xf8076291d480  33 c1 0f b6 0d a3 92 5f 00 48 33 c1 48 8d 0d ed   3......_.H3.H...
0xf8076291d490  99 5f 00 48 8b 04 c1 c3 cc cc cc cc cc cc cc cc   ._.H............
0xf8076291d4a0  48 83 ec 58 8a 84 24 a0 00 00 00 c7 44 24 48 01   H..X..$.....D$H.
0xf8076291d4b0  00 00 00 88 44 24 40 8b 84 24 98 00 00 00 89 44   ....D$@..$.....D
0xf8076291d4c0  24 38 8b 84 24 90 00 00 00 89 44 24 30 48 8b 84   $8..$.....D$0H..
0xf8076291d4d0  24 88 00 00 00 48 89 44 24 28 48 8b 84 24 80 00   $....H.D$(H..$..
0xf8076291d4e0  00 00 48 89 44 24 20 e8 14 00 00 00 48 83 c4 58   ..H.D$......H..X
0xf8076291d4f0  c3 cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc   ................
0xf8076291d500  4c 8b dc 49 89 5b 08 49 89 73 10 4d 89 4b 20 4d   L..I.[.I.s.M.K.M
0xf8076291d510  89 43 18 57 41 54 41 55 41 56 41 57 48 83 ec 70   .C.WATAUAVAWH..p
0xf8076291d520  48 8b da 48 8b f9 45 33 ed 4d 89 6b b0 4d 89 6b   H..H..E3.M.k.M.k
0xf8076291d530  b8 65 48 8b 04 25 88 01 00 00 48 89 44 24 60 44   .eH..%....H.D$&#96;D
0xf8076291d540  8a b8 32 02 00 00 45 84 ff 0f 84 07 94 12 00 49   ..2...E........I
0xf8076291d550  8b 4b 28 48 b8 00 00 ff ff ff 7f 00 00 48 3b c8   .K(H.........H;.
0xf8076291d560  48 0f 43 c8 8b 01 89 01 44 8b a4 24 d0 00 00 00   H.C.....D..$....<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¥ä¸‹ä¾†çŸ¥é“ ntoskrnl.exe çš„ä½ç½®åœ¨<code>0xf8076291d470</code>å¾Œæˆ‘å€‘å°±å¯ä»¥å¯« script å¹«æˆ‘æˆ‘å€‘æå–ObHeaderCookie</p>
<p>å›å»çœ‹åç·¨è­¯å‡ºä¾†çš„ObGetObjectTypeï¼Œæˆ‘å€‘çš„ç›®æ¨™æ˜¯<code>movzx   ecx, byte [rel ObHeaderCookie]</code> é€™æ®µ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ sudo python2.7 vol.py -f ..&#x2F;temp_extract_dir&#x2F;MemoryDump.mem --profile&#x3D;Win10x64_19041 volshell
Volatility Foundation Volatility Framework 2.6.1
Current context: System @ 0xffffad8185883180, pid&#x3D;4, ppid&#x3D;0 DTB&#x3D;0x1ad002
Welcome to volshell! Current memory image is:
file:&#x2F;&#x2F;&#x2F;home&#x2F;yunshiuan&#x2F;temp_extract_dir&#x2F;MemoryDump.mem
To get help, type &#39;hh()&#39;
&gt;&gt;&gt; addr &#x3D; 0xf8076291d470
&gt;&gt;&gt; for m in getmods():
...     nt_mod &#x3D; m
...     break
...
&gt;&gt;&gt; mode &#x3D; distorm3.Decode64Bits
&gt;&gt;&gt; data &#x3D; nt_mod.obj_vm.read(addr, 100)
&gt;&gt;&gt; ops &#x3D; distorm3.Decompose(addr, data, mode)
&gt;&gt;&gt; for op in reversed(ops):
...     if (op.size &#x3D;&#x3D; 7 and &#39;FLAG_RIP_RELATIVE&#39; in op.flags and len(op.operands) &#x3D;&#x3D; 2 and op.operands[0].type &#x3D;&#x3D; &#39;Register&#39; and op.operands[1].type &#x3D;&#x3D; &#39;AbsoluteMemory&#39; and op.operands[1].size &#x3D;&#x3D; 8):
...         addr2 &#x3D; op.address + op.size + op.operands[1].disp
...
&gt;&gt;&gt; cookie &#x3D; obj.Object(&quot;unsigned int&quot;, offset &#x3D; addr2, vm &#x3D; nt_mod.obj_vm)
&gt;&gt;&gt; hex(cookie)
&#39;0x9be88324L&#39;
&gt;&gt;&gt; exit()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é€™å€‹script ç°¡å–®ä¾†èªª</p>
<ul>
<li>é¦–å…ˆå…ˆç²å–åˆ°addr çš„ç¬¬ä¸€å€‹å‡½æ•¸ï¼Œé‚£å› ç‚ºæˆ‘å€‘ç›´æ¥å®šä½çš„é—œä¿‚ï¼Œæ‰€ä»¥é€™é‚Šnt_mod &#x3D; ObGetObjectType</li>
<li>æ¥ä¸‹ä¾†åˆ†åˆ¥æ˜¯è¨­å®š64 ä½å…ƒåçµ„è­¯æ¨¡å¼ã€è®€å–100 ä½å…ƒçµ„çš„æ©Ÿå™¨ç¢¼ã€é€²è¡Œåçµ„è­¯å¾—åˆ°æŒ‡ä»¤åˆ—è¡¨</li>
<li>ä¸‹ä¸€éƒ¨åˆ†æ˜¯å°‹æ‰¾<code>movzx ecx, byte [rel ObHeaderCookie]</code>æŒ‡ä»¤<ul>
<li><code>op.size == 7</code>ï¼šæŒ‡ä»¤é•·åº¦ç‚º 7 ä½å…ƒçµ„</li>
<li><code>&#39;FLAG_RIP_RELATIVE&#39; in op.flags</code>ï¼šä½¿ç”¨ RIPç›¸å°å®šå€</li>
<li><code>len(op.operands) == 2</code>ï¼šæœ‰ 2 å€‹é‹ç®—å…ƒ</li>
<li><code>op.operands[0].type== &#39;Register&#39;</code>ï¼šç¬¬ä¸€å€‹é‹ç®—å…ƒæ˜¯æš«å­˜å™¨</li>
<li><code>op.operands[1].type == &#39;AbsoluteMemory&#39;</code>ï¼šç¬¬äºŒå€‹é‹ç®—å…ƒæ˜¯è¨˜æ†¶é«”ä½å€</li>
<li><code>op.operands[1].size== 8</code>ï¼šè¨˜æ†¶é«”é‹ç®—å…ƒå¤§å°ç‚º 8 ä½å…ƒçµ„</li>
</ul>
</li>
<li>æ‰¾åˆ°å¾Œè¨ˆç®—ObHeaderCookieçš„å¯¦éš›è¨˜æ†¶é«”ä½ç½®<ul>
<li><code>addr2 = op.address + op.size + op.operands[1].disp</code><ul>
<li>op.addressï¼šæŒ‡ä»¤åœ°å€</li>
<li>op.sizeï¼šæŒ‡ä»¤å¤§å°ï¼ˆ7 ä½å…ƒçµ„ï¼‰</li>
<li>op.operands[1].dispï¼šRIP ç›¸å°ä½ç§»</li>
</ul>
</li>
</ul>
</li>
<li>æœ€å¾Œæå–cookie çš„å€¼</li>
</ul>
<p>æå–å¾Œæˆ‘å€‘çŸ¥é“cookie çš„å€¼ç‚º<code>0x9be88324</code>ï¼Œæœ€å¾Œå†ä¸‹ä¸€æ¬¡ psscan å¸¶ä¸Šå‰›å‰›æŠ“çš„cookie</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sudo python2.7 vol.py -f ..&#x2F;temp_extract_dir&#x2F;MemoryDump.mem --profile&#x3D;Win10x64_19041 --cookie&#x3D;0x9be88324 psscan<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç™¼ç¾æˆåŠŸåŸ·è¡Œ</p>
<p><img src="/assets/itW3xFS6UvPW_Na9YNcMa0hzXSp3BMdpHgJ7ig0oANU=.png"></p>
<hr>
<h2 id="Network-Forensics"><a href="#Network-Forensics" class="headerlink" title="Network Forensics"></a>Network Forensics</h2><ul>
<li><p>wireshark</p>
<h3 id="è§£å¯†å°åŒ…"><a href="#è§£å¯†å°åŒ…" class="headerlink" title="è§£å¯†å°åŒ…"></a>è§£å¯†å°åŒ…</h3><p>  Wireshark æ”¯æ´å¯ä»¥åŒ¯å…¥key ï¼Œå°‡åŠ å¯†éå¾Œçš„HTTPS æµé‡é‚„åŸæˆæ˜æ–‡</p>
<p>  å› ç‚ºHTTPS å¤šäº†ä¸€å±¤SSL&#x2F;TLSï¼Œä»–æœƒå°‡å°åŒ…é€²è¡ŒåŠ å¯†ä¿è­·å‚³è¼¸å…§å®¹ä¸è¢«ç«Šè½</p>
<p>  è§£å¯†æµç¨‹å¦‚ä¸‹ï¼š</p>
<p>  å‡è¨­æˆ‘å€‘è¦åˆ†æä¸€å€‹HTTPSç¶²ç«™çš„ç™»å…¥éç¨‹ï¼Œå°‡åŠ è§£å¯†çš„key å…ˆå­˜åœ¨ä¸€å€‹æª”æ¡ˆä¸­</p>
  <pre class="line-numbers language-shellscript" data-language="shellscript"><code class="language-shellscript">export SSLKEYLOGFILE&#x3D;&quot;&#x2F;home&#x2F;user&#x2F;ssl-keys.log&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>  ç„¶å¾Œå†Preferences-&gt; Prorocols è£¡é¢æ‰¾åˆ°TLS ï¼Œæ¥ä¸‹ä¾†æŠŠå‰›å‰›å„²å­˜çš„key è·¯å¾‘ä¸Ÿé€²å»æœ€åº•ä¸‹<code>(Pre)-Master-Screct log filename</code>è£¡é¢</p>
<p>  <img src="/assets/CeYJy0OyLQdOSSNNFOSwGR4xwqu41W5ftRSrnPAi5Lg=.png"></p>
<p>  å¦å¤–wireshark æ”¯æ´çš„è§£å¯†ç‚º</p>
<ol>
<li><strong>SSL&#x2F;TLSè§£å¯†</strong>ï¼šæœ€å¸¸è¦‹çš„HTTPSæµé‡è§£å¯†</li>
<li><strong>WEP&#x2F;WPA&#x2F;WPA2è§£å¯†</strong>ï¼šWiFiåŠ å¯†æµé‡</li>
<li><strong>IPsecè§£å¯†</strong>ï¼šVPNæµé‡</li>
<li><strong>Kerberosè§£å¯†</strong>ï¼šWindowsèªè­‰æµé‡</li>
<li><strong>è‡ªå®šç¾©åŠ å¯†</strong>ï¼šé€éLuaè…³æœ¬æ”¯æ´</li>
</ol>
<h3 id="åŒ¯å‡ºç‰©ä»¶"><a href="#åŒ¯å‡ºç‰©ä»¶" class="headerlink" title="åŒ¯å‡ºç‰©ä»¶"></a>åŒ¯å‡ºç‰©ä»¶</h3><p>  wireshark æä¾›äº†å¯ä»¥å°‡å°åŒ…å‚³è¼¸çš„ç‰©ä»¶(å¦‚ï¼šåœ–ç‰‡ã€æª”æ¡ˆã€ç¶²é â€¦â€¦) dump ä¸‹ä¾†çš„åŠŸèƒ½</p>
<p>  <img src="/assets/3ddxe9oKXt86KtV1SU35U9aQ4UFkfBXaD7uXQ3UaAbA=.png"></p>
<hr>
</li>
<li><p>NetworkMiner </p>
<p>  ç›®å‰åªæ”¯æ´ Windows ä½œæ¥­ç³»çµ±ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–å·¥å…·è®“å®ƒåœ¨ Linux æˆ– Mac ä¸ŠåŸ·è¡Œã€‚å®ƒå¯ä»¥å°‡ pcap å…§çš„å°åŒ…æ‹†é–‹ã€è§£æã€é‡çµ„ï¼Œå˜—è©¦æŠŠè£¡é¢çš„æª”æ¡ˆã€åœ–ç‰‡ã€éƒµä»¶ã€æ†‘è­‰ï¼SSL è­‰æ›¸ã€ä½¿ç”¨è€…å¸³è™Ÿå¯†ç¢¼ç­‰ç›´æ¥é‚„åŸå‡ºä¾†ï¼Œå¦å¤–å®ƒä¹Ÿå¯ä»¥å³æ™‚ç›£è½å°åŒ…ä¸¦åˆ†æ</p>
<p>  <img src="/assets/BJmkNL7Wg-jT87SnETdJ3A595Aq2fIzDb_OTbU6yD3A=.png"></p>
<p>  ä½†æ˜¯ï¼ŒNetworkMiner å…è²»ç‰ˆåªèƒ½åˆ†æ pcap æª”æ¡ˆï¼Œå¦‚æœæ˜¯ pcapng æ ¼å¼å‰‡éœ€è¦ä»˜è²»æ‰èƒ½åˆ†æï¼Œä»˜è²»ç‰ˆæœ¬éœ€è¦ 1300 USD </p>
<blockquote>
<p>pcapng ä¹Ÿæ˜¯ä¸€ç¨®ç”¨ä¾†å„²å­˜ç¶²è·¯å°åŒ…æ•æ‰è³‡æ–™çš„æª”æ¡ˆæ ¼å¼ï¼Œæ˜¯èˆŠçš„ pcap æ ¼å¼çš„é€²åŒ–ç‰ˆï¼Œå®ƒæœƒæ¯” pcap å„²å­˜çš„è³‡æ–™é‚„è¦å¤šï¼Œå¯ä»¥åˆ†æçš„è³‡è¨Šä¹Ÿè¶Šå¤šã€‚ç›®å‰ Wireshark å¾ v1.8 é–‹å§‹ï¼Œé è¨­å°±æŠŠå°åŒ…å„²å­˜æ ¼å¼æ”¹æˆ pcapng</p>
</blockquote>
</li>
<li><p>Zui </p>
<ul>
<li><p>Zui å®ƒçš„å‰èº«æ˜¯Brim ï¼Œ æ˜¯ä¸€æ¬¾ç”¨æ–¼ç¶²è·¯æµé‡åˆ†æçš„å·¥å…·ï¼Œå®ƒæä¾›äº†ä½¿ç”¨è€…å‹å–„çš„åœ–å½¢åŒ–ä»‹é¢ï¼Œå¯ä»¥è®“ä½¿ç”¨è€…èƒ½å¤ å¿«é€Ÿåˆ†æèˆ‡è¦–è¦ºåŒ–å¤§é‡ç¶²è·¯æµé‡</p>
<p><img src="/assets/aEB_E59Bb6Ghcjk57wLkzd5kCFR_ATktueWQUMrKugE=.png"></p>
<p>é€™å€‹å·¥å…·è£¡é¢æ•´åˆäº†å…©å€‹ç¶²è·¯å°åŒ…åˆ†æå·¥å…·ï¼Œåˆ†åˆ¥æ˜¯Zeekã€Suricataï¼Œå…ˆç”¨ <a target="_blank" rel="noopener" href="https://github.com/brimdata/brimcap">brimcap</a> å°‡ pcap é€åˆ° Zeek&#x2F;Suricata åš summary&#x2F;logï¼Œå†åœ¨ Zui å…§ç”¨ correlation viewã€alert è¦–çª—ã€æˆ– detail pane åˆ†æäº‹ä»¶èˆ‡åŸå§‹å°åŒ…ã€‚</p>
<p>æ‰€ä»¥åªè¦å°‡pcap å°åŒ…ä¸Ÿé€²å» zeek ï¼Œä»–å°±æœƒé–‹å§‹é€²è¡Œåˆ†æ</p>
<p><img src="/assets/gyCnmYGl_VfYEuqKAOa8TyKLnNYYC6tohyAziYN13Ck=.png"></p>
<p>åˆ†æå®Œå¾ŒæŒ‰ä¸‹<code>Query Pool</code> å°±å¯ä»¥çœ‹åˆ°è¦–è¦ºåŒ–çš„é é¢</p>
<p><img src="/assets/aEB_E59Bb6Ghcjk57wLkzd5kCFR_ATktueWQUMrKugE=.png"></p>
<p>å¦å¤– Zui ä½¿ç”¨ Zedï¼ˆæˆ–ç¨± Zed query &#x2F; SuperSQLï¼‰ä¾†åšéæ¿¾èˆ‡è½‰æ›æŸ¥è©¢å¯ä»¥æ›´å¿«è™•ç†å¤§é‡è³‡æ–™</p>
<p>ä»¥ä¸‹åˆ†äº«å¹¾å€‹æ“ä½œ</p>
<p>é¦–å…ˆå¯ä»¥ç¯©é¸å‡ºSuricata è­¦å ±</p>
<pre class="line-numbers language-none"><code class="language-none">event_type&#x3D;&#x3D;&quot;alert&quot; #å¯ç¯©é¸å‡º Suricata è­¦å ±<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/s_W7IAAYyK-10fAyW9KpXLDpZhCSm8jgPMVAQABdehY=.png"></p>
<p>ä¹Ÿæœ‰åƒwireshark ä¸€æ¨£å¯ä»¥ç¯©é¸ ip scr or ip dst </p>
<pre class="line-numbers language-none"><code class="language-none">id.orig_h&#x3D;&#x3D;100.112.165.2 and id.resp_p&#x3D;&#x3D;53 #ä¾†æºip &#x3D; 100.112.165.2 ç›®æ¨™port &#x3D; 53<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/tWu_XB4kP452AJbgpcIQ0vOiRSROoPhmTNH13gBxRPg=.png"></p>
<p>å¦å¤–ä»–ä¹Ÿå¯ä»¥é€²è¡Œçµ±è¨ˆèˆ‡æ’åº</p>
<pre class="line-numbers language-none"><code class="language-none">count() by id.resp_p | sort -r  # å°ç›®æ¨™port é€²è¡Œçµ±è¨ˆï¼Œä¸¦é™å†ªæ’åº<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/mq6sPm0cAJqgKEiREZUwTYXNAvnegIR2DAfkVtRs4GQ=.png"></p>
<p>å°ä½ æƒ³è¦ç¯©é¸çš„è³‡æ–™æŒ‰å³éµå¯ä»¥è‡ªå‹•ç”ŸæˆæŸ¥è©¢æŒ‡ä»¤</p>
<p><img src="/assets/T2wzAhndl8-IWt4PObDgOI8JbPrlO9uiPokk5yl27do=.png"></p>
<p>æœ€å¾Œä¹Ÿå¯ä»¥ä¸‹è¼‰å®˜æ–¹æä¾›é å…ˆå¯«å¥½çš„æŸ¥è©¢</p>
<p>é€£çµï¼š[<a target="_blank" rel="noopener" href="https://github.com/brimdata/brimcap?tab=readme-ov-file#brimcap-queries">https://github.com/brimdata/brimcap?tab=readme-ov-file#brimcap-queries</a></p>
<p>](<a target="_blank" rel="noopener" href="https://github.com/brimdata/brimcap?tab=readme-ov-file#brimcap-queries)%E4%B8%8B%E8%BC%89%E5%BE%8Cqueries.json">https://github.com/brimdata/brimcap?tab=readme-ov-file#brimcap-queries)ä¸‹è¼‰å¾Œqueries.json</a> å¾ŒæŒ‰ä¸‹+çš„è—è‰²æŒ‰éˆ•ï¼Œé»é¸Import Queries</p>
<p><img src="/assets/777onBmZHXrrhqyTl2BNjPp328hH_BsS0lh761qK6Aw=.png"></p>
<p>æŠŠå‰›å‰›ä¸‹è¼‰çš„json æª”ä¸Ÿé€²å»ï¼Œå°±æœƒåŒ¯å…¥é å…ˆå¯«å¥½çš„query </p>
<p><img src="/assets/kndUjYMJJCjbP4n4KenQWusY9yA4lv4sKzYL_6Ke0lA=.png"></p>
</li>
</ul>
</li>
</ul>
<h2 id="Disk-Forensics"><a href="#Disk-Forensics" class="headerlink" title="Disk Forensics"></a>Disk Forensics</h2><p>winlog è·¯å¾‘ : <code>C:\Windows\System32\winevt\Logs</code></p>
<p>Register è·¯å¾‘ ï¼š<code>C:\Windows\System32</code></p>
<p>å¸¸è¦‹ Registry è·¯å¾‘</p>
<table>
<thead>
<tr>
<th><strong>Registry è·¯å¾‘</strong></th>
<th><strong>èªªæ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td>HKLM\SYSTEM\CurrentControlSet\Services</td>
<td>ç³»çµ±æœå‹™èˆ‡é©…å‹•ç¨‹å¼è³‡è¨Š</td>
</tr>
<tr>
<td>HKLM\SYSTEM\CurrentControlSet\Control\ComputerName\ActiveComputerName</td>
<td>é›»è…¦åç¨±</td>
</tr>
<tr>
<td>HKLM\SYSTEM\MountedDevices</td>
<td>ç£ç¢Ÿ&#x2F;USB è£ç½®æ›è¼‰è³‡è¨Š</td>
</tr>
<tr>
<td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</td>
<td>ç³»çµ±å•Ÿå‹•æ™‚è‡ªå‹•åŸ·è¡Œç¨‹å¼</td>
</tr>
<tr>
<td>HKLM\SAM\SAM\Domains\Account\Users</td>
<td>æœ¬æ©Ÿå¸³è™Ÿè³‡è¨Š</td>
</tr>
</tbody></table>
<ul>
<li><p>SAMï¼šå„²å­˜æœ¬åœ°ä½¿ç”¨è€…å¸³è™Ÿèˆ‡ç¾¤çµ„çš„è³‡è¨Šï¼Œä¾‹å¦‚ä½¿ç”¨è€…åç¨±ã€å»ºç«‹æ™‚é–“ã€æœ€å¾Œç™»å…¥æ™‚é–“ã€‚</p>
<ul>
<li>Domain å¸³è™Ÿè³‡è¨Šåœ¨ Domain Controller çš„ NTDS.dit</li>
</ul>
</li>
<li><p>SECURITYï¼šåŒ…å«ä½¿ç”¨è€…å¸³è™Ÿçš„å®‰å…¨ç›¸é—œè³‡è¨Šï¼Œä¾‹å¦‚å¯†ç¢¼æ”¿ç­–ã€‚</p>
</li>
<li><p>SOFTWAREï¼šç´€éŒ„æ‰€æœ‰å·²å®‰è£è»Ÿé«”ï¼ˆåŒ…å« Windows å…§å»ºèˆ‡ç¬¬ä¸‰æ–¹è»Ÿé«”ï¼‰ã€‚</p>
</li>
<li><p>SYSTEMï¼šå„²å­˜ç³»çµ±å±¤ç´šçš„çµ„æ…‹è³‡è¨Šï¼Œä¾‹å¦‚äº‹ä»¶æ—¥èªŒè¨­å®šã€ç¡¬é«”ï¼ˆåƒæ˜¯ USB è£ç½®ï¼‰ç›¸é—œçš„è¨­å®šã€‚</p>
</li>
</ul>
<h3 id="MFT"><a href="#MFT" class="headerlink" title="$MFT"></a>$MFT</h3><p>è·¯å¾‘ï¼š<code>&lt;Volume_Root&gt;\$MFT</code></p>
<p>$MFT æ˜¯ NTFS æª”æ¡ˆç³»çµ±çš„æ ¸å¿ƒå…ƒä»¶ï¼Œå„²å­˜æ‰€æœ‰æª”æ¡ˆå’Œç›®éŒ„çš„metadataï¼ˆå¦‚åç¨±ã€å¤§å°ã€æ™‚é–“æˆ³ã€æ¬Šé™ç­‰ï¼‰ã€‚<br>ç”±ä¸€ç³»åˆ—å›ºå®šå¤§å°çš„æª”æ¡ˆè¨˜éŒ„çµ„æˆï¼Œæ¯å€‹è¨˜éŒ„åŒ…å«ä¸€å€‹æª”æ¡ˆæˆ–ç›®éŒ„çš„æ‰€æœ‰å±¬æ€§ã€‚</p>
<p>ä¸‹æ–¹åœ–ç‰‡æ˜¯ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">MFT Explorer</a> æŠŠ MFT å…§çš„è³‡æ–™è¦–è¦ºåŒ–é¡¯ç¤ºå‡ºä¾†</p>
<p><img src="/assets/LKoPSOtJbxLBBf-25Wy6a6Pdf2PagV_pacqey3WPJBw=.png"></p>
<h3 id="UsnJrnl"><a href="#UsnJrnl" class="headerlink" title="$UsnJrnl"></a>$UsnJrnl</h3><p>è·¯å¾‘ï¼š<code>&lt;Volume_Root&gt;\$Extend\$UsnJrnl:$J</code></p>
<p>$UsnJrnl çš„ä¸»è¦åŠŸèƒ½æ˜¯è¿½è¹¤ NTFS ä¸Šæ‰€æœ‰æ–‡ä»¶èˆ‡ç›®éŒ„çš„è®Šæ›´ã€‚æ¯ç•¶æ–‡ä»¶è¢«å‰µå»ºã€ä¿®æ”¹ã€åˆªé™¤ã€é‡å‘½åã€ç§»å‹•ï¼Œæˆ–å…¶å±¬æ€§ï¼å®‰å…¨æè¿°ç¬¦ç™¼ç”Ÿè®ŠåŒ–æ™‚ï¼Œ$UsnJrnl éƒ½æœƒè¨˜éŒ„ä¸€æ¢å°æ‡‰æ¢ç›®ã€‚é€™äº›æ¢ç›®åŒ…æ‹¬è®Šæ›´é¡å‹ã€ç™¼ç”Ÿæ™‚é–“ã€é—œè¯çš„ USNï¼ˆæ›´æ–°åºåˆ—è™Ÿï¼‰ã€æ–‡ä»¶ IDã€çˆ¶ç›®éŒ„ IDã€æ–‡ä»¶åç¨±ã€å±¬æ€§èˆ‡å¤§å°ç­‰è³‡è¨Šï¼Œä½†å› ç‚ºç´€éŒ„çš„æ¯”è¼ƒè©³ç´°ï¼Œæ‰€ä»¥å¤§ç´„åªæœƒè¨˜éŒ„åˆ°1~2å¤©çš„è³‡è¨Šã€‚</p>
<p><img src="/assets/cQfi8Udc0DTBsNYPvThawCXqM082PrXrodQAtZ_VH8Q=.png"></p>
<h3 id="LogFile"><a href="#LogFile" class="headerlink" title="$LogFile"></a>$LogFile</h3><p>è·¯å¾‘ï¼š<code>&lt;Volume_Root&gt;\$LogFile</code></p>
<p>$LogFile èˆ‡ $UsnJrnl ç´€éŒ„çš„å…§å®¹å·®ä¸å¤šï¼Œä½†æ˜¯ç´€éŒ„çš„æ˜¯æ›´åº•å±¤çš„æ“ä½œï¼Œå…¶åŠŸèƒ½æ˜¯ä½œç‚º NTFS çš„ transaction logï¼Œè¨˜éŒ„å° metadata æ‰€åšçš„å„ç¨®æ“ä½œï¼ˆå¦‚ MFT æ–°å¢ï¼ä¿®æ”¹ï¼åˆªé™¤ã€ç›®éŒ„ç´¢å¼•æ›´æ–°ã€Bitmap Allocationã€$UsnJrnl æœ¬èº«çš„æ›´æ–°ç­‰ï¼‰ã€‚åœ¨é€²è¡Œ metadata è®Šæ›´å‰ï¼Œç³»çµ±æœƒå…ˆå°‡é€™äº›äº¤æ˜“å¯«å…¥ $LogFileï¼Œä»¥ç¢ºä¿å³ä¾¿ç³»çµ±æ„å¤–ä¸­æ–·ï¼Œä¹Ÿå¯åˆ©ç”¨æ—¥èªŒé€²è¡Œå›æ»¾æˆ–é‡åšæ“ä½œï¼Œä»¥ä¿æŒæ–‡ä»¶ç³»çµ±çš„ä¸€è‡´æ€§èˆ‡å®Œæ•´æ€§ã€‚</p>
<p><img src="/assets/0rdT1ORbwNlebwEt7OXnRopij-tFJVEr5PXan4DQRoA=.png"></p>
<h3 id="I30"><a href="#I30" class="headerlink" title="$I30"></a>$I30</h3><p>åœ¨ NTFS æª”æ¡ˆç³»çµ±ä¸­ï¼Œæ¯ä¸€å€‹ Directory éƒ½ç¶­è­·ä¸€å€‹ Indexï¼Œç”¨ä¾†å¿«é€ŸæŸ¥æ‰¾è©²ç›®éŒ„ä¸‹çš„æª”æ¡ˆèˆ‡å­ç›®éŒ„ï¼Œç•¶ç›®éŒ„å…§å®¹æ”¹è®Š (å¦‚æ–°å¢ã€åˆªé™¤ã€é‡å‘½å) æ™‚ï¼Œå°æ‡‰çš„ index entry ä¹Ÿæœƒè¢«ä¿®æ”¹æˆ–æ¨™è¨˜ç‚ºå·²åˆªé™¤ (Flags æ¬„ä½)ï¼Œå› ç‚ºæ˜¯æ¨™è¨˜çš„é—œä¿‚ï¼Œæ‰€ä»¥å¯ä»¥åœ¨<code>$I30</code> ä¸­æ‰¾åˆ°è¢«åˆªé™¤çš„æª”æ¡ˆã€‚</p>
<p><img src="/assets/CGFDolSOV19jk_scmOtNOnpFMABkF3YeLx_g2mG76Lw=.png"></p>
<h3 id="Amcache-hve"><a href="#Amcache-hve" class="headerlink" title="Amcache.hve"></a>Amcache.hve</h3><p>è·¯å¾‘ä½ç½®ï¼š<code>%WinDir%\AppCompat\Programs\Amcache.hve</code></p>
<p><img src="/assets/Ybc_QgFK9UsOKi7pW8blJhLBDXDmoh5zkDgOjPsqhkw=.png"></p>
<p>è‡ª Windows 8 èµ·å¼•å…¥ï¼Œè¨˜éŒ„äº†å·²åŸ·è¡Œæ‡‰ç”¨ç¨‹å¼çš„è©³ç´°è³‡è¨Šï¼ŒåŒ…æ‹¬æª”æ¡ˆè·¯å¾‘ã€SHA-1 é›œæ¹Šå€¼ã€æ™‚é–“æˆ³è¨˜ç­‰ã€‚</p>
<p><strong>è‹¥æƒ¡æ„ç¨‹å¼æœ¬é«”è¢«åˆªé™¤æˆ–é­æ¸…é™¤ï¼Œç„¡æ³•å¾æ˜ åƒç›´æ¥çœ‹åˆ°è©²æª”æ¡ˆæœ¬èº«æ™‚</strong>ï¼Œå¯ä»¥é€é Amcache çš„è¨˜éŒ„å»é©—è­‰æ˜¯å¦å­˜åœ¨</p>
<h3 id="NTUSER-DAT"><a href="#NTUSER-DAT" class="headerlink" title="NTUSER.DAT"></a>NTUSER.DAT</h3><p>è·¯å¾‘ä½ç½®ï¼š<code>C:\Users\&lt;username&gt;\NTUSER.DAT</code></p>
<p><img src="/assets/HbBDSu1lraXx3pIgsNxHGOqZHdhNnyuWDrcCEMR8-1A=.png"></p>
<p>NTUSER.DAT æ˜¯ Windows æ¯å€‹ä½¿ç”¨è€…å¸³æˆ¶åœ¨å…¶ä½¿ç”¨è€…è¨­å®šæª”åº•ä¸‹çš„ä¸€å€‹æª”æ¡ˆï¼Œç”¨ä¾†å„²å­˜èˆ‡è©²å¸³æˆ¶ç›¸é—œçš„ Registry è¨­å®šèˆ‡ä½¿ç”¨è€…åå¥½ï¼Œåœ¨ä½¿ç”¨è€…ç™»å…¥æ™‚ï¼Œç³»çµ±æœƒå°‡é€™å€‹æª”æ¡ˆå°æ‡‰åˆ°è¨»å†Šè¡¨çš„ HKEY_CURRENT_USERï¼ˆHKCUï¼‰ åˆ†æ”¯ï¼Œè®“è©²ä½¿ç”¨è€…çš„ä½œæ¥­èˆ‡æ‡‰ç”¨ç¨‹å¼å¯ä»¥è®€å¯«å…¶å€‹äººè¨­å®šï¼›åœ¨ç™»å‡ºæˆ–é—œæ©Ÿæ™‚ï¼Œé€™äº›è®Šæ›´æœƒå›å¯«åˆ° NTUSER.DATã€‚</p>
<p>å¯ä»¥ç›´æ¥ç”¨ <a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">RegistryExplorer</a> æŸ¥çœ‹ã€‚</p>
<p><img src="/assets/RIvMLfCdh5rrb81bTPyBEaPuSO1d-zFoxpUOjAMwYo8=.png"></p>
<p>é€™é‚Šé‡é»æå…©å€‹æ¯”è¼ƒç‰¹åˆ¥çš„ key</p>
<h3 id="UserAssist"><a href="#UserAssist" class="headerlink" title="UserAssist"></a>UserAssist</h3><p>key è·¯å¾‘ï¼š<code>Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\&#123;GUID&#125;\Count</code></p>
<p>UserAssist æ˜¯ Windows ç”¨ä¾†è¿½è¹¤ä½¿ç”¨è€…é€éåœ–å½¢ä»‹é¢å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼æˆ–æ·å¾‘çš„çµ±è¨ˆè¨˜éŒ„æ©Ÿåˆ¶ï¼Œè£¡é¢æœƒåŒ…å«ç¨‹å¼çš„åŸ·è¡Œæ¬¡æ•¸ã€æœ€å¾ŒåŸ·è¡Œæ™‚é–“ã€<strong>Focus Countã€Focus Time</strong></p>
<p><img src="/assets/EX1XBHpXaNJ2rj-3d0M_GUZyaVjDpWQwmaKNE1NvYuY=.png"></p>
<h3 id="ShellBags"><a href="#ShellBags" class="headerlink" title="ShellBags"></a>ShellBags</h3><p>ShellBags æ˜¯ Windows ç”¨æ–¼è¨˜éŒ„ä½¿ç”¨è€…åœ¨æª”æ¡ˆç¸½ç®¡ä¸­ç€è¦½<strong>è³‡æ–™å¤¾</strong>æ™‚çš„è¨­å®šåå¥½èˆ‡æª”æ¡ˆå¤¾è¨ªå•ç´€éŒ„ï¼ŒåŒ…æ‹¬è³‡æ–™å¤¾çš„è¦–çª—é…ç½® &#x2F; æª¢è¦–æ¨£å¼ &#x2F; æ’åˆ—æ–¹å¼ &#x2F; å¤§å° &#x2F; ä½ç½®ç­‰ï¼Œä»£è¡¨å¦‚æœ‰åˆªé™¤æˆ–å­˜å–è³‡æ–™å¤¾çš„æ“ä½œæœƒè¢«è¨˜éŒ„åœ¨ ShellBags ç•¶ä¸­ã€‚</p>
<p>å®ƒæœƒä¾ç…§ä½œæ¥­ç³»çµ±å­˜åœ¨ä¸åŒåœ°æ–¹</p>
<ul>
<li><code>&lt;NTUSER.DAT&gt;\Software\Microsoft\Windows\Shell\BagMRU </code></li>
<li><code>&lt;NTUSER.DAT&gt;\Software\Microsoft\Windows\Shell\Bags</code></li>
<li>åœ¨è¼ƒæ–° Windows ç‰ˆæœ¬ï¼ˆå¦‚ Windows 7 ä¹‹å¾Œï¼‰ï¼Œéƒ¨åˆ† ShellBags è³‡æ–™æœƒå­˜æ–¼ <code>C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows\UsrClass.dat</code></li>
<li>åœ¨æŸäº› Windows ç‰ˆæœ¬æˆ–ä½¿ç”¨è€…è¨­å®šä¸­ï¼Œéƒ¨åˆ† ShellBags æ¢ç›®åªå­˜åœ¨æ–¼ UsrClass.dat è€Œé NTUSER.DAT</li>
</ul>
<p><img src="/assets/pnKEJ4vqw21ZBolGw34xhCg7XGai0iP7POjOr8NtI2I=.png"></p>
<p>å¦‚æœç›´æ¥ä½¿ç”¨ RegistryExplorer æœƒå¾ˆé›£é–±è®€ï¼Œå»ºè­°ä½¿ç”¨ Eric Zimmermanâ€™s tools ä¸­çš„ ShellBags Explorer æŸ¥çœ‹</p>
<h3 id="Prefetch"><a href="#Prefetch" class="headerlink" title="Prefetch"></a>Prefetch</h3><p>ä½ç½®ï¼š<code>%WinDir%\prefetch</code></p>
<p>Prefetchï¼ˆ.pfï¼‰æ˜¯ Windows ç‚ºäº†åŠ é€Ÿç¨‹å¼å•Ÿå‹•è€Œç¶­è­·çš„å¿«å–æª”æ¡ˆã€‚ç³»çµ±æœƒåœ¨ <code>%WinDir%\prefetch</code> è·¯å¾‘ä¸‹ç‚ºåŸ·è¡Œéçš„å¯åŸ·è¡Œæª”å»ºç«‹ .pf æª”ï¼Œè£¡é¢åŒ…å«ï¼š</p>
<ol>
<li><strong>åŸ·è¡Œæ™‚é–“æˆ³</strong>ï¼šWindows 8 ä»¥å¾Œçš„ Prefetch èƒ½è¨˜éŒ„å¤šé” 8 å€‹åŸ·è¡Œæ™‚é–“é»ï¼Œå¯ç”¨ä¾†å»ºç«‹äº‹ä»¶æ™‚é–“ç·šï¼Œå¦å¤– Prefetch çš„æ™‚é–“æˆ³åœ¨ç²¾ç¢ºåˆ°ç§’æ™‚é€šå¸¸è¦æ¸›æ‰ 10 ç§’ï¼Œåœ¨åšç²¾ç´°æ™‚é–“å°å¸³æ™‚è¦ç•™æ„æ­¤å·®ç•°ï¼Œ<a target="_blank" rel="noopener" href="https://www.thedfirspot.com/post/artifacts-of-execution-i-know-what-you-did-last-incident?utm_source=chatqpt.com">åƒè€ƒç¶²å€</a>ã€‚ </li>
<li><strong>Run count</strong>ï¼šè¡¨ç¤ºè©²ç¨‹å¼è¢«åŸ·è¡Œäº†å¤šå°‘æ¬¡ã€‚ </li>
<li><strong>å¯åŸ·è¡Œæª”åç¨±èˆ‡è·¯å¾‘</strong>ï¼šæŒ‡å‡ºå¯¦éš›è¢«åŸ·è¡Œçš„æª”æ¡ˆèˆ‡ä¾†æºè·¯å¾‘ï¼Œå°åˆ¤æ–·æƒ¡æ„è»Ÿé«”çš„è½é»å¾ˆé‡è¦ã€‚ </li>
<li><strong>ç¨‹å¼å•Ÿå‹•æ™‚å­˜å–éçš„æª”æ¡ˆæ¸…å–®</strong>ï¼šæœ‰æ™‚æœƒåˆ—å‡ºå…¶ä»–è¢«å‘¼å«æˆ–è¼‰å…¥çš„ DLLã€è·¯å¾‘ï¼Œå¯ç”¨ä¾†æ‰¾å‡ºç¨‹å¼çš„è¡Œç‚ºéˆï¼Œä¾‹å¦‚é–‹å•Ÿå“ªäº›æª”ã€‚ </li>
<li><strong>volume &#x2F; system infoã€åŸ·è¡Œæª”é›œæ¹Šç­‰å…ƒè³‡æ–™</strong>ï¼šå¯ç”¨ä¾†ç¢ºèªæ˜¯åœ¨å“ªå€‹ volume &#x2F; æ©Ÿå™¨ä¸Šè¢«åŸ·è¡Œ</li>
</ol>
<p>æª”åé€šå¸¸æœƒé•·å¾—åƒ PROGRAM.EXE-XXXXXXXX.pfï¼Œå¾Œé¢çš„ 8 å­—å…ƒç‚ºè·¯å¾‘é›œæ¹Šï¼Œç”¨ä¾†å€åˆ†ç›¸åŒåç¨±ä½†è·¯å¾‘ä¸åŒçš„åŸ·è¡Œæª”ã€‚</p>
<p><img src="/assets/Kq6MvDG5ev05EwQcxGDnrfk7YXkBzYtWCCX0F1_nnas=.png"></p>
<p>ç‚ºäº†è®€å–è£¡é¢çš„è³‡æ–™ï¼Œå¯ä»¥ä½¿ç”¨ Eric Zimmermanâ€™s tools ç•¶ä¸­çš„ PECmd è½‰æ›æˆ CSV æª”</p>
<h3 id="Shimcache"><a href="#Shimcache" class="headerlink" title="Shimcache"></a>Shimcache</h3><p>ä½ç½®ï¼š</p>
<p>ç´€éŒ„ç³»çµ±æ›¾ã€Œçœ‹é&#x2F;å­˜å–ã€çš„å¯åŸ·è¡Œæª”è³‡è¨Šï¼Œä½†<strong>ä¸ä¿è­‰ä¸ä¸€å®šåŸ·è¡Œ</strong>ï¼Œæ›´æ–°çš„æ™‚é–“æ˜¯å¯«å…¥ Register çš„æ™‚é–“ï¼Œé€šå¸¸æ˜¯é—œæ©Ÿ&#x2F;é‡å•Ÿæ™‚ï¼Œ</p>
<p>ç´€éŒ„çš„æ˜¯æª”æ¡ˆä¿®æ”¹æ™‚é–“ Last Modify Time ï¼Œ</p>
<p>æœƒæœ‰ä¸€å€‹ Cache Entry ï¼Œæ•¸å­—è¶Šå¤§ä»£è¡¨è¶Šæ—©å‡ºç¾ï¼Œé€™æ¨£å¯ä»¥çŸ¥é“æœ‰å“ªäº›ç¨‹å¼æ¯”æƒ¡æ„ç¨‹å¼æ›´æ—©æˆ–æ›´æ™šå‡ºç¾</p>
<h3 id="BAM-DAM"><a href="#BAM-DAM" class="headerlink" title="BAM&#x2F;DAM"></a>BAM&#x2F;DAM</h3><p>Windows 10+ ç”¨æ–¼ç®¡ç†èƒŒæ™¯æ‡‰ç”¨ç¨‹å¼è³‡æºä½¿ç”¨æ©Ÿåˆ¶ï¼Œç´€éŒ„ç¨‹å¼æœ€å¾ŒåŸ·è¡Œæ™‚é–“èˆ‡å®Œæ•´è·¯å¾‘</p>
<ul>
<li>å¿«é€Ÿç¢ºèªç¨‹å¼æœ€è¿‘ä¸€æ¬¡åŸ·è¡Œæ™‚é–“</li>
</ul>
<h3 id="SRUM"><a href="#SRUM" class="headerlink" title="SRUM"></a>SRUM</h3><p>è·¯å¾‘ï¼šC:\windows\system32\sru\SRUDB.dat</p>
<ul>
<li>ç´€éŒ„é€™éš»ç¨‹å¼ä½¿ç”¨äº†å¤šå°‘<strong>ç¶²è·¯æµé‡</strong></li>
</ul>
<p>æ³¨æ„è³‡æ–™ç´„æ¯ 60 åˆ†é˜æ›´æ–°ä¸€æ¬¡ï¼Œä¸æ˜¯å³æ™‚ç´€éŒ„</p>
<h3 id="PSReadLine"><a href="#PSReadLine" class="headerlink" title="PSReadLine"></a>PSReadLine</h3><p>è·¯å¾‘ï¼šC:\Users\<Users>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadLine\ConsoleHost_history.txt</p>
<p>Powershell å‘½ä»¤æ­·å²ç´€éŒ„ï¼Œæª”æ¡ˆç‚ºç´”æ–‡å­—ï¼Œç´€éŒ„ä½¿ç”¨è€…ä¹‹å‰ä¸‹éçš„ powershell æŒ‡ä»¤</p>
<h2 id="å·¥å…·ï¼š"><a href="#å·¥å…·ï¼š" class="headerlink" title="å·¥å…·ï¼š"></a>å·¥å…·ï¼š</h2><ul>
<li><p>AutoSpy</p>
</li>
<li><p>R-studio</p>
<ul>
<li>$MFT viewer</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://sites.google.com/site/forensicnote/ntfs-log-tracker">NTFS Log Tracker</a></p>
<p>  NTFS Log Tracker æ˜¯ä¸€æ¬¾å°ˆé–€ç”¨ä¾†è§£æ NTFS ä¸Š $LogFile å’Œ UsnJrnl:$J çš„å·¥å…·ã€‚ å®ƒå¯ä»¥å¾äº¤æ˜“æ—¥èªŒèˆ‡è®Šæ›´æ—¥èªŒä¸­æŒ‘å‡ºæª”æ¡ˆï¼ç›®éŒ„æ“ä½œçš„è¨˜éŒ„ã€‚</p>
<p>  <img src="/assets/icAM7IWI3LvNSrDBmhOmy5cGEzp09GpK-dinwOSbtyU=.png"></p>
<p>  å¡«ä¸Šå°æ‡‰æª”æ¡ˆçš„è·¯å¾‘</p>
<p>  <img src="/assets/hFcjva1sejXuwvwZjLaD60MFdZe6FS2HDJgTsNGphjE=.png"></p>
<p>  æŒ‰ä¸‹å³ä¸Šè§’çš„ Parse ä¹‹å¾Œæœƒå…ˆæŠŠè³‡æ–™éƒ½å„²å­˜æˆä¸€å€‹ DBï¼Œé€™é‚Šå¹«å®ƒå–åä»¥åŠè¼¸å‡ºçš„è·¯å¾‘</p>
<p>  <img src="/assets/EOWJWa9jI9Oo_YlfKFZjHfHSsssQj7qrHWYUPRjkGao=.png"></p>
<p>  é¸æ“‡å¥½å¾Œå°±æœƒé–‹å§‹é€²è¡Œåˆ†æ</p>
<p>  <img src="/assets/DG2D3gmzJq6Xs7ar_F0kw4LThRBfLuUG7aIE9lyk8oE=.png"></p>
<p>  çµæŸå¾Œå°±æœƒå‡ºç¾ $LogFile ä»¥åŠ UsnJrnl:$J çš„å…§å®¹</p>
<p>  <img src="/assets/0m_erXlMLOZR4CnCdmW7tevpuuIOkLZCdUxp95dTunY=.png"></p>
<p>  å¦å¤–ä¹Ÿå¯ä»¥æŠŠå®ƒå€‘åŒ¯å‡ºæˆ CSV æª”æ¡ˆ</p>
<p>  <img src="/assets/-QjIqTFArdJExEa85qymNdtSPPa_HZOrYVz2fmOQOWc=.png"></p>
<p>  åŒæ¨£å¯ä»¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">Timeline Explorer</a> æˆ–è€…å…¶ä»–æŸ¥çœ‹ CSV æª”æ¡ˆçš„è»Ÿé«”æŸ¥çœ‹</p>
<p>  <img src="/assets/g1tx-sJ6dvFR19b2NJ-SlCuIZDWt8F5_Ajg0pKzuXH4=.png"></p>
</li>
</ul>
<h3 id="Eric-Zimmermanâ€™s-Tools"><a href="#Eric-Zimmermanâ€™s-Tools" class="headerlink" title="Eric Zimmermanâ€™s Tools"></a><a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">Eric Zimmermanâ€™s Tools</a></h3><ul>
<li><p>MFTECmd</p>
<p>MFTECmd æ˜¯ç”±æ•¸ä½é‘‘è­˜å°ˆå®¶ Eric Zimmerman é–‹ç™¼çš„ Windows command-line å·¥å…·ï¼Œ</p>
<p>ç”¨ä¾†è§£æ NTFS æª”æ¡ˆç³»çµ±ä¸­ç”± $MFT èˆ‡å…¶è¡ç”Ÿç´€éŒ„ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>$MFT</li>
<li>$LogFile</li>
<li>$UsnJrnl</li>
<li>$Boot</li>
<li>$Secure</li>
<li>$Extend\$UsnJrnl</li>
<li>$I30</li>
</ul>
<p>ä¸¦å°‡å…¶è½‰æˆ CSV æª”æ¡ˆ</p>
<p>é¦–å…ˆæ‰¾åˆ°è¦é‘‘è­˜çš„ç›®éŒ„ï¼Œä¸¦æå–å…¶ <code>$I30</code> å…§å®¹</p>
<p><img src="/assets/pWkdQsp10SNyj8hJ5rJ2V_jEM1SYnI-z8-Hak-LF6N0=.png"></p>
<p>æ¥ä¸‹ä¾†ä¸‹æŒ‡ä»¤å°‡å®ƒè½‰æ›æˆ CSV æª”æ¡ˆ</p>
<p><img src="/assets/FPsRisIYrXMyG_LyDIXtF63__b0J8jlG8LpqAm0sPQ0=.png"></p>
<p>è½‰æ›å¾Œå¯ä»¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">Timeline Explorer</a> æˆ–è€…å…¶ä»–æŸ¥çœ‹ CSV æª”æ¡ˆçš„è»Ÿé«”æŸ¥çœ‹</p>
<p><img src="/assets/XM56jj6p4EatiIDTljlbRIsJ-SHMJj8bBHFqZ69r9RI=.png"></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/strozfriedberg/sidr">SIDR</a></p>
<ul>
<li>windows Search Index Database Reporter</li>
<li>detect the delete file</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">shellbagsexplorer</a></p>
<p>  ShellBags Explorer æ˜¯ç”± Eric Zimmerman æ‰€é–‹ç™¼çš„ä¸€æ¬¾å°ˆé–€ç”¨ä¾†ç€è¦½èˆ‡è§£æ Windows ShellBags è³‡æ–™çš„å·¥å…·ï¼Œå°‡ BagMRU &#x2F; Bags çš„è¨»å†Šè¡¨è³‡æ–™è§£æç‚ºè³‡æ–™å¤¾å±¤ç´šæ¨¹ç‹€è¦–åœ–ï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨è€…æ›¾ç€è¦½éå“ªäº›è³‡æ–™å¤¾</p>
<p>  å®ƒçš„ä»‹é¢è·Ÿ RegistryExplorer å·®ä¸å¤šï¼Œä¸€æ¨£éœ€è¦åŒ¯å…¥ hiveï¼Œçœ‹ä½œæ¥­ç³»çµ±ç‰ˆæœ¬åŒ¯å…¥ <code>NTUSER.DAT</code> æˆ–è€… <code>UsrClass.dat</code></p>
<p>  <img src="/assets/MvUItWpVpa5jnJsYBxUDs0mF7EWLYanjudpkwnoJOs8=.png"></p>
<p>  åŒ¯å…¥å¾Œå°±å¯ä»¥çœ‹åˆ° ShellBags è³‡è¨Š</p>
<p>  <img src="/assets/wVsOpk-GTmT9mXzGHEOn72qufR43sE350d2ofw13oh4=.png"></p>
</li>
<li><p>LECmd</p>
<ul>
<li>to see link file<br>  <code>LECmd.exe -d &quot;C:\Users\Administrator\Desktop\Start Here\Artifacts&quot; --csvf lnk.csv --csv &quot;C:\Users\Administrator\Desktop\lnk-files&quot;</code></li>
</ul>
</li>
<li><p>jumpLists Explorer</p>
</li>
<li><p>USB Forensics tracker </p>
</li>
<li><p>WxTCMD</p>
<ul>
<li>analyze timeline data base to csv file </li>
<li>â€œC:\Users\ <user>\AppData\Local\ConnectedDevicesPlatform\L.<user>\ActivitiesCache.dbâ€</li>
</ul>
</li>
<li><p>RegistryExplorer</p>
<p>  <img src="/assets/U_Af3Nuy6jkoJVOBYMEK0JxMY0oldryrcEpKqJiiFYg=.png"></p>
<p>  å¦å¤–æœ‰æ™‚å€™åŒ¯å…¥ Hive æ™‚æœƒå‡ºç¾é€™æ¨£çš„è­¦å‘Š</p>
<p>  <img src="/assets/1R6SsxPjf6RH4H9TTieYwGk_l_SPDaEw3IEEwytPx7U=.png"></p>
<p>  æ­¤è­¦å‘Šè¡¨ç¤ºä¸» hive æª”æ¡ˆèˆ‡å…¶ transaction logs (.LOG) çš„åºè™Ÿä¸ä¸€è‡´ï¼Œä»£è¡¨ transaction log ä¸­å­˜åœ¨å°šæœªåŒæ­¥åˆ°ä¸»æª”æ¡ˆçš„è®Šæ›´ã€‚</p>
<p>  Windows Registry æ¡ç”¨ write-ahead logging æ©Ÿåˆ¶ï¼šä¿®æ”¹æ™‚å…ˆå¯«å…¥è¨˜æ†¶é«”å¿«å–ï¼Œå†è¨˜éŒ„åˆ° transaction logï¼Œæœ€å¾Œæ‰å®šæœŸ flush åˆ°ä¸» hive æª”æ¡ˆã€‚è€Œç•¶ log æª”æ¡ˆçš„åºè™Ÿå¤§æ–¼ä¸»æª”æ¡ˆæ™‚ï¼Œé€™å€‹ hive å°±æœƒè¢«ç¨±ç‚º <strong>Dirty Hive</strong> </p>
<p>  æŒ‰ä¸‹ Yes ä¹‹å¾Œå°±æœƒé–‹å§‹é€²è¡Œèˆ‡ transaction logs çš„åˆä½µ</p>
<p>  <img src="/assets/aMqvxrwhRPljyqQ9q7YZGnDq-qwqUj9tamap8pHlCCI=.png"></p>
<p>  é¸æ“‡ transaction logs</p>
<p>  <img src="/assets/vV7W6Z8NLSy3_PqzONNNI-lZkXLVGK3gjQLIHimlGyA=.png"></p>
<p>  é¸æ“‡å¾Œå®ƒå°±æœƒå¹«ä½ åˆä½µï¼Œåˆä½µå®Œå¾Œå…ˆå„²å­˜åˆ°ä¸€å€‹åœ°æ–¹</p>
<p>  <img src="/assets/zWmyczb4k7Jxotypg0j4NvhrhaU-1uXbQ3tgONIuTxo=.png"></p>
<p>  å­˜å®Œå¾Œå°±å¯ä»¥çœ‹é€™å€‹åˆä½µéå¾Œçš„ Hive </p>
<p>  <img src="/assets/-Nlg6ItibiOChztpvL-_Bj38i8jwo1N9KOo1v6D0c30=.png"></p>
<p>  Registry Explorer å·¥å…·é™¤äº†å¯ä»¥æŸ¥çœ‹ä¹‹å¤–å®ƒé‚„æœ‰é è¨­æ›¸ç±¤å¯ä»¥ä½¿ç”¨ï¼Œå¿«é€Ÿå®šä½åˆ°æƒ³è¦çœ‹çš„ key </p>
<p>  <img src="/assets/ias4TQfhKvlTF0pKOS0CDMBbNHwjRZQ8-186lYojnGA=.png"></p>
</li>
<li><p>WinPrefetchView</p>
</li>
<li><p>SrumECmd</p>
</li>
<li><p>AmcacheParser</p>
<p>AmcacheParser æ˜¯ç”±æ•¸ä½é‘‘è­˜å°ˆå®¶ Eric Zimmerman æ‰€é–‹ç™¼çš„ä¸€æ¬¾å‘½ä»¤åˆ—å·¥å…·ï¼Œå°ˆé–€ç”¨æ–¼è§£æ Windows ç³»çµ±ä¸­çš„ Amcache.hve è¨»å†Šæª”ï¼Œæ”¯æ´å°‡è§£æçµæœè¼¸å‡ºç‚º CSV æ ¼å¼ï¼Œæ–¹ä¾¿å¾ŒçºŒåˆ†æèˆ‡è™•ç†</p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">PS C:\Users\yunshiuan\Desktop\net9 &gt; .\AmcacheParser.exe -f C:\Users\yunshiuan\Desktop\Amcache.hve_clean --csv C:\Users\yunshiuan\Desktop
AmcacheParser version 1.5.2.0

Author: Eric Zimmerman (saericzimmerman@gmail.com)
https:&#x2F;&#x2F;github.com&#x2F;EricZimmerman&#x2F;AmcacheParser

Command line: -f C:\Users\yunshiuan\Desktop\Amcache.hve_clean --csv C:\Users\yunshiuan\Desktop

Warning: Administrator privileges not found!

Unknown value name when processing DevicePnp at path &#123;11517B7C-E79D-4e20-961B-75A811715ADD&#125;\Root\InventoryDevicePnp\display&#x2F;default_monitor&#x2F;1&amp;1f0c3c2f&amp;0&amp;uid256: ManifestPath

C:\Users\yunshiuan\Desktop\Amcache.hve_clean is in new format!

Total file entries found: 240
Total shortcuts found: 51
Total device containers found: 13
Total device PnPs found: 94
Total drive binaries found: 373
Total driver packages found: 4

Found 123 unassociated file entry

Results saved to: C:\Users\yunshiuan\Desktop

Total parsing time: 0.909 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒçš„è¼¸å‡ºæœƒæœ‰å¾ˆå¤š CSV æª”ï¼Œå¯èƒ½æœƒå‡ºç¾ä¸‹é¢æª”æ¡ˆ</p>
<table>
<thead>
<tr>
<th><strong>Amcache_ProgramEntries.csv</strong></th>
<th>ç¨‹å¼æ¢ç›®ï¼ˆPrograms Entryï¼‰</th>
<th>æè¿°è¨»å†Šåœ¨ Amcache â€œProgramsâ€ åˆ†æ”¯ä¸‹çš„æ‡‰ç”¨ç¨‹å¼è³‡è¨Šï¼Œå¦‚å®‰è£è³‡è¨Šæˆ–è¨»å†Šçš„ç¨‹å¼æ¢ç›®ã€‚</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Amcache_AssociatedFileEntries.csv</strong></td>
<td>é—œè¯çš„æª”æ¡ˆæ¢ç›®</td>
<td>æŒ‡é‚£äº›èƒ½å¤ è¢«å°æ‡‰ï¼ˆæˆ–é—œè¯ï¼‰åˆ°ç¨‹å¼æ¢ç›®çš„æª”æ¡ˆæ¢ç›®ï¼ˆFile entriesï¼‰ã€‚å³é‚£äº›è¢«å®‰è£ç¨‹å¼æ‰€æ“æœ‰æˆ–ç®¡ç†çš„æª”æ¡ˆã€‚</td>
</tr>
<tr>
<td><strong>Amcache_UnassociatedFileEntries.csv</strong></td>
<td>ç„¡é—œè¯çš„æª”æ¡ˆæ¢ç›®</td>
<td>æŒ‡é‚£äº›æ²’æœ‰è¢«é—œè¯åˆ°ä»»ä½•ç¨‹å¼æ¢ç›®çš„æª”æ¡ˆæ¢ç›®ï¼Œä¹Ÿå°±æ˜¯é‚£äº›å­¤ç«‹çš„å¯åŸ·è¡Œæª” &#x2F; æª”æ¡ˆã€‚é€™æ˜¯å¾ˆå¤šèª¿æŸ¥ä¸­é‡é»æŸ¥çœ‹çš„éƒ¨åˆ†ï¼Œå› ç‚ºå¯èƒ½æ˜¯æƒ¡æ„å·¥å…·æˆ–ç¨ç«‹åŸ·è¡Œæª”ã€‚</td>
</tr>
<tr>
<td><strong>Amcache_Shortcuts.csv</strong></td>
<td>å¿«æ·æ–¹å¼ &#x2F; é€£çµè³‡è¨Š</td>
<td>æè¿°ç³»çµ±æˆ–æ‡‰ç”¨ç¨‹å¼æ·å¾‘ï¼ˆ.lnk æˆ–é¡ä¼¼é€£çµï¼‰ç›¸é—œçš„è³‡è¨Šï¼Œä¾‹å¦‚å¿«æ·ç›®æ¨™ã€è·¯å¾‘ç­‰ã€‚</td>
</tr>
<tr>
<td><strong>Amcache_DeviceContainers.csv</strong></td>
<td>è£ç½®å®¹å™¨ (Device Container)</td>
<td>èˆ‡è£ç½®ï¼ˆä¾‹å¦‚ USB è£ç½®ã€ç¡¬é«”è£ç½®ï¼‰æˆ–å…¶å®¹å™¨æœ‰é—œçš„æ¢ç›®ã€‚</td>
</tr>
<tr>
<td><strong>Amcache_DevicePnps.csv</strong></td>
<td>è£ç½® PnP æ¢ç›® (Plug-and-Play è£ç½®)</td>
<td>æè¿°æ’æ‹”è£ç½® (PnP è£ç½®) çš„è³‡è¨Šï¼Œä¾‹å¦‚ç¡¬é«” IDã€è£ç½®åç¨±ã€ç›¸é—œæ™‚é–“ç­‰ã€‚</td>
</tr>
<tr>
<td><strong>Amcache_DriveBinaries.csv</strong></td>
<td>é©…å‹•ç¨‹å¼äºŒé€²ä½æª”</td>
<td>æ¶‰åŠé©…å‹•ç¨‹å¼ï¼ˆdriver binariesï¼‰æˆ–åœ¨ç£ç¢Ÿä¸Šå¯åŸ·è¡Œä½†å±¬é©…å‹•ç¨‹å¼ç¯„ç–‡çš„æ¢ç›®ã€‚</td>
</tr>
<tr>
<td><strong>Amcache_DriverPackages.csv</strong></td>
<td>é©…å‹•å¥—ä»¶ (Driver Packages)</td>
<td>é—œæ–¼é©…å‹•ç¨‹å¼å¥—ä»¶å®‰è£ã€é©…å‹•å¥—ä»¶ç‰ˆæœ¬ã€å°è£è³‡è¨Šç­‰ã€‚</td>
</tr>
</tbody></table>
<p>æ¥ä¸‹ä¾†å°±å¯ä»¥ç”¨ <a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">Timeline Explorer</a> æˆ–è€…å…¶ä»–å¯ä»¥æŸ¥çœ‹ CSV æª”çš„ç¨‹å¼æŸ¥çœ‹å…§å®¹</p>
<p><img src="/assets/mPcDCME75qRv_jdBbz7s7O_MXQtHhoV6h36PvLThoFc=.png"></p>
<p>å‡è¨­æƒ³è¦çŸ¥é“ notepad.exe çš„å¯¦éš›è·¯å¾‘ä»¥åŠå®ƒçš„ SHA-1 å€¼ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ­¥é©Ÿä¸¦åœ¨ <code>&lt;XXX_UnassociatedFileEntries.csv&gt;</code> æœå°‹ notepad.exe</p>
<p><img src="/assets/x-tZ0wFWbbmTkDMDwjC0KcLnXum2pc_9t6A4oT2z3Bg=.png"></p>
<p>å¯ä»¥é¦¬ä¸Šå°±çœ‹åˆ°ç›¸é—œè³‡è¨Š</p>
</li>
<li><p>PECmd</p>
<p>PECmd æ˜¯ç”± Eric Zimmerman é–‹ç™¼çš„ä¸€å€‹å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒçš„ç›®çš„æ˜¯è§£æ Windows çš„ Prefetch æª”æ¡ˆï¼ˆ.pfï¼‰ï¼ŒæŠ½å–å…¶ä¸­çš„ metadataï¼ˆå¦‚åŸ·è¡Œæ™‚é–“æˆ³ã€åŸ·è¡Œæ¬¡æ•¸ã€è¢«åƒç…§çš„æª”æ¡ˆæ¸…å–®ç­‰ï¼‰ï¼Œä»¥ä¾¿ç”¨æ–¼é‘‘è­˜åˆ†æ</p>
<p>æœ‰ä¸€å€‹å¾ˆæ–¹ä¾¿çš„åŠŸèƒ½æ˜¯å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤æ‰¹é‡è™•ç† Prefetch è£¡é¢çš„æ‰€æœ‰æª”æ¡ˆï¼Œä¸¦æŠŠå®ƒå€‘åˆæˆä¸€å€‹ CSV æª”</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">.\PECmd.exe -d C:\Users\yunshiuan\Desktop\The_Enduring_Echo\C\Windows\prefetch --csv &quot;C:\Users\yunshiuan\Desktop\output&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/YZQ4eHTHNW2nzsMq1S9CPq9H7CPp6_8kzmD9OzCkXTM=.png"></p>
<p>å¦‚æœæƒ³è¦å–®ç¨è½‰æ›æŸå€‹ .pf æª”çš„è©±å¯ä»¥ä½¿ç”¨ <code>-f</code> </p>
<p>æ¥ä¸‹ä¾†å°±æœƒåœ¨ output ä¸­å‡ºç¾è½‰æ›å¥½çš„ CSV æª”</p>
<p><img src="/assets/vN3s7s5Ir8f6bWh_K-OBrUFXzhTtEFEzoj7px-EMmh8=.png"></p>
<p>å¯ä»¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">Timeline Explorer</a> æˆ–è€…å…¶ä»–æŸ¥çœ‹ CSV æª”çš„è»Ÿé«”æŸ¥çœ‹</p>
<p><img src="/assets/IZtn-xPIIX5IwNcA-FIRxiwXk3Aqu-eJfzpZnmt-W-Q=.png"></p>
<p>å‡è¨­æˆ‘æƒ³è¦çŸ¥é“ cmd.exe åŸ·è¡Œäº†å¹¾æ¬¡ï¼Œç›´æ¥æŒ‰ç…§å‰›å‰›çš„æ­¥é©Ÿä¸¦æœå°‹ cmd.exeï¼Œç™¼ç¾å®ƒåŸ·è¡Œäº† 26 æ¬¡</p>
<p><img src="/assets/EWcRoavCJbqZQ7VouNsE-FHXlJrmgvL1A8hxDCCG750=.png"></p>
</li>
</ul>
<h3 id="Zone-Identifier"><a href="#Zone-Identifier" class="headerlink" title="Zone Identifier"></a>Zone Identifier</h3><p>ç•¶å¾ç€è¦½å™¨ï¼ˆå¦‚ Edgeã€Chromeã€IEï¼‰ä¸‹è¼‰æª”æ¡ˆæ™‚ï¼ŒWindows æœƒå»ºç«‹ä¸€å€‹ NTFS å€æ®µè³‡æ–™ï¼ˆADSï¼‰ ä¾†è¨˜éŒ„æª”æ¡ˆä¾†æºï¼Œä¾‹å¦‚ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">[ZoneTransfer]
ZoneId&#x3D;3
ReferrerUrl&#x3D;https:&#x2F;&#x2F;example.com
HostUrl&#x3D;https:&#x2F;&#x2F;example.com&#x2F;download&#x2F;file.exe<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>é€™é€šå¸¸å„²å­˜åœ¨ Zone.Identifier æµè£¡ã€‚</p>
<p>è¦æŸ¥çœ‹å¯ä»¥å¾FTK imager ä¸­é»æ“Šä¸‹è¼‰çš„æª”æ¡ˆçœ‹æœ‰æ²’æœ‰é™„åŠ çš„Zone.Identifier</p>
<h2 id="ç€è¦½å™¨ç´€éŒ„"><a href="#ç€è¦½å™¨ç´€éŒ„" class="headerlink" title="ç€è¦½å™¨ç´€éŒ„"></a>ç€è¦½å™¨ç´€éŒ„</h2><p>Windows ç³»çµ±ä¸­ï¼Œæ‡‰ç”¨ç¨‹å¼çš„ä½¿ç”¨è€…è³‡æ–™é€šå¸¸å„²å­˜åœ¨ <code>AppData</code> ç›®éŒ„ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">C:\Users\&lt;username&gt;\AppData\
â”œâ”€â”€ Local\
â”œâ”€â”€ Roaming\        
â””â”€â”€ LocalLow\       <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>Local : å„²å­˜å¤§å®¹é‡ï¼Œè‡¨æ™‚æˆ–æ˜“åˆªé™¤çš„è³‡æ–™</li>
<li>Roaming : è·¨è£ç½®åŒæ­¥è³‡æ–™ï¼Œæœƒè·Ÿè‘—ä½¿ç”¨è€…å¸³æˆ¶ç§»å‹•åˆ°å…¶ä»–é›»è…¦</li>
<li>LocalLowï¼šèˆ‡ Local é¡ä¼¼ï¼Œä½†æ˜¯æ‡‰ç”¨ç¨‹å¼è¢«æˆäºˆçš„æ¬Šé™è¼ƒä½</li>
</ul>
<p>ä»¥ä¸‹ä»‹ç´¹ä¸€äº›å¸¸ç”¨çš„ç€è¦½å™¨çš„è³‡æ–™å„²å­˜ä½ç½®ä»¥åŠå¯ä»¥åˆ†æçš„æª”æ¡ˆ</p>
<h3 id="Google-Chrome"><a href="#Google-Chrome" class="headerlink" title="Google Chrome"></a>Google Chrome</h3><p><strong>ä½ç½®ï¼š</strong> <code>C:\Users\&lt;user&gt;\AppData\Local\Google\Chrome\User Data\Default</code></p>
<pre class="line-numbers language-none"><code class="language-none">C:\Users\&lt;user&gt;\AppData\Local\Google\Chrome\User Data\Default\
â”œâ”€â”€ History               # ç€è¦½æ­·å²å’Œä¸‹è¼‰è¨˜éŒ„
â”œâ”€â”€ Network\Cookies       # Cookie è³‡æ–™
â”œâ”€â”€ Login Data            # å„²å­˜çš„å¯†ç¢¼
â”œâ”€â”€ Web Data              # è‡ªå‹•å¡«å…¥è³‡æ–™
â”œâ”€â”€ Bookmarks             # æ›¸ç±¤
â”œâ”€â”€ Preferences           # ä½¿ç”¨è€…åå¥½è¨­å®š
â”œâ”€â”€ Cache\                # å¿«å–è³‡æ–™
â”œâ”€â”€ Local Storage\        # æœ¬åœ°å„²å­˜
â”œâ”€â”€ Session Storage\      # æœƒè©±å„²å­˜
â””â”€â”€ IndexedDB\            # ç´¢å¼•è³‡æ–™åº«<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/t3wC0oXhNjW5IAY58wESdbEguCnaBPvkbUMzF7wKS0w=.png"></p>
<h3 id="Microsoft-Edge"><a href="#Microsoft-Edge" class="headerlink" title="Microsoft Edge"></a>Microsoft Edge</h3><p><strong>ä½ç½®ï¼š</strong> <code>C:\Users\&lt;user&gt;\AppData\Local\Microsoft\Edge\User Data\Default</code></p>
<pre class="line-numbers language-none"><code class="language-none">C:\Users\&lt;user&gt;\AppData\Local\Microsoft\Edge\User Data\Default\
â”œâ”€â”€ History               # ç€è¦½æ­·å²å’Œä¸‹è¼‰è¨˜éŒ„
â”œâ”€â”€ Cookies               # Cookie è³‡æ–™
â”œâ”€â”€ Login Data            # å„²å­˜çš„å¯†ç¢¼
â”œâ”€â”€ Web Data              # è‡ªå‹•å¡«å…¥è³‡æ–™
â”œâ”€â”€ Preferences           # ä½¿ç”¨è€…åå¥½è¨­å®š
â”œâ”€â”€ Cache\                # å¿«å–è³‡æ–™
â”œâ”€â”€ Local Storage\        # æœ¬åœ°å„²å­˜
â”œâ”€â”€ Session Storage\      # æœƒè©±å„²å­˜
â””â”€â”€ IndexedDB\            # ç´¢å¼•è³‡æ–™åº«<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/c8YUdhLtLG-xs03GspLLfxg5lXWwJaANvvFQ00ftp9E=.png"></p>
<h3 id="Mozilla-Firefox"><a href="#Mozilla-Firefox" class="headerlink" title="Mozilla Firefox"></a>Mozilla Firefox</h3><p><strong>ä½ç½®ï¼š</strong> <code>C:\Users\&lt;user&gt;\AppData\Roaming\Mozilla\Firefox\Profiles\&lt;profile&gt;</code></p>
<p><code>&lt;profile&gt;</code> å¸¸å¸¸æœƒä»¥xxxx.default-release è¡¨ç¤º</p>
<pre class="line-numbers language-none"><code class="language-none">C:\Users\&lt;user&gt;\AppData\Roaming\Mozilla\Firefox\Profiles\&lt;profile&gt;\
â”œâ”€â”€ places.sqlite        # ç€è¦½æ­·å²ã€æ›¸ç±¤ã€ä¸‹è¼‰è¨˜éŒ„
â”œâ”€â”€ cookies.sqlite       # Cookie è³‡æ–™
â”œâ”€â”€ logins.json          # å„²å­˜çš„å¯†ç¢¼
â”œâ”€â”€ formhistory.sqlite   # è¡¨å–®æ­·å²
â”œâ”€â”€ permissions.sqlite   # ç¶²ç«™æ¬Šé™
â”œâ”€â”€ prefs.js            # ä½¿ç”¨è€…åå¥½è¨­å®š
â”œâ”€â”€ user.js             # ä½¿ç”¨è€…è‡ªè¨‚è¨­å®š
â””â”€â”€ storage\            # æœ¬åœ°å„²å­˜<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/MH-kVAb81up_baCG59UVWSc7VpFwFHxrAKgKZVGoG5c=.png"></p>
<p>æœ‰äº›æª”æ¡ˆæœƒæ˜¯ SQLite å„²å­˜çš„ï¼Œé€™é‚Šæ¨è–¦ä¸€å€‹ GUI æ‡‰ç”¨ç¨‹å¼å¯ä»¥æŸ¥çœ‹ SQLite è³‡æ–™åº«å…§çš„å…§å®¹ï¼š<strong>DB Browser for SQLite</strong></p>
<h3 id="DB-Browser-for-SQLite"><a href="#DB-Browser-for-SQLite" class="headerlink" title="DB Browser for SQLite"></a>DB Browser for SQLite</h3><p>ä¸‹è¼‰é€£çµï¼š<a target="_blank" rel="noopener" href="https://sqlitebrowser.org/">https://sqlitebrowser.org/</a></p>
<p>DB Browser for SQLite æ˜¯ä¸€æ¬¾é–‹æºçš„ã€è·¨å¹³å°çš„è¦–è¦ºåŒ– SQLite è³‡æ–™åº«ç®¡ç†å·¥å…·ã€‚å®ƒè®“ä½¿ç”¨è€…ä¸ç”¨æ·±å…¥æŒ‡ä»¤åˆ—å°±èƒ½é–‹å•Ÿã€ç€è¦½ã€æŸ¥è©¢ã€ä¿®æ”¹ SQLite è³‡æ–™åº«æª”æ¡ˆã€‚å®ƒæ”¯æ´æ¨™æº–çš„ SQLite æª”æ¡ˆï¼ˆ.sqlite, .db, .sqlite3 ç­‰ï¼‰ï¼Œä¹Ÿæ”¯æ´åŒ¯å…¥ï¼åŒ¯å‡º CSVã€SQL dump ç­‰æ ¼å¼</p>
<p>å‡è¨­æˆ‘è¦æŸ¥çœ‹ä½¿ç”¨è€…åœ¨ Google Chrome çš„ç€è¦½èˆ‡ä¸‹è¼‰ç´€éŒ„</p>
<p>é¦–å…ˆå…ˆæŠŠ <code>C:\Users\&lt;user&gt;\AppData\Local\Google\Chrome\User Data\Default\History</code> dump ä¸‹ä¾†</p>
<p><img src="/assets/9FgyVU4gE0qZHD_cPbKAPnJZwqx-YWgxBiESlAA1ZAI=.png"></p>
<p>ç„¶å¾Œé–‹å•Ÿ DB Browser for SQLiteï¼Œå°‡å‰›å‰› dump ä¸‹ä¾†çš„ history è³‡æ–™ä¸Ÿé€² DB Browser for SQLite å…§</p>
<p><img src="/assets/jev_UQgFrTH7os7vKMbXlqQFHHDiJf7N7AUvGTDCoto=.png"></p>
<p>ä¸‹é¢å¯ä»¥çœ‹åˆ°è³‡æ–™åº«å…§çš„ Tableï¼Œå¦‚æœæƒ³è¦çœ‹è£¡é¢çš„è³‡æ–™å°±é»é¸ç€è¦½è³‡æ–™çš„é é¢</p>
<p><img src="/assets/E_xTSK3RQjQUtRC4oW8-bFfy_f8KdXiWu4GJ3viGkWs=.png"></p>
<p>å¦‚æœæ˜¯è¦çœ‹ç€è¦½è¨˜éŒ„å°±é¸æ“‡ <code>urls</code>ï¼Œå¦‚æœè¦çœ‹ä¸‹è¼‰ç´€éŒ„çš„è©±å°±çœ‹ <code>downloads</code> Table</p>
<p><img src="/assets/Wy19Ca-3LR-VWh2fqEcZKglEGOWIsqVcTY9cYyQt-8I=.png"></p>
<h2 id="Acquision"><a href="#Acquision" class="headerlink" title="Acquision"></a>Acquision</h2><ul>
<li>Dumpit.exe<ul>
<li>windows memory image</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/504ensicsLabs/LiME">LiME</a><ul>
<li>Linux memory image</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://www.magnetforensics.com/resources/encrypted-disk-detector/">EDD</a><ul>
<li>check disk wheather has been encrypted</li>
</ul>
</li>
<li>KAPE<ul>
<li>triage image</li>
</ul>
</li>
<li>CyLR<ul>
<li>inux triage image</li>
</ul>
</li>
</ul>
<p>if windwos memory dead Acquision</p>
<ul>
<li><p>hiberfil.sys C:&#x2F;</p>
</li>
<li><p>pagefile.sys C:&#x2F;</p>
</li>
</ul>
<hr>
<h2 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h2><h4 id="ALEAPP"><a href="#ALEAPP" class="headerlink" title="ALEAPP"></a>ALEAPP</h4><p>ä¸‹è¼‰é€£çµï¼š</p>
<p>ALEAPP : <a target="_blank" rel="noopener" href="https://github.com/abrignoni/ALEAPP"> https://github.com/abrignoni/ALEAPP</a></p>
<p>æ˜¯ç”± Alexis Brignoni é–‹ç™¼çš„ä¸€å€‹é–‹æºå·¥å…·ï¼Œç”¨ä¾†åš Android è£ç½®çš„ è­‰æ“šæª”æ¡ˆåˆ†æï¼ˆforensic artifacts parsingï¼‰ã€‚å…¶ç›®çš„åœ¨æ–¼æ•´ç† Android è£ç½®ä¸­å¸¸è¦‹çš„ logã€äº‹ä»¶ã€Protobufï¼ˆå¦‚ Google Play Services æˆ–å…¶ä»–ä½¿ç”¨ Protobuf çš„ appsï¼‰ç­‰è³‡æ–™ï¼Œå”åŠ©æ•¸ä½é‘‘è­˜èˆ‡ incident response èª¿æŸ¥äººå“¡å¿«é€Ÿå–å‡ºèˆ‡åˆ†ææœ‰ç”¨è³‡æ–™ã€‚</p>
<hr>
<p>ä»Šå¤©çš„Android çš„ dumpfiles æœƒä»¥ä»Šå¹´åˆå‰›çµæŸçš„ MVS CTF 2025 ä¸­çš„Android åˆ†é¡ä¾†åˆ†äº«</p>
<p>ä¸‹è¼‰é€£çµ ï¼š <a target="_blank" rel="noopener" href="https://drive.google.com/file/d/1Ay-T4kE8J3NX-XLh0krarFvE9j8SK_LT/view">https://drive.google.com/file/d/1Ay-T4kE8J3NX-XLh0krarFvE9j8SK_LT/view</a></p>
<p>é€™å€‹é€£çµä¸‹è¼‰æœƒçµ¦ä¸€å€‹Android æ‰‹æ©Ÿçš„ data è³‡æ–™å¤¾å…§å®¹ï¼Œä¸¦ä¸”æ˜¯å£“ç¸®éå¾Œçš„ã€‚</p>
<p>é€™é‚Šå¯ä»¥åˆ†äº«ä¸€ä¸‹åœ¨Android 11 å¾Œï¼Œæ²’æœ‰ root çš„æ¬Šé™æ˜¯æ²’æœ‰è¾¦æ³•å»å­˜å–åˆ° data è³‡æ–™å¤¾çš„ï¼Œå› æ­¤æœƒéœ€è¦ä¸€äº›ç¬¬ä¸‰æ–¹çš„å·¥å…·æ‰å¯ä»¥æŠŠå®ƒ dump ä¸‹ä¾†ã€‚</p>
<p>æˆ‘çš„çŒœæ¸¬ï¼Œé€™å€‹ dump çš„è£½ä½œæ˜¯ä½¿ç”¨ä¸€å€‹<a target="_blank" rel="noopener" href="https://github.com/topjohnwu/Magisk">Magisk</a> å·¥å…·å®‰è£åˆ°è£ç½®ä¸Šï¼Œé€™å€‹å·¥å…·å¯ä»¥è®“ä½ ç²å¾—åˆ° root æ¬Šé™ä¸¦ç„¡éœ€ä¿®æ”¹ç³»çµ±åˆ†å€ï¼Œ<a target="_blank" rel="noopener" href="https://izaka.tw/magisk-tutorial-and-installation-guide/">åƒè€ƒé€£çµ</a></p>
<p>ALEAPP åªæ”¯æ´ tar&#x2F;zip&#x2F;gz æª”æ¡ˆï¼Œå› æ­¤æˆ‘æ˜¯å…ˆå¾é€£çµä¸Šä¸‹è¼‰å¾Œè§£å£“å†é‡æ–°å£“ç¸®æˆ zip ä¸€æ¬¡</p>
<p>å¾—åˆ°æª”æ¡ˆä¹‹å¾Œå°±å¯ä»¥ä¸Ÿçµ¦ ALEAPPï¼Œä¸Šé¢æ˜¯å¡«é¡Œç›®çµ¦çš„æª”æ¡ˆï¼Œä¸‹é¢æ˜¯é¸å®ƒç”¢ç”Ÿçš„åˆ†æçµæœè¦è¼¸å‡ºåˆ°å“ªè£¡çš„è³‡æ–™å¤¾</p>
<p>ä¸‹é¢çš„ Module å¯ä»¥å…¨é¸</p>
<p><img src="/assets/mDASlDFj6hHZvVJoPZZZ210DAqwMwVXbJ-mrViOr-w4=.png"></p>
<p>æ¥ä¸‹ä¾†æŒ‰å·¦ä¸‹è§’çš„ Process å®ƒå°±æœƒé–‹å§‹åšåˆ†æï¼Œåˆ†æå®Œä¹‹å¾Œå®ƒæœƒåœ¨ä½ è·Ÿå‰›å‰›å¡«çš„è·¯å¾‘ä¸‹æ–°å¢ä¸€å€‹è³‡æ–™å¤¾</p>
<p><img src="/assets/lDtakJToWuHInXS9qc6ldb-xieSy0NSlWyeQBwburCs=.png"></p>
<p>é€™äº›å°±æ˜¯å®ƒå°‡åˆ†æçš„çµæœè½‰æˆ HTMLï¼Œé¡ä¼¼ç”Ÿæˆä¸€å€‹å ±å‘Šï¼Œä¸»è¦çš„é é¢æœƒåœ¨ <code>index.html</code>ï¼Œé»é–‹ä¹‹å¾Œæœƒé€²å…¥åˆ°é€™å€‹é é¢</p>
<p><img src="/assets/IvCPZq8bj5obL1jWJ0mLYUYg_gNCe6EhCRZm-CpzJGE=.png"></p>
<p>ä¹‹å¾Œå°±å¯ä»¥é–‹å§‹å»ç¿»æœ‰æ²’æœ‰ä»€éº¼å¯ç–‘çš„æ±è¥¿</p>
<p>å…¶ä¸­çš„åŠŸèƒ½å¾ˆå¤šï¼Œé€™é‚Šä»‹ç´¹å…¶ä¸­ä¸€éƒ¨åˆ†çš„å…§å®¹</p>
<h3 id="Home-page"><a href="#Home-page" class="headerlink" title="Home page"></a>Home page</h3><p>é¦–é å°±æœƒé¡¯ç¤ºä¸€äº›æ‰‹æ©Ÿçš„åç¨±ã€SIMå¡è³‡è¨Šç­‰ç­‰</p>
<p><img src="/assets/Z2AoWqFIXBkawKwp5jiAnGuJy122aa8Tyd-SZjcOsOc=.png"></p>
<h2 id="APP"><a href="#APP" class="headerlink" title="APP"></a>APP</h2><h3 id="APP-Icons"><a href="#APP-Icons" class="headerlink" title="APP Icons"></a>APP Icons</h3><p>é€™é‚Šå¯ä»¥æŸ¥çœ‹ä½¿ç”¨è€…åœ¨è£ç½®ä¸Šå®‰è£äº†ä»€éº¼app</p>
<p><img src="/assets/5hibQen43Jn1ThRdY0x2r67KBkQ_yTAxbqaeRzwTUNA=.png"></p>
<h3 id="Packages"><a href="#Packages" class="headerlink" title="Packages"></a>Packages</h3><p>å®ƒæœƒè§£æ <code>packages.xml</code>ï¼Œè¨˜éŒ„äº†è£ç½®ä¸Šå®‰è£éçš„æ‰€æœ‰å¥—ä»¶ï¼ˆæ‡‰ç”¨ç¨‹å¼ï¼‰ï¼ŒåŒ…å«ï¼š</p>
<p>â€¢	ç³»çµ±æ‡‰ç”¨ï¼ˆéš¨ ROM å‡ºå» ï¼‰</p>
<p>â€¢	OEM å» å•†é™„åŠ æ‡‰ç”¨</p>
<p>â€¢	ä½¿ç”¨è€…è‡ªè¡Œå®‰è£çš„æ‡‰ç”¨ï¼ˆä¾‹å¦‚å¾ Google Play Storeã€adb sideload ç­‰ï¼‰</p>
<p><img src="/assets/lE9NediFoYvRMhSRjJrXjxl-wX8-nBMapXtwwlAYmJM=.png"></p>
<h3 id="Bluetooth"><a href="#Bluetooth" class="headerlink" title="Bluetooth"></a>Bluetooth</h3><h4 id="Bluetooth-Adapter-Information"><a href="#Bluetooth-Adapter-Information" class="headerlink" title="Bluetooth Adapter Information"></a>Bluetooth Adapter Information</h4><p>é€™é‚Šå¯ä»¥çœ‹åˆ°è—ç‰™çš„ä¸€äº›è¨­å®š</p>
<p><img src="/assets/Jl_I6EruZUlSFYviq3RPTFNfNMnoUY4vPQckU9-sKpc=.png"></p>
<h4 id="Bluetooth-Connections"><a href="#Bluetooth-Connections" class="headerlink" title="Bluetooth Connections"></a>Bluetooth Connections</h4><p>é€™é‚Šå¯ä»¥çœ‹è—ç‰™è£ç½®é€£ç·šç´€éŒ„</p>
<p><img src="/assets/tTj3bI9f-yMf1GKbRGqfxsjClNGrxo9di4EThFU7qTw=.png"></p>
<hr>
<h2 id="IOS"><a href="#IOS" class="headerlink" title="IOS"></a>IOS</h2><h3 id="ILEAPP"><a href="#ILEAPP" class="headerlink" title="ILEAPP"></a>ILEAPP</h3><p>ä¸‹è¼‰é€£çµï¼š <a target="_blank" rel="noopener" href="https://github.com/abrignoni/iLEAPP">https://github.com/abrignoni/iLEAPP</a></p>
<p>iLEAPP æ˜¯ Alexis Brignoni é–‹ç™¼çš„é–‹æºå·¥å…·ï¼Œç”¨ä¾†è§£æ iOS è£ç½®ï¼ˆèˆ‡å‚™ä»½ï¼‰ä¸­çš„æ—¥èªŒã€äº‹ä»¶èˆ‡ plist ç­‰å¸¸è¦‹é‘‘è­˜ artefactsï¼Œå”åŠ©å¿«é€Ÿæ•´ç†å‡ºå¯ä¾›é‘‘è­˜èˆ‡èª¿æŸ¥çš„è³‡è¨Šã€‚æ­¤å·¥å…·å¯ä»¥å¿«é€Ÿ triage iOS æ¬„ä½ï¼šä¾‹å¦‚ç³»çµ±èˆ‡æ‡‰ç”¨ logsã€é€šçŸ¥ï¼ˆnotificationsï¼‰ã€build &#x2F; è¨­å‚™è³‡è¨Šã€è¡Œå‹•ç¶²è·¯è³‡æ–™ã€æ‡‰ç”¨ç‹€æ…‹è³‡æ–™åº«ï¼ˆApplicationState.dbï¼‰ç­‰ï¼Œå°‡åŸå§‹æª”æ¡ˆè½‰æˆå¯è®€çš„è¡¨æ ¼&#x2F;HTML å ±å‘Šæˆ– timelineï¼Œä¾¿æ–¼èª¿æŸ¥äººå“¡é–±è®€èˆ‡åˆ†æ</p>
<hr>
<p>ä»Šå¤©çš„IOS çš„ dumpfiles æª”æœƒä»¥ä»Šå¹´åˆå‰›çµæŸçš„ MVS CTF 2025 æª”ä¸­çš„ IOS åˆ†é¡ä¾†åˆ†äº«</p>
<p>æª”æ¡ˆä¸‹è¼‰ç¶²å€ï¼š<a target="_blank" rel="noopener" href="https://drive.google.com/drive/folders/1yaMc--Va2u2IJzQKci4yBaeftjDGRDya">https://drive.google.com/drive/folders/1yaMc--Va2u2IJzQKci4yBaeftjDGRDya</a></p>
<p>ç¶²å€ä¸‹è¼‰ä¸‹ä¾†å¾Œæ‡‰è©²æœƒæ˜¯iOS ç³»çµ±çš„Applicationsã€privateã€System è³‡æ–™å¤¾çš„å£“ç¸®æª”</p>
<p>å°‡ä¸‹è¼‰çš„æª”æ¡ˆä¸Ÿçµ¦iLEAPPï¼Œä¸Šé¢æ˜¯å¡«é¡Œç›®çµ¦çš„æª”æ¡ˆï¼Œä¸‹é¢æ˜¯é¸ä»–ç”¢ç”Ÿçš„åˆ†æçµæœè¦è¼¸å‡ºåˆ°å“ªè£¡çš„è³‡æ–™å¤¾</p>
<p>ä¸‹é¢çš„Moduleå¯ä»¥å…¨é¸</p>
<p><img src="/assets/pN_MLRInXD93sGXMtwoxxnvG6LiVZAyfxuDtWOxSxF4=.png"></p>
<p>æ¥ä¸‹ä¾†æŒ‰å·¦ä¸‹è§’çš„ Process ç¨‹å¼å°±æœƒé–‹å§‹åˆ†æ</p>
<p>çµæŸä¹‹å¾Œæœƒç”¢ç”Ÿåˆ†æçš„çµæœä¸¦ç”¢ç”Ÿhtmlï¼Œ</p>
<p><img src="/assets/OzFeLiwH1qYq5CZbvm7R8tR14Pxz_wcfw2JjuQ82SY0=.png"></p>
<p>å ±å‘Šçš„ä¸»é æœƒç”¢ç”Ÿåœ¨_HTML åº•ä¸‹çš„ <code>index.html</code> æ‰“é–‹ä¹‹å¾Œæœƒå‡ºç¾é€™æ¨£çš„é é¢</p>
<p><img src="/assets/9oHLDoZAR8rpHPWI5a65Wj2LDRsWts9dnS1ABtfelbM=.png"></p>
<p>ä¹‹å¾Œå°±å¯ä»¥åœ¨å·¦å´çš„åŠŸèƒ½åˆ—ç¿»æƒ³è¦å°‹æ‰¾çš„æ±è¥¿ã€‚</p>
<p>é€™é‚Šä»‹ç´¹å¹¾å€‹æˆ‘è¦ºå¾—æ¯”è¼ƒç‰¹åˆ¥çš„åˆ†æçµæœ</p>
<h2 id="Home-Page"><a href="#Home-Page" class="headerlink" title="Home Page"></a>Home Page</h2><p>åœ¨é¦–é çš„Device details ä¸­æœ‰é¡¯ç¤ºè£ç½®åŸºæœ¬è³‡è¨Šï¼ˆå‹è™Ÿã€åºè™Ÿã€iOS ç‰ˆæœ¬ï¼‰</p>
<p><img src="/assets/fXGB2uwjc5BZY9TvJLQPPKzqzsdhCceqbkQM1yNVhBw=.png"></p>
<h3 id="Keyboard-Usage-Stats"><a href="#Keyboard-Usage-Stats" class="headerlink" title="Keyboard Usage Stats"></a>Keyboard Usage Stats</h3><p>é€™é‚Šæœƒé¡¯ç¤º</p>
<ul>
<li><code>tium.totalWordsTyped</code> â†’ ä½¿ç”¨è€…ç¸½å…±è¼¸å…¥çš„å­—æ•¸</li>
<li><code>tium.totalWordsFromCandidateBar</code> â†’ å¾éµç›¤å€™é¸åˆ—é¸å­—çš„æ¬¡æ•¸</li>
<li><code>tium.totalWordsAutocorrected</code> â†’ è‡ªå‹•æ›´æ­£çš„å­—æ•¸</li>
</ul>
<p><img src="/assets/nMTSMholF589UNss0wwNX1RI3f9GH22jovCeBZGWRZ0=.png"></p>
<h2 id="Itunes-Metadata"><a href="#Itunes-Metadata" class="headerlink" title="Itunes Metadata"></a>Itunes Metadata</h2><p>&#x20;Itunes Metadata é€™é‚Šæœƒåˆ—å‡ºä¸€äº›è£ç½®ä¸Šå®‰è£çš„APP </p>
<p><img src="/assets/mT5LK33BqV_BBiDqV8WyiXbqmUKXcCQe4lEyVllEug4=.png"></p>
<hr>
<h2 id="Email-Security"><a href="#Email-Security" class="headerlink" title="Email Security"></a>Email Security</h2><p>ä¸€å€‹ Email å¸³è™Ÿçš„çµ„æˆï¼Œæœƒç”±ä¸€å€‹å°è€é¼ <code>@</code> å°‡å·¦å³éš”é–‹</p>
<ul>
<li>å·¦åŠéƒ¨åˆ†æ˜¯ä¾ç…§ä½¿ç”¨è€…è¨­å®šçš„å­—ä¸²ï¼Œå› æ­¤å¯ä»¥å–åç‚º<code>aaaabbbccc123</code> ã€ <code>admin</code> ã€<code>me</code> çš†å¯</li>
<li>å³åŠéƒ¨åˆ†æ˜¯çµ„ç¹”çš„ Domain Nameï¼Œåƒæ˜¯å¸¸è¦‹çš„ <code>gmail.com</code>ï¼›å¦‚æœè‡ªå·±æœ‰æ¶è¨­ Email Serverï¼Œå°±æœƒæ˜¯è‡ªå·±çš„ domainï¼Œå¦‚ï¼š<code>yunshiuan.com</code></li>
</ul>
<p><img src="/assets/RrromGCNVsSXy7dWVTw1aLyjocOQzZtGr4ggahqd7Fs=.png"></p>
<p><code>source: https://flickr.com/photos/jameschen1/24160994516/</code></p>
<p>åˆ°é€™é‚Šå°±æœƒæœ‰ä¸€å€‹å½é€ æ­£å¸¸ä¿¡ä»¶çš„æ–¹å¼ï¼šå¦‚æœæ”»æ“Šè€…è¨»å†Šäº†ä¸€å€‹èˆ‡æ­£å¸¸çµ„ç¹”å¹¾ä¹ç›¸åŒã€åªå·®ä¸€å€‹å­—çš„ domainï¼Œç”šè‡³ç›´æ¥å†’ç”¨æ­£å¸¸çµ„ç¹”çš„ Domain Name ä¾†æ¬ºé¨™ä½¿ç”¨è€…ï¼Œåªè¦ä½¿ç”¨è€…ä¸€å€‹ä¸æ³¨æ„å°±å¯èƒ½æŠŠå®ƒç•¶æˆæ­£å¸¸ä¿¡ä»¶è€Œè¢«é‡£åˆ°ï¼Œé€™å€‹æ”»æ“Šè¢«ç¨±ç‚º <strong>Email Spoofing</strong></p>
<h3 id="Email-Spoofing"><a href="#Email-Spoofing" class="headerlink" title="Email Spoofing"></a>Email Spoofing</h3><p>æ”»æ“Šè€…æœƒè©¦åœ–ä½¿ç”¨èˆ‡å¸¸è¦‹çµ„ç¹”ç›¸ä¼¼æˆ–ç›¸åŒçš„ email æ¬ºé¨™ä½¿ç”¨è€…èªç‚ºæ˜¯æ­£å¸¸éƒµä»¶ã€‚</p>
<p>ex : å¯ä»¥é€é <a target="_blank" rel="noopener" href="https://emkei.cz/">é€™å€‹ç¶²é </a>  å½é€  Email å‚³çµ¦ä½¿ç”¨è€…ï¼Œé€™é‚Šå°‡ Email å½é€ æˆ<code>support@paypal.com</code> ä¸¦å‚³ä¸€å°å¸³è™Ÿç•°å¸¸çš„ä¿¡çµ¦ä½¿ç”¨è€…</p>
<p><img src="/assets/PiPU_SyMgnQoKCb7bRDCvsyttMnbLm9Dt8RXKp7TKBk=.png"></p>
<p>é‚£é€™æ¨£åªå–®çœ‹ Email æ˜¯å¾ˆé›£åˆ†è¾¨æ˜¯å¦ç‚ºé‡£é­šä¿¡ä»¶ï¼Œæ‰€ä»¥æœƒé€ééƒµä»¶é©—è­‰å”å®š <strong>DMARC</strong> ä¾†åµæ¸¬éƒµä»¶å½é€ æ”»æ“Šã€‚</p>
<h3 id="DMARC"><a href="#DMARC" class="headerlink" title="DMARC"></a>DMARC</h3><p>DMARC æ˜¯ä¸€ç¨®éƒµä»¶é©—è­‰å”å®šï¼Œå®ƒè®“éƒµä»¶ç¶²åŸŸæ“æœ‰è€…èƒ½è²æ˜ç•¶æ”¶åˆ°æœªé€šéé©—è­‰çš„éƒµä»¶æ™‚è©²å¦‚ä½•è™•ç†ã€‚</p>
<p>æˆ‘åœ¨ demo æ™‚å¯„åˆ°æˆ‘å€‹äººçš„ä¿¡ç®±ï¼Œä½¿ç”¨ Cloudflare çš„ Email Routing åŠŸèƒ½è½‰ç™¼éƒµä»¶ï¼›å› æ­¤ç•¶æˆ‘æŠŠé‡£é­šä¿¡å¯„åˆ°è‡ªå·±çš„ä¿¡ç®±æ™‚ï¼Œå› æœªé€šé DMARC é©—è­‰è€Œè¢«æ‹’æ”¶ã€‚</p>
<p><img src="/assets/aeeOF3FAMAlT_FXaTinD9zx6HRYzvPoellic9cvMBvM=.png"></p>
<p>å¦‚æœDMARC é©—è­‰é€šéçš„è©±æœƒåƒä¸‹æ–¹åœ–ç¤ºçš„ä¸€æ¨£ã€‚</p>
<p><img src="/assets/cOeVnUSdeBGztRM6cfg0XEqzFCD75DgvYr24PX0TF7g=.png"></p>
<p>å¯ä»¥çœ‹åˆ°ä¸»è¦çš„é©—è­‰æ–¹å¼æœƒä½¿ç”¨åˆ° SPF ä»¥åŠ DKIMã€‚</p>
<h3 id="SPF"><a href="#SPF" class="headerlink" title="SPF"></a>SPF</h3><p>SPF æ˜¯ä¸€ç¨®é›»å­éƒµä»¶é©—è­‰å”å®šï¼Œå®ƒè®“ç¶²åŸŸæ“æœ‰è€…èƒ½å¤ æŒ‡å®šå“ªäº›éƒµä»¶ä¼ºæœå™¨æœ‰æ¬Šä»£è¡¨è©²ç¶²åŸŸå¯„é€éƒµä»¶ã€‚é€™ä»½ã€Œæˆæ¬Šæ¸…å–®ã€æœƒä»¥ DNS TXT è¨˜éŒ„ çš„å½¢å¼å…¬é–‹ç™¼å¸ƒï¼Œæ¥æ”¶æ–¹çš„éƒµä»¶ä¼ºæœå™¨å‰‡å¯åœ¨æ”¶ä¿¡æ™‚æª¢æŸ¥å¯„ä»¶ä¼ºæœå™¨æ˜¯å¦è¢«æˆæ¬Šï¼Œä»¥åˆ¤æ–·éƒµä»¶æ˜¯å¦å¯ä¿¡ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ <code>dig</code> æŒ‡ä»¤æŸ¥çœ‹ SPF</p>
<pre class="line-numbers language-BASH" data-language="BASH"><code class="language-BASH">$ dig yunshiuan.com  TXT | grep spf
yunshiuan.com.		377	IN	TXT	&quot;v&#x3D;spf1 include:_spf.mx.cloudflare.net ~all&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>v&#x3D;spf1ï¼šæŒ‡å®š SPF å”å®šç‰ˆæœ¬</li>
<li>include:_spf.mx.cloudflare.netï¼šæˆæ¬Šæ¸…å–®ç”± Cloudflare ç¶­è­·</li>
<li>~allï¼šéæˆæ¬Šä¾†æºæ¨™è¨˜ç‚º SoftFailï¼ˆå¯ç–‘ï¼‰<br>ï¼ˆè‹¥è¨­å®š -all å‰‡ä»£è¡¨ Failï¼Œéæˆæ¬Šä¾†æºæ‡‰è¢«æ‹’çµ•ï¼‰</li>
</ul>
<h3 id="DKIM"><a href="#DKIM" class="headerlink" title="DKIM"></a>DKIM</h3><p>DKIM æ˜¯é›»å­éƒµä»¶é©—è­‰æ©Ÿåˆ¶ä¹‹ä¸€ï¼Œè®“æ”¶ä»¶æ–¹å¯ä»¥é©—è­‰ä¸€å°éƒµä»¶æ˜¯å¦çœŸæ­£ç”±è©²ç¶²åŸŸæˆæ¬Šå¯„å‡ºï¼Œä¸¦ç¢ºèªéƒµä»¶åœ¨å‚³é€éç¨‹ä¸­æ˜¯å¦è¢«ç¯¡æ”¹ï¼›å®ƒé€éæ•¸ä½ç°½ç« æ©Ÿåˆ¶å¯¦ç¾ã€‚å¯„ä»¶æ–¹ä½¿ç”¨ç§é‘°å°éƒµä»¶å…§å®¹é€²è¡Œç°½åï¼Œæ”¶ä»¶æ–¹å‰‡å¾ DNS æŸ¥å‡ºå°æ‡‰çš„å…¬é‘°ä¾†é©—è­‰ã€‚</p>
<p>DKIM çš„å…¬é‘°æœƒè¢«ç™¼å¸ƒåœ¨ DNS TXT ç´€éŒ„ä¸­ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;selector&gt;._domainkey.&lt;domain&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä»¥ Cloudflare èˆ‰ä¾‹ï¼Œå®ƒçš„ selector æ˜¯ <code>cf2024-1</code>ï¼ŒæŸ¥è©¢ DKIM ä¹Ÿå¯ä½¿ç”¨ <code>dig</code> æŒ‡ä»¤</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ dig cf2024-1._domainkey.yunshiuan.com TXT | grep DKIM
cf2024-1._domainkey.yunshiuan.com. 377 IN TXT	&quot;v&#x3D;DKIM1; h&#x3D;sha256; k&#x3D;rsa; p&#x3D;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAiweykoi+o48IOGuP7GR3X0MOExCUDY&#x2F;BCRHoWBnh3rChl7WhdyCxW3jgq1daEjPPqoi7sJvdg5hEQVsgVRQP4DcnQDVjGMbASQtrY4WmB1VebF+RPJB2ECPsEDTpeiI5ZyUAwJaVX7r6bznU67g7LvFq35yIo4sdlmtZGV+i0H4cpYH9+3JJ78k&quot; &quot;m4KXwaf9xUJCWF6nxeD+qG6Fyruw1Qlbds2r85U9dkNDVAS3gioCvELryh1TxKGiVTkg4wqHTyHfWsp7KD3WQHYJn0RyfJJu6YEmL77zonn7p2SRMvTMP3ZEXibnC9gz3nnhR6wcYL8Q7zXypKTMD58bTixDSJwIDAQAB&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ç¸½çµä¾†èªª DMARC é©—è­‰æµç¨‹æœƒæ˜¯ï¼šæ¥æ”¶æ–¹æ”¶åˆ°éƒµä»¶å¾Œï¼Œå…ˆæª¢æŸ¥ SPF å’Œ DKIM èªè­‰ï¼Œå†æ ¹æ“š DMARC æ”¿ç­–æ±ºå®šéƒµä»¶çš„è™•ç†æ–¹å¼ï¼ˆæ”¾è¡Œã€éš”é›¢æˆ–æ‹’çµ•ï¼‰ã€‚</p>
<p>DMARC è¨˜éŒ„å¯ä»¥åœ¨ <code>_dmarc.&lt;domain&gt;</code> æ‰¾åˆ°</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ dig _dmarc.any.run TXT                                                                             


; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; _dmarc.any.run TXT
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 31385
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4095
;; QUESTION SECTION:
;_dmarc.any.run.			IN	TXT

;; ANSWER SECTION:
_dmarc.any.run.		377	IN	TXT	&quot;v&#x3D;DMARC1; p&#x3D;quarantine; sp&#x3D;quarantine;&quot;

;; Query time: 226 msec
;; SERVER: 100.100.100.100#53(100.100.100.100)
;; WHEN: Thu Oct 09 20:09:24 CST 2025
;; MSG SIZE  rcvd: 94<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>v&#x3D;DMARC1 : DMARC ç‰ˆæœ¬</li>
<li>p&#x3D;quarantine : ä¸»è¦æ”¿ç­–ï¼Œå°ä¸»åŸŸåèªè­‰å¤±æ•—çš„éƒµä»¶é€²è¡Œéš”é›¢</li>
<li>sp&#x3D;quarantine : å­åŸŸåæ”¿ç­–ï¼Œå°å­åŸŸåèªè­‰å¤±æ•—çš„éƒµä»¶ä¹Ÿé€²è¡Œéš”é›¢</li>
</ul>
<h3 id="Gophish"><a href="#Gophish" class="headerlink" title="Gophish"></a>Gophish</h3><p>ä¸‹è¼‰é€£çµï¼š<a target="_blank" rel="noopener" href="https://github.com/gophish/gophish/releases">https://github.com/gophish/gophish/releases</a></p>
<p>Gophish æ˜¯ä¸€å€‹é–‹æºçš„é‡£é­šæ¨¡æ“¬å¹³å°ï¼Œç”¨æ–¼é€²è¡Œç¤¾äº¤å·¥ç¨‹æ¼”ç·´ï¼Œå¯ä»¥å¿«é€Ÿå»ºç«‹å’Œç™¼é€é‡£é­šéƒµä»¶ï¼Œè¿½è¹¤é»æ“Šç‡å’Œæäº¤ç‡ï¼Œå¹«åŠ©çµ„ç¹”æ¸¬è©¦å“¡å·¥çš„è³‡å®‰æ„è­˜ä¸¦æä¾›æ•™è‚²è¨“ç·´ã€‚</p>
<p><code>source : https://ui-code.com/archives/779</code></p>
<p>å®‰è£å¾ˆç°¡å–®ï¼Œå°‡ ZIP ä¸‹è¼‰ä¹‹å¾ŒåŸ·è¡Œè£¡é¢çš„åŸ·è¡Œæª”å°±èƒ½æ¶èµ·</p>
<p><img src="/assets/9yIIcEGIjBtwp2TUs8hEn1hT_Il_Buo1FbIYSVM9nP0=.png"></p>
<p>å¦‚æœè¦é ç«¯ä¹Ÿå¯ä»¥ç™»å…¥admin ä»‹é¢ï¼Œè¦å»config.json å°‡admin ç¶²å€æ”¹æˆ<code>0.0.0.0:3333</code></p>
<p>è‹¥è¦é ç«¯ä¹Ÿèƒ½ç™»å…¥ Admin ä»‹é¢ï¼Œè«‹åœ¨ config.json å°‡ Admin ä½å€æ”¹æˆ <code>0.0.0.0:3333</code></p>
<p>æ¶èµ·ä¾†å¾Œæœƒçµ¦ä½ å¸³è™Ÿå¯†ç¢¼ï¼Œç¶²é é€²å…¥<code>0.0.0.0:3333</code>å¾Œç™»å…¥å°±å¯ä»¥é–‹å§‹ä½¿ç”¨äº†</p>
<p><img src="/assets/gI4Up0C79FNgdPy_IY4j4hZSu3scYdFss05qVW5NJb8=.png"></p>
<p>è£¡é¢çš„åŠŸèƒ½éå¸¸è±å¯Œï¼ŒåŒ…æ‹¬</p>
<ul>
<li><strong>æ´»å‹•ç®¡ç†</strong>: å»ºç«‹&#x2F;æ’ç¨‹é‡£é­šæ´»å‹•ï¼ŒæŒ‡å®šç›®æ¨™ç¾¤çµ„ã€éƒµä»¶æ¨¡æ¿ã€ç™»å…¥é èˆ‡å¯„ä»¶è¨­å®šï¼Œä¸¦å³æ™‚ç›£æ§çµæœã€‚</li>
<li><strong>ç›®æ¨™ç¾¤çµ„</strong>: ç®¡ç†æ”¶ä»¶äººæ¸…å–®ï¼Œæ”¯æ´æ‰‹å‹•æ–°å¢èˆ‡ CSV åŒ¯å…¥ã€‚</li>
<li><strong>éƒµä»¶æ¨¡æ¿</strong>: è¦–è¦ºåŒ–ç·¨è¼¯èˆ‡è®Šæ•¸æ’å…¥ï¼ˆå¦‚ &#123;&#123;.FirstName&#125;&#125;ï¼‰ï¼Œå¯é è¦½èˆ‡æ¸¬è©¦å¯„é€ã€‚</li>
<li><strong>ç™»å…¥é </strong>: åŒ¯å…¥&#x2F;å®¢è£½ HTMLï¼Œé¸æ“‡æ˜¯å¦æ“·å–æäº¤è³‡æ–™ï¼Œæ”¯æ´é»æ“Šå¾Œ&#x2F;æäº¤å¾Œå°å‘ã€‚</li>
<li><strong>å¯„ä»¶è¨­å®š</strong>: è¨­å®š SMTPï¼ˆä¸»æ©Ÿã€å¸³å¯†ã€TLS&#x2F;SSLã€è‡ªè¨‚å¯„ä»¶è€…&#x2F;æ¨™é ­ï¼‰ï¼Œæ”¯æ´æ¸¬è©¦é€£ç·šã€‚</li>
<li><strong>å³æ™‚è¿½è¹¤</strong>: è¨˜éŒ„å¯„é€ã€é–‹å•Ÿã€é»æ“Šã€æäº¤è³‡æ–™ï¼ˆå« IPã€User-Agentï¼‰ï¼›å¯é¸ã€Œå›å ±ã€äº‹ä»¶ã€‚</li>
<li><strong>å„€è¡¨æ¿èˆ‡å ±è¡¨</strong>: æ´»å‹•æ¦‚æ³ã€æˆæ•ˆè¶¨å‹¢ï¼Œçµæœæ”¯æ´ CSV åŒ¯å‡ºã€‚</li>
<li><strong>REST API</strong>: æä¾›å®Œæ•´ API ä»¥è‡ªå‹•åŒ–å»ºç«‹æ´»å‹•ã€ä¸Šå‚³æ¨¡æ¿&#x2F;åå–®ã€æ“·å–çµæœã€‚</li>
<li><strong>ç¶²åŸŸèˆ‡è­‰æ›¸</strong>: è‡ªè¨‚è¿½è¹¤&#x2F;å¯„é€ç¶²åŸŸèˆ‡ TLS æ†‘è­‰é…ç½®ï¼Œæå‡å¯ä¿¡åº¦èˆ‡é”æŠ•éç‡ã€‚</li>
</ul>
<p><img src="/assets/2xWCIDOeOd16WAYIllSS5iysk0uLCS1ibgVpO_vFsy4=.png"></p>
<p><code>source : https://ui-code.com/archives/779</code></p>
<hr>
<h2 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h2><h3 id="WaybackMachine"><a href="#WaybackMachine" class="headerlink" title="WaybackMachine"></a>WaybackMachine</h3><p>ç¶²ç«™é€£çµï¼š<a target="_blank" rel="noopener" href="http://web.archive.org/">http://web.archive.org/</a></p>
<p>é€™å€‹ç¶²ç«™æ˜¯ç”± Internet Archive ç¶­è­·çš„ä¸€å€‹ç·šä¸Šæœå‹™ã€‚å®ƒå¯ä»¥å®šæœŸå°‡ç¶²ç«™çš„ç¶²é å…§å®¹ snapshot å­˜æª”ï¼Œè®“äººå€‘èƒ½å¤ æŸ¥çœ‹æŸå€‹ç¶²ç«™åœ¨éå»ä¸åŒæ™‚é–“é»çš„æ¨£å­</p>
<p>ä¾‹å¦‚æˆ‘æƒ³è¦çœ‹ä¸€ä¸‹ <a href="https://yunshiuan.com/">https://yunshiuan.com/</a> ç¶²ç«™ä¹‹å‰çš„æ¨£å­ï¼Œå°±å¯ä»¥å°‡ç¶²å€è¼¸å…¥é€²å»å¾Œçœ‹çœ‹ã€‚</p>
<p><img src="/assets/1XCkWh3EsZrt_VK1tm_gQRoafiqcVr9vfBjomnlVdBQ=.png"></p>
<p>ç™¼ç¾å®ƒåœ¨ 8&#x2F;15 æœ‰è¢«æ‰“äº†ä¸€å€‹ snapshotï¼Œé»é€²å»çœ‹çœ‹å¾Œå°±å¯ä»¥çœ‹åˆ°åœ¨ 8&#x2F;15 é€™å€‹ç¶²é æ™‚çš„æ¨£å­</p>
<p><img src="/assets/DgnhK5fhsurE8l2P3XwB4UKENppv9MiZ4XfVIDMUv1o=.png"></p>
<h3 id="Recon-ng"><a href="#Recon-ng" class="headerlink" title="Recon-ng"></a>Recon-ng</h3><p>ä¸‹è¼‰æ–¹å¼</p>
<pre class="line-numbers language-none"><code class="language-none">apt-get update &amp;&amp; apt-get install recon-ng<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Recon-ng æ˜¯ä¸€å€‹ç”¨ Python å¯«æˆã€ä»¥æ¨¡çµ„åŒ–ã€æŒ‡ä»¤åˆ—äº’å‹•ä»‹é¢ç‚ºè¨­è¨ˆçš„ OSINT æ”¶é›†æ¡†æ¶ã€‚å®ƒæŠŠå„é¡è³‡è¨Šæ”¶é›†åŠŸèƒ½ï¼ˆDNSã€WHOISã€æœå°‹å¼•æ“ã€API æŸ¥è©¢ç­‰ï¼‰åŒ…æˆã€Œæ¨¡çµ„ã€ï¼Œç”¨æˆ¶å¯ä»¥åœ¨å·¥ä½œå€ï¼ˆworkspaceï¼‰ä¸­é€æ­¥åŸ·è¡Œã€å­˜æª”èˆ‡åŒ¯å‡ºèª¿æŸ¥çµæœ</p>
<p>Recon-ng  çš„ tutorial é€£çµï¼š <a target="_blank" rel="noopener" href="https://hackertarget.com/recon-ng-tutorial/">https://hackertarget.com/recon-ng-tutorial/</a> </p>
<p>æ•´é«”çš„æ“ä½œæœƒé¡ä¼¼æ–¼ Metasploitï¼Œä¸€æ¨£æœƒå…ˆå¼•å…¥æ¨¡çµ„ï¼Œè¨­å®šåƒæ•¸ç„¶å¾ŒåŸ·è¡Œ</p>
<p>ç›´æ¥åŸ·è¡Œ <code>recon-ng</code> å¾Œå¯ä»¥ä½¿ç”¨ <code>marketplace search</code> æŸ¥çœ‹æœ‰ä»€éº¼å¯ä»¥ç”¨çš„ modules</p>
<pre class="line-numbers language-none"><code class="language-none">$ [recon-ng][default] &gt; marketplace search

  +--------------------------------------------------------------------------------------------------+
  |                        Path                       | Version |     Status    |  Updated   | D | K |
  +--------------------------------------------------------------------------------------------------+
  | discovery&#x2F;info_disclosure&#x2F;cache_snoop             | 1.1     | not installed | 2020-10-13 |   |   |
  | discovery&#x2F;info_disclosure&#x2F;interesting_files       | 1.2     | not installed | 2021-10-04 |   |   |
  | exploitation&#x2F;injection&#x2F;command_injector           | 1.0     | not installed | 2019-06-24 |   |   |
  | exploitation&#x2F;injection&#x2F;xpath_bruter               | 1.2     | not installed | 2019-10-08 |   |   |
  | import&#x2F;csv_file                                   | 1.1     | not installed | 2019-08-09 |   |   |
  | import&#x2F;list                                       | 1.1     | not installed | 2019-06-24 |   |   |
  | import&#x2F;masscan                                    | 1.0     | not installed | 2020-04-07 |   |   |
  | import&#x2F;nmap                                       | 1.1     | not installed | 2020-10-06 |   |   |
  | recon&#x2F;companies-contacts&#x2F;bing_linkedin_cache      | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;companies-contacts&#x2F;censys_email_address     | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;companies-contacts&#x2F;pen                      | 1.1     | not installed | 2019-10-15 |   |   |
  | recon&#x2F;companies-domains&#x2F;censys_subdomains         | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;companies-domains&#x2F;pen                       | 1.1     | not installed | 2019-10-15 |   |   |
  | recon&#x2F;companies-domains&#x2F;viewdns_reverse_whois     | 1.1     | not installed | 2021-08-24 |   |   |
  | recon&#x2F;companies-domains&#x2F;whoxy_dns                 | 1.1     | not installed | 2020-06-17 |   | * |
  | recon&#x2F;companies-multi&#x2F;censys_org                  | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;companies-multi&#x2F;censys_tls_subjects         | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;companies-multi&#x2F;github_miner                | 1.1     | not installed | 2020-05-15 |   | * |
  | recon&#x2F;companies-multi&#x2F;shodan_org                  | 1.1     | not installed | 2020-07-01 | * | * |
  | recon&#x2F;companies-multi&#x2F;whois_miner                 | 1.1     | not installed | 2019-10-15 |   |   |
  | recon&#x2F;contacts-contacts&#x2F;abc                       | 1.0     | not installed | 2019-10-11 | * |   |
  | recon&#x2F;contacts-contacts&#x2F;mailtester                | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;contacts-contacts&#x2F;mangle                    | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;contacts-contacts&#x2F;unmangle                  | 1.1     | not installed | 2019-10-27 |   |   |
  | recon&#x2F;contacts-credentials&#x2F;hibp_breach            | 1.2     | not installed | 2019-09-10 |   | * |
  | recon&#x2F;contacts-credentials&#x2F;hibp_paste             | 1.1     | not installed | 2019-09-10 |   | * |
  | recon&#x2F;contacts-domains&#x2F;censys_email_to_domains    | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;contacts-domains&#x2F;migrate_contacts           | 1.1     | not installed | 2020-05-17 |   |   |
  | recon&#x2F;contacts-profiles&#x2F;fullcontact               | 1.1     | not installed | 2019-07-24 |   | * |
  | recon&#x2F;credentials-credentials&#x2F;adobe               | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;credentials-credentials&#x2F;bozocrack           | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;credentials-credentials&#x2F;hashes_org          | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;domains-companies&#x2F;censys_companies          | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;domains-companies&#x2F;pen                       | 1.1     | not installed | 2019-10-15 |   |   |
  | recon&#x2F;domains-companies&#x2F;whoxy_whois               | 1.1     | not installed | 2020-06-24 |   | * |
  | recon&#x2F;domains-contacts&#x2F;hunter_io                  | 1.3     | not installed | 2020-04-14 |   | * |
  | recon&#x2F;domains-contacts&#x2F;metacrawler                | 1.1     | not installed | 2019-06-24 | * |   |
  | recon&#x2F;domains-contacts&#x2F;pen                        | 1.1     | not installed | 2019-10-15 |   |   |
  | recon&#x2F;domains-contacts&#x2F;pgp_search                 | 1.4     | not installed | 2019-10-16 |   |   |
  | recon&#x2F;domains-contacts&#x2F;whois_pocs                 | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;domains-contacts&#x2F;wikileaker                 | 1.0     | not installed | 2020-04-08 |   |   |
  | recon&#x2F;domains-domains&#x2F;brute_suffix                | 1.1     | not installed | 2020-05-17 |   |   |
  | recon&#x2F;domains-hosts&#x2F;binaryedge                    | 1.2     | not installed | 2020-06-18 |   | * |
  | recon&#x2F;domains-hosts&#x2F;bing_domain_api               | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;domains-hosts&#x2F;bing_domain_web               | 1.1     | not installed | 2019-07-04 |   |   |
  | recon&#x2F;domains-hosts&#x2F;brute_hosts                   | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;domains-hosts&#x2F;builtwith                     | 1.1     | not installed | 2021-08-24 |   | * |
  | recon&#x2F;domains-hosts&#x2F;censys_domain                 | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;domains-hosts&#x2F;certificate_transparency      | 1.3     | not installed | 2019-09-16 |   |   |
  | recon&#x2F;domains-hosts&#x2F;google_site_web               | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;domains-hosts&#x2F;hackertarget                  | 1.1     | installed     | 2020-05-17 |   |   |
  | recon&#x2F;domains-hosts&#x2F;mx_spf_ip                     | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;domains-hosts&#x2F;netcraft                      | 1.1     | not installed | 2020-02-05 |   |   |
  | recon&#x2F;domains-hosts&#x2F;shodan_hostname               | 1.1     | not installed | 2020-07-01 | * | * |
  | recon&#x2F;domains-hosts&#x2F;spyse_subdomains              | 1.1     | not installed | 2021-08-24 |   | * |
  | recon&#x2F;domains-hosts&#x2F;ssl_san                       | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;domains-hosts&#x2F;threatcrowd                   | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;domains-hosts&#x2F;threatminer                   | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;domains-vulnerabilities&#x2F;ghdb                | 1.1     | not installed | 2019-06-26 |   |   |
  | recon&#x2F;domains-vulnerabilities&#x2F;xssed               | 1.1     | not installed | 2020-10-18 |   |   |
  | recon&#x2F;hosts-domains&#x2F;migrate_hosts                 | 1.1     | not installed | 2020-05-17 |   |   |
  | recon&#x2F;hosts-hosts&#x2F;bing_ip                         | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;hosts-hosts&#x2F;censys_hostname                 | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;hosts-hosts&#x2F;censys_ip                       | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;hosts-hosts&#x2F;censys_query                    | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;hosts-hosts&#x2F;ipinfodb                        | 1.2     | not installed | 2021-08-24 |   | * |
  | recon&#x2F;hosts-hosts&#x2F;ipstack                         | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;hosts-hosts&#x2F;resolve                         | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;hosts-hosts&#x2F;reverse_resolve                 | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;hosts-hosts&#x2F;ssltools                        | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;hosts-hosts&#x2F;virustotal                      | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;hosts-locations&#x2F;migrate_hosts               | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;hosts-ports&#x2F;binaryedge                      | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;hosts-ports&#x2F;shodan_ip                       | 1.2     | not installed | 2020-07-01 | * | * |
  | recon&#x2F;locations-locations&#x2F;geocode                 | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;locations-locations&#x2F;reverse_geocode         | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;locations-pushpins&#x2F;flickr                   | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;locations-pushpins&#x2F;shodan                   | 1.1     | not installed | 2020-07-07 | * | * |
  | recon&#x2F;locations-pushpins&#x2F;twitter                  | 1.1     | not installed | 2019-10-17 |   | * |
  | recon&#x2F;locations-pushpins&#x2F;youtube                  | 1.2     | not installed | 2020-09-02 |   | * |
  | recon&#x2F;netblocks-companies&#x2F;censys_netblock_company | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;netblocks-companies&#x2F;whois_orgs              | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;netblocks-hosts&#x2F;censys_netblock             | 2.1     | not installed | 2022-01-31 | * | * |
  | recon&#x2F;netblocks-hosts&#x2F;reverse_resolve             | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;netblocks-hosts&#x2F;shodan_net                  | 1.2     | not installed | 2020-07-21 | * | * |
  | recon&#x2F;netblocks-hosts&#x2F;virustotal                  | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;netblocks-ports&#x2F;census_2012                 | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;netblocks-ports&#x2F;censysio                    | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;ports-hosts&#x2F;migrate_ports                   | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;ports-hosts&#x2F;ssl_scan                        | 1.1     | not installed | 2021-08-24 |   |   |
  | recon&#x2F;profiles-contacts&#x2F;bing_linkedin_contacts    | 1.2     | not installed | 2021-08-24 |   | * |
  | recon&#x2F;profiles-contacts&#x2F;dev_diver                 | 1.1     | not installed | 2020-05-15 |   |   |
  | recon&#x2F;profiles-contacts&#x2F;github_users              | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;profiles-profiles&#x2F;namechk                   | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;profiles-profiles&#x2F;profiler                  | 1.2     | not installed | 2023-12-30 |   |   |
  | recon&#x2F;profiles-profiles&#x2F;twitter_mentioned         | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;profiles-profiles&#x2F;twitter_mentions          | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;profiles-repositories&#x2F;github_repos          | 1.1     | not installed | 2020-05-15 |   | * |
  | recon&#x2F;repositories-profiles&#x2F;github_commits        | 1.0     | not installed | 2019-06-24 |   | * |
  | recon&#x2F;repositories-vulnerabilities&#x2F;gists_search   | 1.0     | not installed | 2019-06-24 |   |   |
  | recon&#x2F;repositories-vulnerabilities&#x2F;github_dorks   | 1.0     | not installed | 2019-06-24 |   | * |
  | reporting&#x2F;csv                                     | 1.0     | not installed | 2019-06-24 |   |   |
  | reporting&#x2F;html                                    | 1.0     | not installed | 2019-06-24 |   |   |
  | reporting&#x2F;json                                    | 1.0     | not installed | 2019-06-24 |   |   |
  | reporting&#x2F;list                                    | 1.0     | not installed | 2019-06-24 |   |   |
  | reporting&#x2F;proxifier                               | 1.0     | not installed | 2019-06-24 |   |   |
  | reporting&#x2F;pushpin                                 | 1.0     | not installed | 2019-06-24 |   | * |
  | reporting&#x2F;xlsx                                    | 1.0     | not installed | 2019-06-24 |   |   |
  | reporting&#x2F;xml                                     | 1.1     | not installed | 2019-06-24 |   |   |
  +--------------------------------------------------------------------------------------------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¥ä¸‹ä¾†ç¤ºç¯„ç”¨ <code>hackertarget</code> å»å°‹æ‰¾ hostname</p>
<p>é¦–å…ˆå…ˆæŠŠ <code>hackertarget</code> å…ˆä¸‹è¼‰ä¸‹ä¾†</p>
<pre class="line-numbers language-none"><code class="language-none">marketplace install hackertarget<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å†æŠŠå®ƒ load é€²ä¾†</p>
<pre class="line-numbers language-none"><code class="language-none">modules load hackertarget<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ¥ä¸‹ä¾†ç”¨ info çœ‹ä¸€ä¸‹æœƒéœ€è¦ä»€éº¼åƒæ•¸</p>
<pre class="line-numbers language-none"><code class="language-none">$ [recon-ng][default][hackertarget] &gt; info

      Name: HackerTarget Lookup
    Author: Michael Henriksen (@michenriksen)
   Version: 1.1

Description:
  Uses the HackerTarget.com API to find host names. Updates the &#39;hosts&#39; table with the results.

Options:
  Name    Current Value  Required  Description
  ------  -------------  --------  -----------
  SOURCE                 yes       source of input (see &#39;info&#39; for details)

Source Options:
  default        SELECT DISTINCT domain FROM domains WHERE domain IS NOT NULL
  &lt;string&gt;       string representing a single input
  &lt;path&gt;         path to a file containing a list of inputs
  query &lt;sql&gt;    database query returning one column of inputs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¥ä¸‹ä¾†å¯ä»¥çœ‹åˆ° SOURCE æœƒéœ€è¦å¡«æ±è¥¿ï¼Œé‚£é€™æ¬„å°±æ˜¯è¦å¡«è¦åµæŸ¥çš„ domainï¼Œä»¥ <code>google.com</code> èˆ‰ä¾‹ã€‚</p>
<p>ç”¨ä¸‹é¢æŒ‡ä»¤è¨­å®š SOURCE</p>
<pre class="line-numbers language-none"><code class="language-none">options set SOURCE google.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å†çœ‹ä¸€æ¬¡ infoï¼Œå¯ä»¥çœ‹åˆ°å®ƒè¢«è¨­å®šæˆäº† <code>google.com</code> </p>
<pre class="line-numbers language-none"><code class="language-none">$ [recon-ng][default][hackertarget] &gt; info

      Name: HackerTarget Lookup
    Author: Michael Henriksen (@michenriksen)
   Version: 1.1

Description:
  Uses the HackerTarget.com API to find host names. Updates the &#39;hosts&#39; table with the results.

Options:
  Name    Current Value  Required  Description
  ------  -------------  --------  -----------
  SOURCE  google.com     yes       source of input (see &#39;info&#39; for details)

Source Options:
  default        SELECT DISTINCT domain FROM domains WHERE domain IS NOT NULL
  &lt;string&gt;       string representing a single input
  &lt;path&gt;         path to a file containing a list of inputs
  query &lt;sql&gt;    database query returning one column of inputs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¥ä¸‹ä¾†æ‰“ run å°±æœƒé–‹å§‹åŸ·è¡Œ</p>
<p>åŸ·è¡Œçš„éç¨‹ä¸­ä¹Ÿæœƒå‡ºç¾çµæœï¼Œæœ€å¾Œåœ¨ä¸‹ <code>show hosts</code> æŒ‡ä»¤å°±æœƒå‡ºç¾è¡¨æ ¼æ¨£å¼çš„çµæœ</p>
<p><img src="/assets/svj4PUeEf1nUKpRCQjze7nr5oPS1zt2QQ496e2hZ8sw=.png"></p>
<h3 id="Whois-domaintools"><a href="#Whois-domaintools" class="headerlink" title="Whois.domaintools"></a>Whois.domaintools</h3><p>ç¶²ç«™é€£çµï¼š<a target="_blank" rel="noopener" href="https://whois.domaintools.com/">https://whois.domaintools.com/</a></p>
<p>é€™å€‹ç¶²ç«™å¯ä»¥æ‰¾åˆ°é—œæ–¼ domain çš„ä¸€äº›è³‡è¨Šï¼ŒåŒ…æ‹¬è¨»å†Šå•†ã€ä½•æ™‚è¨»å†Šã€ä½•æ™‚åˆ°æœŸèˆ‡æœ€å¾Œæ›´æ–°æ™‚é–“ç­‰ç­‰</p>
<p><img src="/assets/TBoAsZNRu4upfnloA9-lYEkUGjBbWF1mTuprg7Q2T_4=.png"></p>
<h3 id="Sherlock"><a href="#Sherlock" class="headerlink" title="Sherlock"></a>Sherlock</h3><p>ä¸‹è¼‰é€£çµï¼š<a target="_blank" rel="noopener" href="https://github.com/sherlock-project/sherlock">https://github.com/sherlock-project/sherlock</a></p>
<p>é€™æ˜¯ä¸€å€‹å¯ä»¥å¿«é€Ÿæœå°‹å„å¤§å¹³å°ç”¨æˆ¶åçš„å·¥å…·</p>
<p>å‡è¨­ä»Šå¤©æˆ‘å€‘ç²å¾—åˆ°äº†ä¸€å€‹ç”¨æˆ¶å«åš<code>yunshiuan</code> æ¥ä¸‹ä¾†ä¸Ÿé€²sherlock</p>
<p><img src="/assets/Rf9_ZONhV5xhlOF3CzJfPYdew6Xk7vKZLSNlSOWvBJc=.png"></p>
<p>ç™¼ç¾äº†è·‘å‡ºè¨±å¤šç”¨æˆ¶åç¨±æ˜¯yunshiuan çš„å¹³å°ï¼Œæ¥ä¸‹ä¾†å°±å¯ä»¥ä¸€ä¸€å»çœ‹æ˜¯ä¸æ˜¯è‡ªå·±æƒ³è¦çš„</p>
<h3 id="HaveIBeenPwned"><a href="#HaveIBeenPwned" class="headerlink" title="HaveIBeenPwned"></a>HaveIBeenPwned</h3><p>é€£çµï¼š<a target="_blank" rel="noopener" href="https://haveibeenpwned.com/">https://haveibeenpwned.com/</a></p>
<p>é€™æ˜¯ä¸€å€‹å¯ä»¥è¼¸å…¥ä¿¡ç®±ï¼Œä»–æœƒèªªè¼¸å…¥çš„ä¿¡ç®±æ˜¯å¦å·²ç¶“è¢«æ´©æ¼å‡ºå»äº†</p>
<p>å‡è¨­è¼¸å…¥ä¸€å€‹å¤§å®¶åœ¨æ¸¬è©¦æ™‚å¾ˆå¸¸è¼¸å…¥çš„<code>aaaaa@gmail.com</code></p>
<p><img src="/assets/YRv_jjfeqpWoNVRieLp2g4zT9Gl5_wRnteRh9wW8GYE=.png"></p>
<p>å¯ä»¥çœ‹åˆ°é€™å€‹ email åœ¨ 20 å¤šå€‹å¹³å°è¢«æ´©æ¼äº†ï¼Œåº•ä¸‹æœƒè·Ÿä½ èªªæ˜¯åœ¨ä½•æ™‚å› ç‚ºä»€éº¼è€Œè¢«æ´©æ¼</p>
<p><img src="/assets/bfiSjA3fimrdDE8iTnRwjRZ3OuPwZ0oK4S-_tCSbWiU=.png"></p>
<h3 id="Epieos"><a href="#Epieos" class="headerlink" title="Epieos"></a>Epieos</h3><p>ç¶²ç«™é€£çµï¼š<a target="_blank" rel="noopener" href="https://epieos.com/">https://epieos.com/</a></p>
<p>ä»–æä¾›äº†emailèˆ‡æ‰‹æ©Ÿè™Ÿç¢¼çš„åå‘æŸ¥è©¢ï¼Œå¹«ä½ æŠŠå’Œè©²email &#x2F; phone æœ‰é—œçš„ç¤¾ç¾¤å¸³è™Ÿã€Google æ´»å‹•ã€è©•åƒ¹ã€å…¬é–‹ç—•è·¡ç­‰ä¸²èµ·ä¾†é¡¯ç¤ºï¼Œæ–¹ä¾¿åšåˆæ­¥èª¿æŸ¥æˆ–é©—è­‰ç·šç´¢</p>
<p><img src="/assets/9PHebz4gf0c55xyN-fS-TDK_HvYakSfp-GV0gIzMo_c=.png"></p>
<p>åº•ä¸‹å…¶å¯¦é‚„æœ‰å…¶ä»–ç¶²ç«™æˆ–è€…æ‡‰ç”¨ç¨‹å¼çš„æƒæï¼Œä½†é‚£äº›å°±æœƒéœ€è¦ä»˜è²»æ‰èƒ½è§€çœ‹</p>
<h3 id="Phoneinfoga"><a href="#Phoneinfoga" class="headerlink" title="Phoneinfoga"></a>Phoneinfoga</h3><p>ä¸‹è¼‰é€£çµï¼š<a target="_blank" rel="noopener" href="https://github.com/sundowndev/phoneinfoga">https://github.com/sundowndev/phoneinfoga</a></p>
<p>é€™å€‹å·¥å…·å¯ä»¥æŸ¥è©¢é€™å€‹é›»è©±è™Ÿç¢¼çš„åŸºæœ¬metadata</p>
<pre class="line-numbers language-none"><code class="language-none">$ .&#x2F;phoneinfoga scan -n +886911111111<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/d6GCUzEdKWX2Yyr2GDw1FAU4ikSOyZx1De-DMHItZZc=.png"></p>
<p>å¦å¤–ä¹Ÿå¯ä»¥ç”¨é–‹server çš„æ–¹å¼ç”¨ç¶²é æŸ¥è©¢</p>
<pre class="line-numbers language-none"><code class="language-none">$ .&#x2F;phoneinfoga serve -p 8080

Listening on :8080<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/PxCHUVESvr-Z_zTZpqgN7nlQQxibied7gFqCAL27Y40=.png"></p>
<h3 id="Google-Hacking"><a href="#Google-Hacking" class="headerlink" title="Google Hacking"></a>Google Hacking</h3><p>é€™æ˜¯ Google æä¾›çš„é€²éšæœå°‹æ³•ï¼Œå®ƒæä¾›ä¸€äº›æ–¹å¼å¯ä»¥æ›´æº–ç¢ºåœ°æ‰¾åˆ°æˆ‘å€‘æƒ³è¦çš„è³‡æ–™æˆ–ç¶²ç«™ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å¸¸è¦‹çš„æœå°‹</p>
<p>â€¢	<code>site:domain.com</code> â€” é™å®šåœ¨æŸå€‹ç¶²åŸŸæœå°‹ï¼Œex:<code>site:github.com</code>ã€‚</p>
<p>â€¢	<code>filetype:pdf / filetype:env / filetype:sql</code> â€” æ‰¾ç‰¹å®šæª”æ¡ˆé¡å‹ã€‚</p>
<p>â€¢	<code>inurl:admin / inurl:login</code> â€” URL ä¸­å«ç‰¹å®šå­—ä¸²ï¼ˆæ‰¾ç®¡ç†é é¢ï¼‰ã€‚</p>
<p>â€¢	<code>intitle:&quot;index of&quot;</code> â€” æ‰¾ç›®éŒ„åˆ—èˆ‰é é¢ï¼ˆå¸¸æš´éœ²æª”æ¡ˆåˆ—è¡¨ï¼‰ã€‚</p>
<p>â€¢	<code>&quot;exact phrase&quot;</code> â€” ç²¾ç¢ºæ¯”å°å­—ä¸²ï¼ˆä¾‹å¦‚æ©Ÿå¯†æª”åæˆ–åƒæ•¸åï¼‰ã€‚</p>
<p>â€¢	-ï¼ˆè² è™Ÿï¼‰æ’é™¤å­—è©ï¼Œex: <code>site:example.com</code> <code>-site:blog.example.com</code>ã€‚</p>
<p>å¦å¤–ä¹Ÿå¯ä»¥ç”¨ <code>OR</code>ã€<code>+</code> ä¾†ä¸²æ¥å¤šå€‹é€²éšæœå°‹çµæœ</p>
<p><img src="/assets/DxLpxVnMZEKL_lROU9xsoRvZnZu_3iecohb79vO3gzU=.png"></p>
<h3 id="Google-Map-Google-Earth"><a href="#Google-Map-Google-Earth" class="headerlink" title="Google Map &#x2F; Google Earth"></a>Google Map &#x2F; Google Earth</h3><p>Google åœ°åœ–æ˜¯ Google æä¾›çš„ç¶²è·¯åœ°åœ–æœå‹™ï¼Œé€™å€‹æœå‹™æä¾›äº†å¤šç¨®è¦–åœ–æ¨¡å¼ï¼ŒåŒ…æ‹¬è¡›æ˜Ÿåœ–ã€è¡—é“åœ–å’Œåœ°å½¢åœ–ï¼Œè®“ç”¨æˆ¶å¯ä»¥æ ¹æ“šéœ€æ±‚é¸æ“‡æœ€é©åˆçš„è¦–è§’ä¾†æŸ¥çœ‹åœ°åœ–</p>
<p><img src="/assets/AM7XkPseqHtJ64J0lHNKzlYK_NjHdww-qvZ-EDJlbQY=.png"></p>
<p>Google Earth æ˜¯ä¸€å€‹æ›´é€²éšçš„ 3D åœ°çƒç€è¦½å™¨ï¼Œè®“ç”¨æˆ¶èƒ½å¤ ä»¥ç«‹é«”çš„æ–¹å¼æ¢ç´¢ä¸–ç•Œã€‚æ­·å²å½±åƒåŠŸèƒ½è®“ç”¨æˆ¶å¯ä»¥æŸ¥çœ‹ä¸åŒæ™‚æœŸçš„è¡›æ˜Ÿå½±åƒï¼Œè§€å¯ŸåŸå¸‚çš„ç™¼å±•è®ŠåŒ–ï¼Œè€Œè¡—æ™¯æ•´åˆåŠŸèƒ½å‰‡åœ¨ 3D ç’°å¢ƒä¸­åµŒå…¥äº†è¡—æ™¯è¦–åœ–ï¼Œä¸¦ä¸”å¯ä»¥åŒ¯å…¥ KML æª”</p>
<p><img src="/assets/Nqm0R92EVsQ60NoKlkI9vqtx9kdYYYIJFoBYZhEUTA0=.png"></p>
<h3 id="Google-æ™ºæ…§é¡é ­"><a href="#Google-æ™ºæ…§é¡é ­" class="headerlink" title="Google æ™ºæ…§é¡é ­"></a>Google æ™ºæ…§é¡é ­</h3><p>Google æ™ºæ…§é¡é ­æ˜¯ä¸€å€‹åŸºæ–¼ AI çš„è¦–è¦ºæœå°‹å·¥å…·ï¼Œä½ å¯ä»¥æŠŠä½ æƒ³è¦è¾¨è­˜çš„åœ–ç‰‡ä¸Ÿé€²å»ï¼Œå®ƒæœƒæŠŠç¶²è·¯ä¸Šé¡ä¼¼çš„åœ–ç‰‡ä¸Ÿçµ¦ä½ </p>
<p>åœ¨æœå°‹åˆ—å°±å¯ä»¥æ‰¾åˆ°æ™ºæ…§é¡é ­çš„ icon</p>
<p><img src="/assets/jZWhq_f9A2B3eBaFBL80Oolkc6_952uiK4kCQq7InJ0=.png"></p>
<p>é»æ“Šå¾ŒæŠŠåœ–ç‰‡ä¸Ÿé€²å»å®ƒå°±æœƒå¹«ä½ æŸ¥æœ‰æ²’æœ‰é¡ä¼¼çš„åœ–ç‰‡</p>
<p><img src="/assets/kKnQobr1ng3IbFvcC_9I5sWMSVUr-T2nkvQ_24bhC3M=.png"></p>
<h3 id="Geohints"><a href="#Geohints" class="headerlink" title="Geohints"></a>Geohints</h3><p>ç¶²ç«™é€£çµï¼š<a target="_blank" rel="noopener" href="https://geohints.com/">https://geohints.com/</a></p>
<p>é€™å€‹ç¶²ç«™æ•´ç†äº†å¾ˆå¤šæ¯å€‹åœ‹å®¶çš„ Google è¡—æ™¯å…·æœ‰ç‰¹è‰²çš„éƒ¨åˆ†ï¼Œåƒæ˜¯è»Šç‰Œã€é“è·¯ã€é›»ç·šç«¿ã€æ¨™èªŒç­‰ç…§ç‰‡ï¼Œå¦‚æœé‡åˆ°æ²’çœ‹éçš„éƒ½å¯ä»¥ä¾†é€™é‚ŠæŸ¥</p>
<p><img src="/assets/hvedPNXTINc-yVUpWuTxXMSQBGihsp3dkifiHQYigmk=.png"></p>
<h3 id="Overpass-turbo"><a href="#Overpass-turbo" class="headerlink" title="Overpass turbo"></a>Overpass turbo</h3><p>ç¶²å€ï¼š<a target="_blank" rel="noopener" href="https://overpass-turbo.eu/">https://overpass-turbo.eu/</a></p>
<p>Overpass Turbo æ˜¯ä¸€å€‹åŸºæ–¼ç¶²é çš„æŸ¥è©¢å·¥å…·ï¼Œå°ˆé–€ç”¨æ–¼æŸ¥è©¢ OpenStreetMap è³‡æ–™åº«ã€‚å®ƒæä¾›äº†ä¸€å€‹ç›´è§€çš„ä»‹é¢ï¼Œè®“ç”¨æˆ¶èƒ½å¤ ä½¿ç”¨ Overpass QL æŸ¥è©¢èªè¨€ä¾†æœå°‹å’Œæå– OSM ä¸­çš„åœ°ç†è³‡æ–™ã€‚</p>
<p>è€Œ <a target="_blank" rel="noopener" href="https://www.openstreetmap.org/#map=12/56.4984/16.6010">OpenStreetMap</a> æ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„é–‹æ”¾åœ°ç†è³‡æ–™åº«ï¼ŒåŒ…å«äº†å…¨çƒå„åœ°çš„é“è·¯ã€å»ºç¯‰ç‰©ã€èˆˆè¶£é»ç­‰è©³ç´°è³‡è¨Šã€‚</p>
<p><img src="/assets/OCrdN1c5cGeTKK0BCCkvA-6cWK104_wpnCDz_fT2D5s=.png"></p>
<p>æ¥ä¸‹ä¾†ä»‹ç´¹ä¸€ä¸‹è¦æ€éº¼ä½¿ç”¨Overpass QL æŸ¥è©¢æˆ‘å€‘æƒ³è¦çš„æ±è¥¿ã€‚</p>
<p>é¦–å…ˆæ˜¯ OSM çš„è³‡æ–™çµæ§‹ï¼Œå®ƒä½¿ç”¨ç¯€é» (nodes)ã€è·¯å¾‘ (ways) å’Œé—œä¿‚ (relations) ä¸‰ç¨®åŸºæœ¬å…ƒç´ ä¾†æè¿°åœ°ç†ç‰©ä»¶ï¼š</p>
<ul>
<li><strong>ç¯€é» (Nodes)</strong>ï¼šä»£è¡¨é»ç‹€ç‰©ä»¶ï¼Œå¦‚å•†åº—æˆ–åœ°æ¨™</li>
<li><strong>è·¯å¾‘ (Ways)</strong>ï¼šä»£è¡¨ç·šç‹€æˆ–é¢ç‹€ç‰©ä»¶ï¼Œå¦‚é“è·¯æˆ–å»ºç¯‰ç‰©</li>
<li><strong>é—œä¿‚ (Relations)</strong>ï¼šç”¨æ–¼æè¿°è¤‡é›œçš„ç‰©ä»¶ï¼Œå¦‚å¤šå€‹éƒ¨åˆ†çµ„æˆçš„å»ºç¯‰ç‰©ç¾¤</li>
</ul>
<p>æœ€åŸºæœ¬çš„æŸ¥è©¢ä»¥ <code>[out:json];</code> é–‹å§‹ï¼Œé€™æŒ‡å®šäº†è¼¸å‡ºæ ¼å¼ã€‚æ¥è‘—ä½¿ç”¨ <code>node</code>ã€<code>way</code> æˆ– <code>relation</code> ä¾†æŒ‡å®šè¦æŸ¥è©¢çš„ç‰©ä»¶é¡å‹ï¼Œè€Œ<code>nwr</code>å‰‡å¯ä»¥å°‡ä¸‰è€…éƒ½åŒ…å«ï¼Œç„¶å¾Œåœ¨æ–¹æ‹¬è™Ÿä¸­æŒ‡å®šæœå°‹æ¢ä»¶ï¼Œé—œæ–¼æœå°‹æ¢ä»¶çš„æ‰€æœ‰çš„key è·Ÿvalue éƒ½å¯ä»¥åœ¨é€™é‚ŠæŸ¥åˆ° <a target="_blank" rel="noopener" href="https://wiki.openstreetmap.org/wiki/Map/_features">https://wiki.openstreetmap.org/wiki/Map\_features</a> ã€‚</p>
<p>åƒåœ–ç¤ºä¸­æ˜¯L3akCTF 2025çš„å…¶ä¸­ä¸€é¡Œ<a target="_blank" rel="noopener" href="https://medium.com/@shibaosint/l3akctf-2025-fidget-spinner-writeup-cd94eafc2828">Fidget Spinner</a>æˆ‘å€‘æƒ³è¦æ‰¾åœ¨å„è˜­å³¶ä¸Šæ‰€æœ‰çš„é¢¨è»Šåœ°é»ï¼Œå¯ä»¥é€™æ¨£å¯«</p>
<pre class="line-numbers language-none"><code class="language-none">[out:json][timeout:25];
&#x2F;&#x2F;restrict our search to the island
area[name&#x3D;&quot;Ã–land&quot;];
(
  &#x2F;&#x2F; search for windmills
  nwr[&quot;man_made&quot;&#x3D;&quot;windmill&quot;](area); &#x2F;&#x2F;(area)çš„åŠŸèƒ½æ˜¯é™åˆ¶åœ¨Ã–landåœ°é»ä¸ŠæŸ¥è©¢
);
&#x2F;&#x2F; print results
out geom;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¹‹å¾Œå‡ºä¾†çš„çµæœå°±æœƒæ˜¯é€™æ¨£</p>
<p><img src="/assets/hLt5ujf8M4p8aGhdbo4CVsi7_xOwj5CBfN3zKMmBMMo=.png"></p>
<p>æ¥ä¸‹ä¾†å®ƒä¹Ÿå¯ä»¥åŒ¯å‡ºæˆ KML æª”ï¼Œç„¶å¾Œæ”¾åˆ° Google Map &#x2F; Google Earth ä¸Š</p>
<p><img src="/assets/BoYcPTrtyYVX4YFzs6DzQ9bPESm3RDAuLS-dqbSBsUk=.png"></p>
<p>æ¥ä¸‹ä¾†å°±å¯ä»¥å»ä¸€ä¸€é©—è­‰æ˜¯å¦æ˜¯é¡Œç›®æƒ³è¦çš„ä½ç½®</p>
<p>å¦å¤–ä¹Ÿå¯ä»¥åƒé€™æ¨£æŠŠæƒ³è¦çš„å€åŸŸå…ˆåŒ¡èµ·ä¾†ç„¶å¾ŒæŸ¥è©¢</p>
<p><img src="/assets/TEiO_tKmOGHWcEVH1ynu8k2Lze8ViVkW0SaFlpMOXQI=.png"></p>
<p><code>source : https://medium.com/@PretendNotToBe/ea6e8f3fb763</code></p>
<h3 id="Exiftool"><a href="#Exiftool" class="headerlink" title="Exiftool"></a><a target="_blank" rel="noopener" href="https://exiftool.org/">Exiftool</a></h3><p>å®ƒå¯ä»¥å»çœ‹åœ–ç‰‡çš„åŸºæœ¬è³‡æ–™ï¼Œä¾‹å¦‚åœ–ç‰‡å¤§å°ã€ä¿®æ”¹æ™‚é–“ç­‰ç­‰ï¼Œä½†å®ƒå¯ä»¥å»çœ‹é€™å¼µç…§ç‰‡çš„æ‹æ”åœ°é»åœ¨å“ªè£¡ï¼Œä¸¦ä¸”æœƒçµ¦ä½  GPS å®šä½ã€‚</p>
<p>èˆ‰å€‹ä¾‹å­ï¼š<a target="_blank" rel="noopener" href="https://drive.google.com/file/d/17rE9LAp7TNk8u09EwguZB3RQ4H3WNIMB/view">DownUnderCTF 2023 Excellent Vista!</a></p>
<p>ä¸‹è¼‰ä¹‹å¾Œç”¨ exiftool çœ‹ä¸€ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">$ exiftool ExcellentVista.jpg

ExifTool Version Number         : 13.10
File Name                       : ExcellentVista.jpg
Directory                       : .
File Size                       : 2.7 MB
File Modification Date&#x2F;Time     : 2025:09:23 15:41:41+08:00
File Access Date&#x2F;Time           : 2025:09:23 15:41:45+08:00
File Inode Change Date&#x2F;Time     : 2025:09:23 15:41:44+08:00
File Permissions                : -rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image&#x2F;jpeg
Exif Byte Order                 : Big-endian (Motorola, MM)
X Resolution                    : 72
Y Resolution                    : 72
Resolution Unit                 : inches
Y Cb Cr Positioning             : Centered
Date&#x2F;Time Original              : 2023:08:31 22:58:56
Create Date                     : 2023:08:31 22:58:56
Sub Sec Time Original           : 00
Sub Sec Time Digitized          : 00
GPS Version ID                  : 2.3.0.0
GPS Latitude Ref                : South
GPS Longitude Ref               : East
GPS Altitude Ref                : Above Sea Level
GPS Speed Ref                   : km&#x2F;h
GPS Speed                       : 0
GPS Img Direction Ref           : True North
GPS Img Direction               : 122.5013812
GPS Dest Bearing Ref            : True North
GPS Dest Bearing                : 122.5013812
GPS Horizontal Positioning Error: 6.055886243 m
Padding                         : (Binary data 2060 bytes, use -b option to extract)
About                           : uuid:faf5bdd5-ba3d-11da-ad31-d33d75182f1b
Image Width                     : 4032
Image Height                    : 3024
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 4032x3024
Megapixels                      : 12.2
Create Date                     : 2023:08:31 22:58:56.00
Date&#x2F;Time Original              : 2023:08:31 22:58:56.00
GPS Altitude                    : 70.5 m Above Sea Level
GPS Latitude                    : 29 deg 30&#39; 34.33&quot; S
GPS Longitude                   : 153 deg 21&#39; 34.46&quot; E
GPS Position                    : 29 deg 30&#39; 34.33&quot; S, 153 deg 21&#39; 34.46&quot; E<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ€å¾Œå®ƒæä¾›äº†æ‹ç…§çš„åœ°é»ã€‚</p>
<h3 id="What3words"><a href="#What3words" class="headerlink" title="What3words"></a>What3words</h3><p>ç¶²ç«™é€£çµï¼š<a target="_blank" rel="noopener" href="https://what3words.com/">https://what3words.com/</a></p>
<p>é€™å€‹ç¶²ç«™å¯ä»¥åªåˆ©ç”¨ä¸‰å€‹ç›¸é—œçš„è©å½™å»å®šä½åˆ°æƒ³è¦çš„åœ°é»ï¼Œå› ç‚ºæœ‰äº›åœ°æ–¹æœƒæ²’æœ‰åœ°å€ï¼Œæ‰€ä»¥æœƒéœ€è¦é é€™å€‹æ–¹å¼å®šä½</p>
<p>åƒæ˜¯æˆåŠŸå¤§å­¸è³‡è¨Šç³»é¤¨æ˜¯ <code>imported.dull.buns</code>ï¼Œä¹‹å¾Œå»é€™å€‹ç¶²ç«™æŸ¥å°±ä¸€æ¨£æœƒå®šä½åˆ°é€™é‚Š</p>
<p><img src="/assets/tVfxyDKTRPL6hxH59oD19ORtuhNS5r4Y-V8fsrTCtn8=.png"></p>
</div></article></div></main><footer><div class="paginator"><a href="/2025/08/14/SleepyPickle/" class="prev">PREV</a></div><div class="copyright"><p>Â© 2025 - 2026 <a href="https://yunshiuan.com">yunshiuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-clike.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cpp.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
</script><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>