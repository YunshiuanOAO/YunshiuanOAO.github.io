<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> ACSCCTF 2025 Please Recover My Files Â· yunshiuan</title><meta name="description" content="ACSCCTF 2025 Please Recover My Files - yunshiuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/assets/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yunshiuan.com/atom.xml" title="yunshiuan"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="yunshiuan" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/assets/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="https://github.com/YunshiuanOAO" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/assets/CV.pdf" target="_self" class="nav-list-link">CV</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">ACSCCTF 2025 Please Recover My Files</h1><div class="post-info">Sep 19, 2025</div><div class="post-content"><h1 id="ğŸ§‚-å‰è¨€"><a href="#ğŸ§‚-å‰è¨€" class="headerlink" title="ğŸ§‚ å‰è¨€"></a>ğŸ§‚ å‰è¨€</h1><p>ä»Šå¤©æˆ‘æƒ³è¦åˆ†äº«æˆ‘åœ¨ ACSCCTF 2025 æˆåŠŸè§£å‡ºçš„å…¶ä¸­ä¸€é¡Œ please recover my files ï¼Œé€™é¡Œæ˜¯ä¸€å€‹Linux Memory Forensic çš„é¡Œç›®ï¼Œå‰›å¥½ç”¨åˆ°äº†å‰ä¸€å¤©åˆ†äº«çš„çŸ¥è­˜ï¼Œè¶é€™æ¬¡éµäººè³½çš„æ©Ÿæœƒå¯«æˆ Writeup è·Ÿå¤§å®¶åˆ†äº«è§£é¡Œæ€è·¯</p>
<hr>
<h1 id="ğŸ˜-ä»™è²å·¥å…·"><a href="#ğŸ˜-ä»™è²å·¥å…·" class="headerlink" title="ğŸ˜ ä»™è²å·¥å…·"></a>ğŸ˜ ä»™è²å·¥å…·</h1><h2 id="Volatility"><a href="#Volatility" class="headerlink" title="Volatility"></a>Volatility</h2><p>ä¸‹è¼‰é€£çµï¼š</p>
<p>Volatility 2 :  <a target="_blank" rel="noopener" href="https://github.com/volatilityfoundation/volatility">https://github.com/volatilityfoundation/volatility</a></p>
<p>Volatility 3 :  <a target="_blank" rel="noopener" href="https://github.com/volatilityfoundation/volatility3">https://github.com/volatilityfoundation/volatility3</a></p>
<p>ç¶“å…¸çš„è¨˜æ†¶é«”åˆ†æå·¥å…·ï¼Œåˆ©ç”¨æŒ‡ä»¤å¯ä»¥åˆ†æ memory dump ä¸­çš„é—œéµè¨Šæ¯ï¼Œåƒæ˜¯é€²ç¨‹ã€ç¶²è·¯é€£ç·šã€æª”æ¡ˆâ€¦â€¦ç­‰ç­‰ã€‚</p>
<p>åŸºæœ¬çš„æ“ä½œé€™é‚Šæ¨è–¦å¯ä»¥ç›´æ¥ä¸Šç¶²æŸ¥æœ‰äººæ•´ç†å¥½çš„æŒ‡ä»¤doc</p>
<p>è€ŒVolatilityåˆ†ç‚º2èˆ‡3ç‰ˆï¼Œå·®åˆ¥å°±æ˜¯ä¸€å€‹æ˜¯è¦ä½¿ç”¨ python2 åŸ·è¡Œï¼Œå¦ä¸€å€‹æ˜¯ç”¨ python3 åŸ·è¡Œï¼Œä¸¦ä¸”ç¾åœ¨Volatility 2 å·²ç¶“æ²’æœ‰åœ¨ç¶­è­·äº†ï¼Œä½†æ˜¯ä¸€äº› Plugin çš„å®Œæ•´åº¦åœ¨ç›®å‰ç‚ºæ­¢é‚„æ˜¯æ¯” Volatility 3 é‚„è¦é«˜ä¸¦ä¸”è±å¯Œï¼Œæ‰€ä»¥æœ‰äº›äººé‚„æ˜¯æœƒæ¯”è¼ƒæœƒåå‘ä½¿ç”¨ Volatility 2 ï¼Œä»Šå¤©åˆ†äº«æœƒä¸»è¦ä½¿ç”¨ Volatility 3</p>
<h2 id="Ida"><a href="#Ida" class="headerlink" title="Ida"></a>Ida</h2><p>ä¸‹è¼‰é€£çµï¼š<a target="_blank" rel="noopener" href="https://hex-rays.com/ida-pro">https://hex-rays.com/ida-pro</a></p>
<p>ç¶“å…¸åç·¨è­¯å·¥å…·ï¼Œ å¯ä»¥å°‡åŸ·è¡Œæª”åç·¨è­¯æˆäººå¯ä»¥çœ‹æ‡‚çš„ç¨‹å¼ç¢¼</p>
<h1 id="Cyberchef"><a href="#Cyberchef" class="headerlink" title="Cyberchef"></a>Cyberchef</h1><p>ç¶²ç«™é€£çµï¼š<a target="_blank" rel="noopener" href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a></p>
<p>éå¸¸å¥½ç”¨çš„è§£å¯†ç¶²ç«™ï¼Œæ”¯æ´å¤šå€‹åŠ è§£å¯†åŠŸèƒ½</p>
<hr>
<h1 id="é¡Œç›®å¤§ç¶±"><a href="#é¡Œç›®å¤§ç¶±" class="headerlink" title="é¡Œç›®å¤§ç¶±"></a>é¡Œç›®å¤§ç¶±</h1><p>é€™é¡Œçš„é¡Œæ„å¤§è‡´æ˜¯ï¼Œä»–ç™¼ç¾äº†ä»–çš„æª”æ¡ˆè¢«åŠ å¯†äº†ï¼Œè«‹æ¢å¾©ä»–ï¼Œå› æ­¤ä¸»è¦çš„ç›®æ¨™æ˜¯æœƒéœ€è¦æ‰¾åˆ°æ€ªæ€ªçš„åŠ å¯†ç¨‹å¼ä»¥åŠè¢«åŠ å¯†çš„æª”æ¡ˆï¼Œä¸¦åˆ†æä»–çš„åŠ å¯†ç¨‹å¼æ˜¯æ€éº¼åŠ å¯†çš„ä¸¦é‚„åŸä»–ã€‚</p>
<h1 id="èª¿æŸ¥é–‹å§‹"><a href="#èª¿æŸ¥é–‹å§‹" class="headerlink" title="èª¿æŸ¥é–‹å§‹"></a>èª¿æŸ¥é–‹å§‹</h1><p>èµ·æ‰‹å¼å…ˆçœ‹ä¸€ä¸‹ä»–çš„ä½œæ¥­ç³»çµ±ä»¥åŠä»–çš„ç‰ˆæœ¬æ˜¯å¤šå°‘</p>
<p><img src="/assets/CcR004mNRinsSkEIROnMdRpEYrUW7HYupvm8H-i3vbA=.png"></p>
<p>å¾—çŸ¥èªªé€™å€‹ memory dump çš„ä½œæ¥­ç³»çµ±ç‚º Debianï¼Œè€Œä»– Linux æ ¸å¿ƒç‰ˆæœ¬æ˜¯ 6.1.0-27ï¼Œä¸¦ä¸”ä»–æ˜¯2024-11-01å‡ºç¾çš„ï¼Œè©¦è©¦çœ‹pslistæœ‰æ²’æœ‰è¾¦æ³•å‡ºç¾æ±è¥¿ï¼Œä½†å› ç‚ºå®˜æ–¹çµ¦çš„Sysbol Tableå¤ªå°‘ï¼Œå› æ­¤é«˜æ©Ÿç‡æœƒå‡ºç¾ Symbol Table ç¼ºå¤±éŒ¯èª¤</p>
<p><img src="/assets/D_2GFVDfbfAAVjDSdchihnsztesFzwNWKaIjHjNxijw=.png"></p>
<p>å› æ­¤å¯ä»¥è©¦è©¦çœ‹å‰ä¸€å¤©æåˆ°çš„ <a target="_blank" rel="noopener" href="https://github.com/Abyss-W4tcher/volatility3-symbols">https://github.com/Abyss-W4tcher/volatility3-symbols</a> æœ‰äººå·²ç¶“å¹«å¿™æ•´ç†çš„ Symbol Table æ‰¾æ‰¾çœ‹ï¼Œé€™é‚Šå‰›å¥½ä»–æœ‰ã€‚</p>
<p>å› æ­¤æŠŠå°æ‡‰ç‰ˆæœ¬çš„ Symbol Table ä¸‹è¼‰ä¸‹ä¾†å¾Œæ”¾åœ¨V olatility 3 è³‡æ–™å¤¾ä¸­çš„ volatility3\symbols\linux è·¯å¾‘ï¼Œå†æ¬¡ç”¨ pslist çœ‹ä¸€ä¸‹æœƒä¸æœƒæˆåŠŸã€‚ç™¼ç¾ç¢ºå¯¦å¯ä»¥æ­£å¸¸åˆ†æäº†</p>
<p><img src="/assets/BDfS9sFG6UMHPaE7FvAh55ncuC3wqZ3DO4KcDQZwUpg=.png"></p>
<p>æ¥ä¸‹ä¾†ä¸‹pstree çœ‹ä¸€ä¸‹æœ‰ä»€éº¼å€¼å¾—çœ‹ä¸¦ä¸”å¯ç–‘çš„é€²ç¨‹</p>
<pre class="line-numbers language-none"><code class="language-none">PS C:\Users\yunshiuan\Desktop\Tools\volatility3 &gt; python3 .\vol.py -f &quot;C:\Users\yunshiuan\Desktop\asac\chall.raw&quot; linux.pstree
Volatility 3 Framework 2.26.2
Progress:  100.00               Stacking attempts finished
OFFSET (V)      PID     TID     PPID    COMM

0x8a6100241fc0  1       1       0       systemd
* 0x8a611367bf80        356     356     1       systemd-journal
* 0x8a61015d5f40        388     388     1       systemd-udevd
* 0x8a610b808000        440     440     1       systemd-timesyn
* 0x8a6107958000        630     630     1       accounts-daemon
* 0x8a6107959fc0        631     631     1       anacron
* 0x8a610795bf80        632     632     1       avahi-daemon
** 0x8a610b823f80       646     646     632     avahi-daemon
* 0x8a61015d0000        633     633     1       cron
* 0x8a61159b5f40        634     634     1       dbus-daemon
* 0x8a61159b1fc0        636     636     1       low-memory-moni
* 0x8a61159b3f80        637     637     1       polkitd
* 0x8a610794df40        638     638     1       power-profiles-
* 0x8a6107948000        639     639     1       switcheroo-cont
* 0x8a6107949fc0        640     640     1       systemd-logind
* 0x8a610794bf80        641     641     1       udisksd
* 0x8a6107965f40        652     652     1       NetworkManager
* 0x8a6106740000        657     657     1       wpa_supplicant
* 0x8a6112083f80        674     674     1       ModemManager
* 0x8a61120a8000        693     693     1       cupsd
* 0x8a61120a9fc0        707     707     1       gdm3
** 0x8a6110c3bf80       1193    1193    707     gdm-session-wor
*** 0x8a610b80df40      1273    1273    1193    gdm-wayland-ses
**** 0x8a6108263f80     1283    1283    1273    gnome-session-b
* 0x8a6103590000        724     724     1       cups-browsed
* 0x8a61035a3f80        773     773     1       rtkit-daemon
* 0x8a6108a4df40        893     893     1       upowerd
* 0x8a610abfbf80        923     923     1       geoclue
* 0x8a610abf8000        930     930     1       packagekitd
* 0x8a6112e08000        938     938     1       colord
* 0x8a610a445f40        1205    1205    1       systemd
** 0x8a6108a4bf80       1208    1208    1205    (sd-pam)
** 0x8a61120a0000       1223    1223    1205    pipewire
** 0x8a6107658000       1228    1228    1205    wireplumber
** 0x8a6107453f80       1232    1232    1205    pipewire-pulse
** 0x8a610a438000       1234    1234    1205    dbus-daemon
** 0x8a610a43df40       1235    1235    1205    gnome-keyring-d
** 0x8a610a439fc0       1244    1244    1205    gvfsd
*** 0x8a6112e09fc0      2041    2041    1244    gvfsd-trash
** 0x8a6109c2df40       1258    1258    1205    gvfsd-fuse
** 0x8a6104c80000       1324    1324    1205    tracker-miner-f
** 0x8a6104c7df40       1332    1332    1205    gcr-ssh-agent
** 0x8a6104c78000       1333    1333    1205    gnome-session-c
** 0x8a6104c79fc0       1334    1334    1205    ssh-agent
** 0x8a6108265f40       1342    1342    1205    gnome-session-b
*** 0x8a61027c1fc0      1360    1360    1342    at-spi-bus-laun
**** 0x8a61027d1fc0     1373    1373    1360    dbus-daemon
*** 0x8a6108105f40      1540    1540    1342    evolution-alarm
*** 0x8a6112c89fc0      1569    1569    1342    gsd-disk-utilit
*** 0x8a6109a73f80      1574    1574    1342    gnome-software
** 0x8a61027c5f40       1361    1361    1205    gvfs-udisks2-vo
** 0x8a61027d0000       1365    1365    1205    gnome-shell
** 0x8a61027d3f80       1376    1376    1205    gvfs-gphoto2-vo
** 0x8a61027c0000       1385    1385    1205    gvfs-goa-volume
** 0x8a6107d43f80       1395    1395    1205    goa-daemon
** 0x8a6107b70000       1408    1408    1205    goa-identity-se
** 0x8a6107b75f40       1417    1417    1205    gvfs-mtp-volume
** 0x8a6107b10000       1422    1422    1205    gvfs-afc-volume
** 0x8a6107ba1fc0       1460    1460    1205    xdg-permission-
** 0x8a6107ba3f80       1463    1463    1205    gnome-shell-cal
** 0x8a610815df40       1475    1475    1205    evolution-sourc
** 0x8a6108161fc0       1486    1486    1205    gjs
** 0x8a61080e9fc0       1488    1488    1205    at-spi2-registr
** 0x8a6108163f80       1498    1498    1205    sh
*** 0x8a6112c8bf80      1568    1568    1498    ibus-daemon
**** 0x8a615b9e1fc0     1689    1689    1568    ibus-dconf
**** 0x8a615b9e0000     1690    1690    1568    ibus-extension-
**** 0x8a61111a0000     1759    1759    1568    ibus-engine-sim
** 0x8a6108171fc0       1501    1501    1205    gsd-a11y-settin
** 0x8a6108175f40       1502    1502    1205    gsd-color
** 0x8a6108173f80       1503    1503    1205    gsd-datetime
** 0x8a6108170000       1505    1505    1205    gsd-housekeepin
** 0x8a6108180000       1508    1508    1205    gsd-keyboard
** 0x8a6108181fc0       1512    1512    1205    gsd-media-keys
** 0x8a6108185f40       1518    1518    1205    gsd-power
** 0x8a6108183f80       1519    1519    1205    gsd-print-notif
** 0x8a61080f1fc0       1526    1526    1205    gsd-rfkill
** 0x8a61080f3f80       1527    1527    1205    gsd-screensaver
** 0x8a611118df40       1536    1536    1205    gsd-sharing
** 0x8a611118bf80       1537    1537    1205    gsd-smartcard
** 0x8a6111188000       1538    1538    1205    gsd-sound
** 0x8a6111189fc0       1539    1539    1205    gsd-usb-protect
** 0x8a61111a1fc0       1541    1541    1205    gsd-wacom
** 0x8a6112c95f40       1570    1570    1205    evolution-calen
** 0x8a615b86df40       1633    1633    1205    gjs
** 0x8a615b9cbf80       1684    1684    1205    evolution-addre
** 0x8a615b9cdf40       1700    1700    1205    ibus-portal
** 0x8a615b9f5f40       1712    1712    1205    gsd-printer
** 0x8a6112088000       1745    1745    1205    xdg-desktop-por
** 0x8a6109a90000       1758    1758    1205    xdg-document-po
*** 0x8a61661a5f40      1778    1778    1758    fusermount3
** 0x8a615bbf8000       1789    1789    1205    xdg-desktop-por
** 0x8a610745df40       1830    1830    1205    xdg-desktop-por
** 0x8a6108859fc0       2015    2015    1205    gnome-calendar
** 0x8a61035a1fc0       2017    2017    1205    gnome-control-c
** 0x8a61035a0000       2021    2021    1205    gnome-terminal-
*** 0x8a610b801fc0      2255    2255    2021    bash
**** 0x8a6107ba0000     2258    2258    2255    su
***** 0x8a6112c9df40    2259    2259    2258    bash
****** 0x8a6110c3df40   2272    2272    2259    avml
** 0x8a6103431fc0       2102    2102    1205    dconf-service
** 0x8a610b813f80       2261    2261    1205    su
** 0x8a6108868000       2279    2279    1205    gvfsd-metadata
* 0x8a6108f9bf80        1841    1841    1       fwupd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…¶ä¸­æœ‰è¶£çš„æ˜¯åœ¨ 102 è¡Œ ä»–é–‹äº†bash å¾ŒåŸ·è¡Œäº† su ï¼Œä¹‹å¾Œåº•ä¸‹åˆé–‹äº† bash ä¹‹å¾Œæ˜¯ avml ï¼Œå¦‚æœæ˜¯bashçš„è©±æœ‰ä¸€å€‹å¾ˆä¸éŒ¯ç”¨çš„linux.bash Plugin å¯ä»¥ä½¿ç”¨ï¼Œå®ƒå¯ä»¥å»çœ‹ä¹‹å‰ä½¿ç”¨è€…åœ¨bashä¸­è¼¸å…¥äº†ä»€éº¼æŒ‡ä»¤ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">python3 .\vol.py -f &quot;C:\Users\yunshiuan\Desktop\asac\chall.raw&quot; linux.bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/68z4U1rOFmpRYIcJRHZfTPv7MJGjeo2SrAMFDxCKZkE=.png"></p>
<p>çœ‹åˆ°è¶…å¯ç–‘çš„ su äº†ï¼Œå› ç‚ºä¸€èˆ¬ä¸‹ su ä¸æœƒä½¿ç”¨<code>./</code> åœ¨ç¾åœ¨ä½ç½®åŸ·è¡Œï¼Œå› æ­¤å¯é‡é»å»çœ‹é€™å€‹ su åœ¨å¹¹å˜›ã€‚</p>
<p>é¦–å…ˆå…ˆçœ‹é€™å€‹ su åˆ°åº•åœ¨å“ªè£¡</p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">python3 .\vol.py -f &quot;C:\Users\yunshiuan\Desktop\asac\chall.raw&quot; linux.pagecache.Files &gt; files.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/AHAFKQQL4w4D4KPXJ7skTSx4v8maa_5BfbF52y6qMUc=.png"></p>
<p>ok æ‰¾åˆ°äº† ç™¼ç¾ä»–è¢«æ”¾åœ¨<code>/home/acsc/su</code> ï¼Œæ¥ä¸‹ä¾†çŸ¥é“ä»–åœ¨å“ªä¹‹å¾Œå°±å¯ä»¥æŠŠå®ƒ Dump å‡ºä¾†</p>
<pre class="line-numbers language-none"><code class="language-none">python3 .\vol.py -f &quot;C:\Users\yunshiuan\Desktop\asac\chall.raw&quot; linux.pagecache.InodePages --find &#39;&#x2F;home&#x2F;acsc&#x2F;su&#39; --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/nnc7Yy8Nha7iSD1Uh0-fRgZvgeVceoPoDM0D_-idl1A=.png"></p>
<p>æˆåŠŸæŠŠ su dump å‡ºä¾†äº†ä¹‹å¾Œå°±å¯ä»¥ç›´æ¥é–‹ ida åˆ†æ</p>
<p>é–‹ ida ç„¶å¾Œé»ä¸€é»å°±å¯ä»¥ç™¼ç¾åˆ°ä¸€å€‹é…·é…·çš„åŠ å¯†å‡½å¼</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">unsigned __int64 sub_403175()
&#123;
  unsigned __int64 result; &#x2F;&#x2F; rax
  char v1; &#x2F;&#x2F; [rsp+0h] [rbp-240h]
  char v2; &#x2F;&#x2F; [rsp+0h] [rbp-240h]
  char v3; &#x2F;&#x2F; [rsp+0h] [rbp-240h]
  int i; &#x2F;&#x2F; [rsp+8h] [rbp-238h]
  signed int v5; &#x2F;&#x2F; [rsp+Ch] [rbp-234h]
  unsigned int v6; &#x2F;&#x2F; [rsp+10h] [rbp-230h]
  signed int v7; &#x2F;&#x2F; [rsp+14h] [rbp-22Ch]
  __int64 v8; &#x2F;&#x2F; [rsp+18h] [rbp-228h] BYREF
  unsigned __int64 j; &#x2F;&#x2F; [rsp+20h] [rbp-220h]
  unsigned __int64 k; &#x2F;&#x2F; [rsp+28h] [rbp-218h]
  __int64 v11; &#x2F;&#x2F; [rsp+30h] [rbp-210h]
  __int64 v12; &#x2F;&#x2F; [rsp+38h] [rbp-208h]
  __int64 v13; &#x2F;&#x2F; [rsp+40h] [rbp-200h]
  __int64 flag_content_len; &#x2F;&#x2F; [rsp+48h] [rbp-1F8h]
  __int64 flag_content; &#x2F;&#x2F; [rsp+50h] [rbp-1F0h]
  __int64 v16; &#x2F;&#x2F; [rsp+58h] [rbp-1E8h]
  __int64 v17; &#x2F;&#x2F; [rsp+60h] [rbp-1E0h]
  __int64 v18; &#x2F;&#x2F; [rsp+68h] [rbp-1D8h]
  char v19[48]; &#x2F;&#x2F; [rsp+70h] [rbp-1D0h] BYREF
  __int64 v20; &#x2F;&#x2F; [rsp+A0h] [rbp-1A0h]
  char v21[48]; &#x2F;&#x2F; [rsp+100h] [rbp-140h] BYREF
  unsigned __int64 v22; &#x2F;&#x2F; [rsp+130h] [rbp-110h]
  char v23[16]; &#x2F;&#x2F; [rsp+190h] [rbp-B0h] BYREF
  char flag_filename[16]; &#x2F;&#x2F; [rsp+1A0h] [rbp-A0h] BYREF
  char filename[32]; &#x2F;&#x2F; [rsp+1B0h] [rbp-90h] BYREF
  char v26[32]; &#x2F;&#x2F; [rsp+1D0h] [rbp-70h] BYREF
  char v27[32]; &#x2F;&#x2F; [rsp+1F0h] [rbp-50h] BYREF
  char v28[40]; &#x2F;&#x2F; [rsp+210h] [rbp-30h] BYREF
  unsigned __int64 v29; &#x2F;&#x2F; [rsp+238h] [rbp-8h]

  v29 &#x3D; __readfsqword(0x28u);
  if ( (unsigned int)random_string(v23, 16LL) &#x3D;&#x3D; 1 )
  &#123;
    for ( i &#x3D; 0; i &lt;&#x3D; 15; ++i )
    &#123;
      v28[2 * i] &#x3D; *(_BYTE *)(qword_8E6110 + (((unsigned __int8)v23[i] &gt;&gt; 4) &amp; 0xF));
      v28[2 * i + 1] &#x3D; *(_BYTE *)(qword_8E6110 + (v23[i] &amp; 0xF));
    &#125;
    v28[32] &#x3D; 0;
    printf((__int64)&amp;unk_8EA6C0, 40LL, (__int64)&quot;AES_IV&#x3D;%s&quot;, v28);
    sub_6EF840(&amp;unk_8EA6C0);
    if ( (unsigned int)random_string(v26, 32LL) &#x3D;&#x3D; 1 )
    &#123;
      sub_403086(v26, v27, 32LL);
      xorenc(filename, &amp;debian_log_addr, 19LL);
      v11 &#x3D; sub_6FC8B0(filename, &quot;wb&quot;);
      if ( v11 )
      &#123;
        fwrite(v27, 1LL, 32LL, v11);
        fclose(v11);
        v5 &#x3D; open(filename, 0, v1);
        if ( v5 &gt;&#x3D; 0 )
        &#123;
          if ( !(unsigned int)sub_72C2D0((unsigned int)v5, v21) &amp;&amp; (__int64)v22 &gt; 0 )
          &#123;
            v12 &#x3D; mmap(0LL);
            if ( v12 !&#x3D; -1 )
            &#123;
              v13 &#x3D; v12;
              for ( j &#x3D; 0LL; j &lt; v22; j +&#x3D; 4096LL )
                ;
            &#125;
          &#125;
          close(v5);
        &#125;
        xorenc(flag_filename, &amp;unk_7C1068, 15LL);
        v6 &#x3D; open(flag_filename, 2, v2);
        if ( (v6 &amp; 0x80000000) &#x3D;&#x3D; 0 )
        &#123;
          if ( (unsigned int)sub_72C2D0(v6, v19) || (flag_content_len &#x3D; v20, (flag_content &#x3D; malloc(v20)) &#x3D;&#x3D; 0) )
          &#123;
            close(v6);
            goto LABEL_34;
          &#125;
          if ( read(v6, flag_content, flag_content_len) !&#x3D; flag_content_len )
          &#123;
            free(flag_content);
            close(v6);
            goto LABEL_34;
          &#125;
          v16 &#x3D; sub_402DEE(flag_content, flag_content_len, v26, v23, &amp;v8);
          free(flag_content);
          if ( v16 )
          &#123;
            if ( (unsigned int)sub_72CBA0(v6, 0LL) || sub_72C300(v6, 0LL, 0LL) &lt; 0 )
            &#123;
              free(v16);
              close(v6);
              goto LABEL_34;
            &#125;
            write(v6, v16, v8);
            free(v16);
            v7 &#x3D; open(flag_filename, 0, v3);
            if ( v7 &gt;&#x3D; 0 )
            &#123;
              if ( !(unsigned int)sub_72C2D0((unsigned int)v7, v21) &amp;&amp; (__int64)v22 &gt; 0 )
              &#123;
                v17 &#x3D; mmap(0LL);
                if ( v17 !&#x3D; -1 )
                &#123;
                  v18 &#x3D; v17;
                  for ( k &#x3D; 0LL; k &lt; v22; k +&#x3D; 4096LL )
                    ;
                &#125;
              &#125;
              close(v7);
            &#125;
          &#125;
          close(v6);
        &#125;
      &#125;
    &#125;
  &#125;
LABEL_34:
  result &#x3D; v29 - __readfsqword(0x28u);
  if ( result )
    sub_72F780();
  return result;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ†æä¸€ä¸‹ä»–çš„åŸ·è¡Œé‚è¼¯</p>
<ol>
<li>é¦–å…ˆä»–å…ˆå–äº†ä¸€å€‹16 bytes çš„éš¨æ©Ÿå­—ä¸²ï¼Œä¸¦ä¸”ç¶“éäº†<pre class="line-numbers language-c" data-language="c"><code class="language-c">for ( i &#x3D; 0; i &lt;&#x3D; 15; ++i )
&#123;
      v28[2 * i] &#x3D; *(_BYTE *)(qword_8E6110 + (((unsigned __int8)v23[i] &gt;&gt; 4) &amp; 0xF));
      v28[2 * i + 1] &#x3D; *(_BYTE *)(qword_8E6110 + (v23[i] &amp; 0xF));
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
é€™æ¨£çš„åŠ å¯†éå¾Œè¼¸å‡ºAES_IV&#x3D;XXXX</li>
<li>å†å–ä¸€å€‹ 32 bytes çš„éš¨æ©Ÿå­—ä¸²ï¼Œå°é€™å€‹å­—ä¸²åš<pre class="line-numbers language-c" data-language="c"><code class="language-c">char aAcsc2025[] &#x3D; &quot;acsc2025&quot;
unsigned __int64 __fastcall sub_403086(__int64 a1, __int64 a2, unsigned __int64 a3)
&#123;
  unsigned __int64 result; &#x2F;&#x2F; rax
  char v5; &#x2F;&#x2F; [rsp+1Ah] [rbp-Eh]
  unsigned __int64 i; &#x2F;&#x2F; [rsp+20h] [rbp-8h]

  for ( i &#x3D; 0LL; ; ++i )
  &#123;
    result &#x3D; i;
    if ( i &gt;&#x3D; a3 )
      break;
    v5 &#x3D; *(_BYTE *)(a1 + i) ^ aAcsc2025[i % 8];
    if ( ((7 * (_BYTE)i + 13) &amp; 1) &#x3D;&#x3D; 0 )
      sub_402D55();
    *(_BYTE *)(a2 + i) &#x3D; ((((unsigned __int8)i ^ 0x13) + v5) &lt;&lt; (8 - ((i &amp; 7) + 1))) | ((int)(unsigned __int8)((i ^ 0x13) + v5) &gt;&gt; ((i &amp; 7) + 1));
  &#125;
  return result;
&#125;


__int64 sub_402D55()
&#123;
  int v0; &#x2F;&#x2F; edx
  __int64 result; &#x2F;&#x2F; rax
  int v2; &#x2F;&#x2F; [rsp+0h] [rbp-8h]
  int i; &#x2F;&#x2F; [rsp+4h] [rbp-4h]

  v2 &#x3D; 305419896;
  for ( i &#x3D; 0; i &lt;&#x3D; 4; ++i )
  &#123;
    v0 &#x3D; i + 8 * v2;
    result &#x3D; v0 ^ (unsigned int)v2;
    v2 ^&#x3D; v0;
  &#125;
  return result;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
é€™æ¨£çš„åŠ å¯†ä¹‹å¾Œï¼ŒåŸ·è¡Œxorenc å°‡ç¡¬ç·¨ç¢¼é€²å»çš„å­—ä¸²èˆ‡key&#x3D; â€œacsc2025â€ XOR è§£å¯†å¾Œä»¥é€™å€‹è§£å¯†å¾Œçš„å­—ä¸²ç•¶ä½œè·¯å¾‘å°‡åŠ å¯†å¾Œéçš„éš¨æ©Ÿ32 bytes å¯«å…¥é€²å»</li>
<li>æœ€å¾Œå†ä½¿ç”¨xorenc è§£å¯†å¦ä¸€å€‹ç¡¬ç·¨ç¢¼çš„å­—ä¸²èˆ‡key&#x3D; â€œacsc2025â€ XOR è§£å¯†å¾Œï¼Œå°‡é€™å€‹è§£å¯†éå¾Œçš„è·¯å¾‘æª”æ¡ˆå…§å®¹å…ˆè®€å‡ºä¾†ä¸¦ä¸”é€²è¡ŒAES åŠ å¯†å¾Œå†å¯«å›å»ï¼Œè€ŒAES çš„key æ˜¯ä¹‹å‰å–çš„éš¨æ©Ÿ16 bytes çš„å­—ä¸²ï¼ŒIV å‰‡ä¹Ÿæ˜¯ä¹‹å‰å–çš„éš¨æ©Ÿ32 bytes çš„å­—ä¸²</li>
</ol>
<p>é‚£é€™æ¨£å°±å¯ä»¥æ•´ç†ç­‰ç­‰è§£å¯†çš„æ€è·¯</p>
<ul>
<li>å…ˆæŠŠ æœƒç¶“éXOR è§£å¯†çš„è·¯å¾‘å…ˆè§£å¯†å‡ºä¾†</li>
<li>å¾—çŸ¥ IV èˆ‡ KEY</li>
<li>æœ€å¾ŒAES è§£å¯†</li>
</ul>
<h2 id="XOR-è§£å¯†å­—ä¸²"><a href="#XOR-è§£å¯†å­—ä¸²" class="headerlink" title="XOR è§£å¯†å­—ä¸²"></a>XOR è§£å¯†å­—ä¸²</h2><p>é€™é‚Šé¦–å…ˆå…ˆå°‡ç¡¬ç·¨ç¢¼çš„å…©å€‹å­—ä¸²XORè§£å¯†ï¼Œé€™é‚Šç›´æ¥ä½¿ç”¨ Cyberchef<br>é¦–å…ˆå…ˆè™•ç†ç¬¬ä¸€å€‹ xor å­—ä¸²è§£å¯†</p>
<p><img src="/assets/6YFdqMps4SghJHZtqHII8pqmA2a4DIpymHRXSdpDpeM=.png"></p>
<p>ok çŸ¥é“äº†ä»–æœƒå°‡éš¨æ©Ÿ32 bytes å­—ä¸²æ”¾é€²<code>/var/log/debian.log</code>ä¸­</p>
<p>ç¾åœ¨è§£ç¬¬äºŒå€‹xorè§£å¯†å­—ä¸²</p>
<p><img src="/assets/OadaDHOPM3FdCsLs7aLbEZBEDUMViQN4NaN10ykdgMU=.png"></p>
<p>okï¼Œé€™é‚Šä¹Ÿå¾—çŸ¥é“ä»–æœƒå»<code>/home/acsc/flag</code>ä¸­å°‡è‡ªå®¹è®€å‡ºä¾†ä¸¦åŠ å¯†ä»–å†å¯«å›å»ã€‚</p>
<p>æœ‰äº†ä»¥ä¸Šè³‡è¨Šä¹‹å¾Œæ¥ä¸‹ä¾†è¦æ‹¿åˆ° IV èˆ‡ KEY</p>
<h2 id="IV"><a href="#IV" class="headerlink" title="IV"></a>IV</h2><p>åŠ å¯†éå¾Œçš„ IV æˆ‘å€‘å¯ä»¥çŸ¥é“ä»–æœƒè¼¸å‡ºåˆ°console ä¸Šï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥ç›´æ¥è©¦è©¦çœ‹strings é€™å€‹ linux è¨˜æ†¶é«”dump ä»–æŠŠå®ƒè¼¸å‡ºçš„AES_IV&#x3D;XXXæŠ“ä¸‹ä¾†</p>
<pre class="line-numbers language-none"><code class="language-none">strings &quot;C:\Users\yunshiuan\Desktop\asac\chall.raw&quot; | Select-String -Pattern &#39;AES_IV&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/ti0DtfblBAlFp2BZB5kNFIVuDG0i-7kypk8KC5YHA9k=.png"></p>
<p>æˆåŠŸæŠ“åˆ°å¾Œï¼Œæ¥ä¸‹ä¾†å¯«è§£å¯†è…³æœ¬ï¼Œé€™é‚Šè«‹AIä»£å¯«ï¼ŒæŠŠåŸæœ¬çš„éš¨æ©Ÿ16 bytes å­—ä¸²é‚„åŸ</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdlib.h&gt;

&#x2F;&#x2F; Hex character lookup table (assuming standard hex characters)
char hex_chars[] &#x3D; &quot;0123456789ABCDEF&quot;;

&#x2F;&#x2F; Function to decode hex string back to binary
void decode_hex_string(const char* hex_string, unsigned char* output, int length)
&#123;
    for (int i &#x3D; 0; i &lt; length; i++)
    &#123;
        &#x2F;&#x2F; Get high nibble (first hex character)
        char high_char &#x3D; hex_string[2 * i];
        &#x2F;&#x2F; Get low nibble (second hex character)
        char low_char &#x3D; hex_string[2 * i + 1];
        
        &#x2F;&#x2F; Convert hex characters to values
        int high_val &#x3D; 0, low_val &#x3D; 0;
        
        if (high_char &gt;&#x3D; &#39;0&#39; &amp;&amp; high_char &lt;&#x3D; &#39;9&#39;)
            high_val &#x3D; high_char - &#39;0&#39;;
        else if (high_char &gt;&#x3D; &#39;A&#39; &amp;&amp; high_char &lt;&#x3D; &#39;F&#39;)
            high_val &#x3D; high_char - &#39;A&#39; + 10;
        else if (high_char &gt;&#x3D; &#39;a&#39; &amp;&amp; high_char &lt;&#x3D; &#39;f&#39;)
            high_val &#x3D; high_char - &#39;a&#39; + 10;
            
        if (low_char &gt;&#x3D; &#39;0&#39; &amp;&amp; low_char &lt;&#x3D; &#39;9&#39;)
            low_val &#x3D; low_char - &#39;0&#39;;
        else if (low_char &gt;&#x3D; &#39;A&#39; &amp;&amp; low_char &lt;&#x3D; &#39;F&#39;)
            low_val &#x3D; low_char - &#39;A&#39; + 10;
        else if (low_char &gt;&#x3D; &#39;a&#39; &amp;&amp; low_char &lt;&#x3D; &#39;f&#39;)
            low_val &#x3D; low_char - &#39;a&#39; + 10;
        
        &#x2F;&#x2F; Combine high and low nibbles
        output[i] &#x3D; (high_val &lt;&lt; 4) | low_val;
    &#125;
&#125;

&#x2F;&#x2F; Function to encode binary to hex string (original encoding function)
void encode_hex_string(const unsigned char* input, char* output, int length)
&#123;
    for (int i &#x3D; 0; i &lt; length; i++)
    &#123;
        output[2 * i] &#x3D; hex_chars[(input[i] &gt;&gt; 4) &amp; 0xF];
        output[2 * i + 1] &#x3D; hex_chars[input[i] &amp; 0xF];
    &#125;
    output[2 * length] &#x3D; &#39;\0&#39;;
&#125;

int main()
&#123;
    &#x2F;&#x2F; Given hex string
    const char* hex_string &#x3D; &quot;33F27DE365AB35FFC29CB4FEEB506B34&quot;;
    int hex_length &#x3D; strlen(hex_string);
    int binary_length &#x3D; hex_length &#x2F; 2;
    
    printf(&quot;&#x3D;&#x3D;&#x3D; Hex Decoder &#x3D;&#x3D;&#x3D;\n\n&quot;);
    printf(&quot;Input hex string: %s\n&quot;, hex_string);
    printf(&quot;Hex string length: %d\n&quot;, hex_length);
    printf(&quot;Expected binary length: %d bytes\n\n&quot;, binary_length);
    
    &#x2F;&#x2F; Allocate buffer for decoded data
    unsigned char* decoded_data &#x3D; malloc(binary_length);
    if (!decoded_data) &#123;
        printf(&quot;Error: Memory allocation failed\n&quot;);
        return 1;
    &#125;
    
    &#x2F;&#x2F; Decode hex string to binary
    decode_hex_string(hex_string, decoded_data, binary_length);
    
    &#x2F;&#x2F; Print decoded data as hex
    printf(&quot;Decoded binary data (hex): &quot;);
    for (int i &#x3D; 0; i &lt; binary_length; i++) &#123;
        printf(&quot;%02X&quot;, decoded_data[i]);
    &#125;
    printf(&quot;\n\n&quot;);
    
    &#x2F;&#x2F; Print decoded data with spaces for readability
    printf(&quot;Decoded binary data (hex with spaces): &quot;);
    for (int i &#x3D; 0; i &lt; binary_length; i++) &#123;
        printf(&quot;%02X &quot;, decoded_data[i]);
    &#125;
    printf(&quot;\n\n&quot;);
    
    &#x2F;&#x2F; Print decoded data as bytes
    printf(&quot;Decoded binary data (bytes): &quot;);
    for (int i &#x3D; 0; i &lt; binary_length; i++) &#123;
        printf(&quot;%d &quot;, decoded_data[i]);
    &#125;
    printf(&quot;\n\n&quot;);
    
    &#x2F;&#x2F; Verify by re-encoding
    char* reencoded &#x3D; malloc(hex_length + 1);
    if (reencoded) &#123;
        encode_hex_string(decoded_data, reencoded, binary_length);
        printf(&quot;Re-encoded verification: %s\n&quot;, reencoded);
        if (strcmp(hex_string, reencoded) &#x3D;&#x3D; 0) &#123;
            printf(&quot;âœ“ SUCCESS: Re-encoding matches original!\n&quot;);
        &#125; else &#123;
            printf(&quot;âœ— FAILED: Re-encoding does not match original!\n&quot;);
        &#125;
        free(reencoded);
    &#125;
    
    free(decoded_data);
    
    return 0;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¼¸å‡ºç‚º</p>
<pre class="line-numbers language-none"><code class="language-none">&#x3D;&#x3D;&#x3D; Hex Decoder &#x3D;&#x3D;&#x3D;

Input hex string: 33F27DE365AB35FFC29CB4FEEB506B34
Hex string length: 32
Expected binary length: 16 bytes

Decoded binary data (hex): 33F27DE365AB35FFC29CB4FEEB506B34

Decoded binary data (hex with spaces): 33 F2 7D E3 65 AB 35 FF C2 9C B4 FE EB 50 6B 34 

Decoded binary data (bytes): 51 242 125 227 101 171 53 255 194 156 180 254 235 80 107 52 

Re-encoded verification: 33F27DE365AB35FFC29CB4FEEB506B34
âœ“ SUCCESS: Re-encoding matches original!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¾—çŸ¥åˆ°IV &#x3D; <code>33F27DE365AB35FFC29CB4FEEB506B34</code></p>
<h2 id="KEY"><a href="#KEY" class="headerlink" title="KEY"></a>KEY</h2><p>é‚£ä¹‹å‰çš„è³‡è¨Šå¯ä»¥çŸ¥é“ä»–æœƒå¯«åœ¨<code>/var/log/debian.log</code>ä¸­ï¼Œå› æ­¤æˆ‘å€‘ç›´æ¥æŠŠä»–å¾è¨˜æ†¶é«”dump å‡ºä¾†</p>
<pre class="line-numbers language-none"><code class="language-none">python3 .\vol.py -f &quot;C:\Users\yunshiuan\Desktop\asac\chall.raw&quot; linux.pagecache.InodePages --find &#39;&#x2F;var&#x2F;log&#x2F;debian.log&#39; --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/kc7lICbpxTD3HkLsMYHde6cEmfN5xWXxQCsNO75YkBo=.png"></p>
<p>æˆåŠŸdump ä¹‹å¾Œç›´å¾Œå°±å¯ä»¥å¯«è§£å¯†é‚„åŸkeyï¼Œé€™é‚Šä¸€æ¨£AIä»£å¯«è§£å¯†è…³æœ¬</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdlib.h&gt;

&#x2F;&#x2F; The key used in encryption
char aAcsc2025[] &#x3D; &quot;acsc2025&quot;;

&#x2F;&#x2F; Decoy function (same as in encryption)
int64_t sub_402D55()
&#123;
    int v0; &#x2F;&#x2F; edx
    int64_t result; &#x2F;&#x2F; rax
    int v2; &#x2F;&#x2F; [rsp+0h] [rbp-8h]
    int i; &#x2F;&#x2F; [rsp+4h] [rbp-4h]

    v2 &#x3D; 305419896;
    for (i &#x3D; 0; i &lt;&#x3D; 4; ++i)
    &#123;
        v0 &#x3D; i + 8 * v2;
        result &#x3D; v0 ^ (unsigned int)v2;
        v2 ^&#x3D; v0;
    &#125;
    return result;
&#125;

&#x2F;&#x2F; Decryption function
uint64_t decrypt_data(int64_t encrypted_data, int64_t output_buffer, uint64_t length)
&#123;
    uint64_t result; &#x2F;&#x2F; rax
    char v5; &#x2F;&#x2F; [rsp+1Ah] [rbp-Eh]
    uint64_t i; &#x2F;&#x2F; [rsp+20h] [rbp-8h]

    for (i &#x3D; 0LL; ; ++i)
    &#123;
        result &#x3D; i;
        if (i &gt;&#x3D; length)
            break;
            
        &#x2F;&#x2F; Get the encrypted byte
        unsigned char encrypted_byte &#x3D; *(uint8_t *)(encrypted_data + i);
        
        &#x2F;&#x2F; Calculate rotation amount (same as encryption)
        int rotation_amount &#x3D; (i &amp; 7) + 1;
        
        &#x2F;&#x2F; Reverse the bit rotation
        &#x2F;&#x2F; Original: rotated &#x3D; (value &lt;&lt; (8 - rotation)) | (value &gt;&gt; rotation)
        &#x2F;&#x2F; Reverse: value &#x3D; (rotated &gt;&gt; (8 - rotation)) | (rotated &lt;&lt; rotation)
        unsigned char rotated_value &#x3D; (encrypted_byte &gt;&gt; (8 - rotation_amount)) | 
                                     (encrypted_byte &lt;&lt; rotation_amount);
        
        &#x2F;&#x2F; Extract v5: v5 &#x3D; rotated_value - (i ^ 0x13)
        v5 &#x3D; rotated_value - (i ^ 0x13);
        
        &#x2F;&#x2F; Call the decoy function if the same condition is met
        if (((7 * (uint8_t)i + 13) &amp; 1) &#x3D;&#x3D; 0)
            sub_402D55();
            
        &#x2F;&#x2F; Reverse the XOR with the key
        *(uint8_t *)(output_buffer + i) &#x3D; v5 ^ aAcsc2025[i % 8];
    &#125;
    return result;
&#125;

int main(int argc, char *argv[])
&#123;
    if (argc !&#x3D; 2) &#123;
        printf(&quot;Usage: %s &lt;encrypted_file&gt;\n&quot;, argv[0]);
        return 1;
    &#125;
    
    FILE *file &#x3D; fopen(argv[1], &quot;rb&quot;);
    if (!file) &#123;
        printf(&quot;Error: Cannot open file %s\n&quot;, argv[1]);
        return 1;
    &#125;
    
    &#x2F;&#x2F; Get file size
    fseek(file, 0, SEEK_END);
    long file_size &#x3D; ftell(file);
    fseek(file, 0, SEEK_SET);
    
    printf(&quot;File size: %ld bytes\n&quot;, file_size);
    
    &#x2F;&#x2F; Read encrypted data
    unsigned char *encrypted_data &#x3D; malloc(file_size);
    if (!encrypted_data) &#123;
        printf(&quot;Error: Memory allocation failed\n&quot;);
        fclose(file);
        return 1;
    &#125;
    
    size_t bytes_read &#x3D; fread(encrypted_data, 1, file_size, file);
    fclose(file);
    
    if (bytes_read !&#x3D; file_size) &#123;
        printf(&quot;Error: Could not read entire file\n&quot;);
        free(encrypted_data);
        return 1;
    &#125;
    
    &#x2F;&#x2F; Print encrypted data as hex
    printf(&quot;Encrypted data (hex): &quot;);
    for (int i &#x3D; 0; i &lt; file_size &amp;&amp; i &lt; 50; i++) &#123; &#x2F;&#x2F; Show first 50 bytes
        printf(&quot;%02x &quot;, encrypted_data[i]);
    &#125;
    if (file_size &gt; 50) printf(&quot;...&quot;);
    printf(&quot;\n&quot;);
    
    &#x2F;&#x2F; Allocate buffer for decrypted data
    unsigned char *decrypted_data &#x3D; malloc(file_size + 1);
    if (!decrypted_data) &#123;
        printf(&quot;Error: Memory allocation failed\n&quot;);
        free(encrypted_data);
        return 1;
    &#125;
    
    &#x2F;&#x2F; Decrypt
    decrypt_data((int64_t)encrypted_data, (int64_t)decrypted_data, file_size);
    decrypted_data[file_size] &#x3D; &#39;\0&#39;;
    
    &#x2F;&#x2F; Print decrypted data
    printf(&quot;\nDecrypted data:\n&quot;);
    printf(&quot;As hex (continuous): &quot;);
    for (int i &#x3D; 0; i &lt; file_size; i++) &#123;
        printf(&quot;%02X&quot;, decrypted_data[i]);
    &#125;
    printf(&quot;\n\n&quot;);
    
    printf(&quot;As hex (with spaces): &quot;);
    for (int i &#x3D; 0; i &lt; file_size; i++) &#123;
        printf(&quot;%02X &quot;, decrypted_data[i]);
    &#125;
    printf(&quot;\n\n&quot;);
    
    printf(&quot;As text (if printable): &quot;);
    for (int i &#x3D; 0; i &lt; file_size; i++) &#123;
        if (decrypted_data[i] &gt;&#x3D; 32 &amp;&amp; decrypted_data[i] &lt;&#x3D; 126) &#123;
            printf(&quot;%c&quot;, decrypted_data[i]);
        &#125; else &#123;
            printf(&quot;\\x%02X&quot;, decrypted_data[i]);
        &#125;
    &#125;
    printf(&quot;\n&quot;);
    
    &#x2F;&#x2F; Try to save decrypted data to a file
    char output_filename[256];
    snprintf(output_filename, sizeof(output_filename), &quot;%s.decrypted&quot;, argv[1]);
    
    FILE *output_file &#x3D; fopen(output_filename, &quot;wb&quot;);
    if (output_file) &#123;
        fwrite(decrypted_data, 1, file_size, output_file);
        fclose(output_file);
        printf(&quot;\nDecrypted data saved to: %s\n&quot;, output_filename);
    &#125;
    
    free(encrypted_data);
    free(decrypted_data);
    
    return 0;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¼¸å‡º</p>
<pre class="line-numbers language-none"><code class="language-none">File size: 32 bytes
Encrypted data (hex): 5a 47 47 78 19 cc 3e a3 26 58 2a 14 33 a0 40 d0 b6 c8 d0 e4 0b a3 d1 ea f5 df 65 83 0f 04 9f 36 

Decrypted data:
As hex (continuous): C0685A143E2D38BA50244B4A753A31810B42F62D68D2D1D381165153E0C3F01F

As hex (with spaces): C0 68 5A 14 3E 2D 38 BA 50 24 4B 4A 75 3A 31 81 0B 42 F6 2D 68 D2 D1 D3 81 16 51 53 E0 C3 F0 1F 

As text (if printable): \xC0hZ\x14&gt;-8\xBAP$KJu:1\x81\x0BB\xF6-h\xD2\xD1\xD3\x81\x16QS\xE0\xC3\xF0\x1F

Decrypted data saved to: inode_0x8a6161fc0a78.dmp.decrypted<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¾—çŸ¥åˆ°KEY &#x3D; <code>C0685A143E2D38BA50244B4A753A31810B42F62D68D2D1D381165153E0C3F01F</code></p>
<h2 id="è§£å¯†flag"><a href="#è§£å¯†flag" class="headerlink" title="è§£å¯†flag"></a>è§£å¯†flag</h2><p>çŸ¥é“äº†keyè·ŸIVä¹‹å¾Œï¼Œå°±å¯å°‡flagæª”æ¡ˆdump å‡ºä¾†ä¸¦é€²è¡Œè§£å¯†ï¼Œé€™é‚ŠAESè§£å¯†ä¹Ÿæ˜¯äº¤çµ¦Cyberchef</p>
<pre class="line-numbers language-none"><code class="language-none">C:\Users\yunshiuan\Desktop\Tools\volatility3 &gt; python3 .\vol.py -f &quot;C:\Users\yunshiuan\Desktop\asac\chall.raw&quot; linux.pagecache.InodePages --find &#39;&#x2F;home&#x2F;acsc&#x2F;flag&#39; --dump<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/-PZ5CPQtGkp0zqAPN7bfUTUVg39PT-Tj0fcnppIV0vg=.png"></p>
<p><img src="/assets/163DjJ9EGoUgMQqn_098gKO1OmfSzY686rKvl6Bg_Dc=.png"></p>
<p>flagè·‘å‡ºä¾†ä»£è¡¨æˆåŠŸè§£å‡ºé€™é¡Œäº†ï¼</p>
<h1 id="ç¸½çµ"><a href="#ç¸½çµ" class="headerlink" title="ç¸½çµ"></a>ç¸½çµ</h1><p>æˆ‘è¦ºå¾—é€™é¡Œæ˜¯æŒºä¸éŒ¯çš„ï¼ŒåŒ…å«äº†Linux Memory Forensic ä»¥åŠé€†å‘çš„èƒ½åŠ›ï¼Œè³½ä¸­è§£å‡ºé€™é¡Œçš„æˆå°±æ„ŸæŒºå¤§çš„ï¼Œç¢ºå¯¦å¦‚æœæˆ‘ä¹‹å‰æ²’æœ‰æ¥è§¸é Linux è¨˜æ†¶é«”åˆ†æçš„è©±å¯èƒ½å°±æœƒå…ˆè€—åœ¨è™•ç†éŒ¯èª¤çš„åœ°æ–¹ä¸€æ®µæ™‚é–“ã€‚</p>
</div></article></div></main><footer><div class="paginator"><a href="/2025/10/11/BossOfSOC/" class="prev">PREV</a><a href="/2025/08/14/2025AIS3PreExam-reverse/" class="next">NEXT</a></div><div class="copyright"><p>Â© 2025 - 2026 <a href="https://yunshiuan.com">yunshiuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-clike.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cpp.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
</script><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>