<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Config ä¸é¤Šå®ƒå€‘ï¼ŒAmcache è·Ÿ NTUSER.DAT è‡ªå·±é–‹å°ç¶ Â· yunshiuan</title><meta name="description" content="Config ä¸é¤Šå®ƒå€‘ï¼ŒAmcache è·Ÿ NTUSER.DAT è‡ªå·±é–‹å°ç¶ - yunshiuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/assets/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yunshiuan.com/atom.xml" title="yunshiuan"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="yunshiuan" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/assets/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="https://github.com/YunshiuanOAO" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/assets/CV.pdf" target="_self" class="nav-list-link">CV</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Config ä¸é¤Šå®ƒå€‘ï¼ŒAmcache è·Ÿ NTUSER.DAT è‡ªå·±é–‹å°ç¶</h1><div class="post-info">Oct 4, 2025</div><div class="post-content"><h1 id="ğŸ§‚-å‰è¨€"><a href="#ğŸ§‚-å‰è¨€" class="headerlink" title="ğŸ§‚ å‰è¨€"></a>ğŸ§‚ å‰è¨€</h1><p>ä»Šå¤©æœƒåˆ†äº«æ²’æœ‰æ”¾åœ¨ <code>%WinDir%\System32\Config</code>ï¼Œä½†æ˜¯å¾ˆå€¼å¾—å»æŸ¥çœ‹çš„å…¶ä»–å…©å€‹ hiveï¼Œåˆ†åˆ¥æ˜¯ Amcache.hveã€NTUSER.DATã€‚</p>
<hr>
<h1 id="Amcache-hve"><a href="#Amcache-hve" class="headerlink" title="Amcache.hve"></a>Amcache.hve</h1><p>è·¯å¾‘ä½ç½®ï¼š<code>%WinDir%\AppCompat\Programs\Amcache.hve</code></p>
<p><img src="/assets/Ybc_QgFK9UsOKi7pW8blJhLBDXDmoh5zkDgOjPsqhkw=.png"></p>
<p>è‡ª Windows 8 èµ·å¼•å…¥ï¼Œè¨˜éŒ„äº†å·²åŸ·è¡Œæ‡‰ç”¨ç¨‹å¼çš„è©³ç´°è³‡è¨Šï¼ŒåŒ…æ‹¬æª”æ¡ˆè·¯å¾‘ã€SHA-1 é›œæ¹Šå€¼ã€æ™‚é–“æˆ³è¨˜ç­‰ã€‚</p>
<p><strong>è‹¥æƒ¡æ„ç¨‹å¼æœ¬é«”è¢«åˆªé™¤æˆ–é­æ¸…é™¤ï¼Œç„¡æ³•å¾æ˜ åƒç›´æ¥çœ‹åˆ°è©²æª”æ¡ˆæœ¬èº«æ™‚</strong>ï¼Œå¯ä»¥é€é Amcache çš„è¨˜éŒ„å»é©—è­‰è©²ç¨‹å¼æ›¾ç¶“è¢«åŸ·è¡Œé</p>
<p>å¯ä»¥å…ˆä½¿ç”¨ <a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">RegistryExplorer </a> åˆä½µ Transport logs å¾Œç›´æ¥æŸ¥çœ‹æˆ–è€…ä½¿ç”¨ Eric Zimmermanâ€™s tools ä¸­çš„ AmcacheParser è½‰æˆ CSV æª”</p>
<p><img src="/assets/OZlv8y4NKybwgKVheToBnYUFk2xmh7wPekUkky8pRuQ=.png"></p>
<h2 id="AmcacheParser"><a href="#AmcacheParser" class="headerlink" title="AmcacheParser"></a>AmcacheParser</h2><p>AmcacheParser æ˜¯ç”±æ•¸ä½é‘‘è­˜å°ˆå®¶ Eric Zimmerman æ‰€é–‹ç™¼çš„ä¸€æ¬¾å‘½ä»¤åˆ—å·¥å…·ï¼Œå°ˆé–€ç”¨æ–¼è§£æ Windows ç³»çµ±ä¸­çš„ Amcache.hve è¨»å†Šæª”ï¼Œæ”¯æ´å°‡è§£æçµæœè¼¸å‡ºç‚º CSV æ ¼å¼ï¼Œæ–¹ä¾¿å¾ŒçºŒåˆ†æèˆ‡è™•ç†</p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell">PS C:\Users\yunshiuan\Desktop\net9 &gt; .\AmcacheParser.exe -f C:\Users\yunshiuan\Desktop\Amcache.hve_clean --csv C:\Users\yunshiuan\Desktop
AmcacheParser version 1.5.2.0

Author: Eric Zimmerman (saericzimmerman@gmail.com)
https:&#x2F;&#x2F;github.com&#x2F;EricZimmerman&#x2F;AmcacheParser

Command line: -f C:\Users\yunshiuan\Desktop\Amcache.hve_clean --csv C:\Users\yunshiuan\Desktop

Warning: Administrator privileges not found!

Unknown value name when processing DevicePnp at path &#123;11517B7C-E79D-4e20-961B-75A811715ADD&#125;\Root\InventoryDevicePnp\display&#x2F;default_monitor&#x2F;1&amp;1f0c3c2f&amp;0&amp;uid256: ManifestPath

C:\Users\yunshiuan\Desktop\Amcache.hve_clean is in new format!

Total file entries found: 240
Total shortcuts found: 51
Total device containers found: 13
Total device PnPs found: 94
Total drive binaries found: 373
Total driver packages found: 4

Found 123 unassociated file entry

Results saved to: C:\Users\yunshiuan\Desktop

Total parsing time: 0.909 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒçš„è¼¸å‡ºæœƒæœ‰å¾ˆå¤š CSV æª”ï¼Œå¯èƒ½æœƒå‡ºç¾ä¸‹é¢æª”æ¡ˆ</p>
<table>
<thead>
<tr>
<th><strong>Amcache_ProgramEntries.csv</strong></th>
<th>ç¨‹å¼æ¢ç›®ï¼ˆPrograms Entryï¼‰</th>
<th>æè¿°è¨»å†Šåœ¨ Amcache â€œProgramsâ€ åˆ†æ”¯ä¸‹çš„æ‡‰ç”¨ç¨‹å¼è³‡è¨Šï¼Œå¦‚å®‰è£è³‡è¨Šæˆ–è¨»å†Šçš„ç¨‹å¼æ¢ç›®ã€‚</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Amcache_AssociatedFileEntries.csv</strong></td>
<td>é—œè¯çš„æª”æ¡ˆæ¢ç›®</td>
<td>æŒ‡é‚£äº›èƒ½å¤ è¢«å°æ‡‰ï¼ˆæˆ–é—œè¯ï¼‰åˆ°ç¨‹å¼æ¢ç›®çš„æª”æ¡ˆæ¢ç›®ï¼ˆFile entriesï¼‰ã€‚å³é‚£äº›è¢«å®‰è£ç¨‹å¼æ‰€æ“æœ‰æˆ–ç®¡ç†çš„æª”æ¡ˆã€‚</td>
</tr>
<tr>
<td><strong>Amcache_UnassociatedFileEntries.csv</strong></td>
<td>ç„¡é—œè¯çš„æª”æ¡ˆæ¢ç›®</td>
<td>æŒ‡é‚£äº›æ²’æœ‰è¢«é—œè¯åˆ°ä»»ä½•ç¨‹å¼æ¢ç›®çš„æª”æ¡ˆæ¢ç›®ï¼Œä¹Ÿå°±æ˜¯é‚£äº›å­¤ç«‹çš„å¯åŸ·è¡Œæª” &#x2F; æª”æ¡ˆã€‚é€™æ˜¯å¾ˆå¤šèª¿æŸ¥ä¸­é‡é»æŸ¥çœ‹çš„éƒ¨åˆ†ï¼Œå› ç‚ºå¯èƒ½æ˜¯æƒ¡æ„å·¥å…·æˆ–ç¨ç«‹åŸ·è¡Œæª”ã€‚</td>
</tr>
<tr>
<td><strong>Amcache_Shortcuts.csv</strong></td>
<td>å¿«æ·æ–¹å¼ &#x2F; é€£çµè³‡è¨Š</td>
<td>æè¿°ç³»çµ±æˆ–æ‡‰ç”¨ç¨‹å¼æ·å¾‘ï¼ˆ.lnk æˆ–é¡ä¼¼é€£çµï¼‰ç›¸é—œçš„è³‡è¨Šï¼Œä¾‹å¦‚å¿«æ·ç›®æ¨™ã€è·¯å¾‘ç­‰ã€‚</td>
</tr>
<tr>
<td><strong>Amcache_DeviceContainers.csv</strong></td>
<td>è£ç½®å®¹å™¨ (Device Container)</td>
<td>èˆ‡è£ç½®ï¼ˆä¾‹å¦‚ USB è£ç½®ã€ç¡¬é«”è£ç½®ï¼‰æˆ–å…¶å®¹å™¨æœ‰é—œçš„æ¢ç›®ã€‚</td>
</tr>
<tr>
<td><strong>Amcache_DevicePnps.csv</strong></td>
<td>è£ç½® PnP æ¢ç›® (Plug-and-Play è£ç½®)</td>
<td>æè¿°æ’æ‹”è£ç½® (PnP è£ç½®) çš„è³‡è¨Šï¼Œä¾‹å¦‚ç¡¬é«” IDã€è£ç½®åç¨±ã€ç›¸é—œæ™‚é–“ç­‰ã€‚</td>
</tr>
<tr>
<td><strong>Amcache_DriveBinaries.csv</strong></td>
<td>é©…å‹•ç¨‹å¼äºŒé€²ä½æª”</td>
<td>æ¶‰åŠé©…å‹•ç¨‹å¼ï¼ˆdriver binariesï¼‰æˆ–åœ¨ç£ç¢Ÿä¸Šå¯åŸ·è¡Œä½†å±¬é©…å‹•ç¨‹å¼ç¯„ç–‡çš„æ¢ç›®ã€‚</td>
</tr>
<tr>
<td><strong>Amcache_DriverPackages.csv</strong></td>
<td>é©…å‹•å¥—ä»¶ (Driver Packages)</td>
<td>é—œæ–¼é©…å‹•ç¨‹å¼å¥—ä»¶å®‰è£ã€é©…å‹•å¥—ä»¶ç‰ˆæœ¬ã€å°è£è³‡è¨Šç­‰ã€‚</td>
</tr>
</tbody></table>
<p>æ¥ä¸‹ä¾†å°±å¯ä»¥ç”¨ <a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">Timeline Explorer</a> æˆ–è€…å…¶ä»–å¯ä»¥æŸ¥çœ‹ CSV æª”çš„ç¨‹å¼æŸ¥çœ‹å…§å®¹</p>
<p><img src="/assets/mPcDCME75qRv_jdBbz7s7O_MXQtHhoV6h36PvLThoFc=.png"></p>
<p>å‡è¨­æƒ³è¦çŸ¥é“ notepad.exe çš„å¯¦éš›è·¯å¾‘ä»¥åŠå®ƒçš„ SHA-1 å€¼ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ­¥é©Ÿä¸¦åœ¨ <code>&lt;XXX_UnassociatedFileEntries.csv&gt;</code> æœå°‹ notepad.exe</p>
<p><img src="/assets/x-tZ0wFWbbmTkDMDwjC0KcLnXum2pc_9t6A4oT2z3Bg=.png"></p>
<p>å¯ä»¥é¦¬ä¸Šå°±çœ‹åˆ°ç›¸é—œè³‡è¨Š</p>
<hr>
<h1 id="NTUSER-DAT"><a href="#NTUSER-DAT" class="headerlink" title="NTUSER.DAT"></a>NTUSER.DAT</h1><p>è·¯å¾‘ä½ç½®ï¼š<code>C:\Users\&lt;username&gt;\NTUSER.DAT</code></p>
<p><img src="/assets/HbBDSu1lraXx3pIgsNxHGOqZHdhNnyuWDrcCEMR8-1A=.png"></p>
<p>NTUSER.DAT æ˜¯ Windows æ¯å€‹ä½¿ç”¨è€…å¸³æˆ¶åœ¨å…¶ä½¿ç”¨è€…è¨­å®šæª”åº•ä¸‹çš„ä¸€å€‹æª”æ¡ˆï¼Œç”¨ä¾†å„²å­˜èˆ‡è©²å¸³æˆ¶ç›¸é—œçš„ Registry è¨­å®šèˆ‡ä½¿ç”¨è€…åå¥½ï¼Œåœ¨ä½¿ç”¨è€…ç™»å…¥æ™‚ï¼Œç³»çµ±æœƒå°‡é€™å€‹æª”æ¡ˆå°æ‡‰åˆ°è¨»å†Šè¡¨çš„ HKEY_CURRENT_USERï¼ˆHKCUï¼‰ åˆ†æ”¯ï¼Œè®“è©²ä½¿ç”¨è€…çš„ä½œæ¥­èˆ‡æ‡‰ç”¨ç¨‹å¼å¯ä»¥è®€å¯«å…¶å€‹äººè¨­å®šï¼›åœ¨ç™»å‡ºæˆ–é—œæ©Ÿæ™‚ï¼Œé€™äº›è®Šæ›´æœƒå›å¯«åˆ° NTUSER.DATã€‚</p>
<p>å¯ä»¥ç›´æ¥ç”¨ <a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">RegistryExplorer</a> æŸ¥çœ‹ã€‚</p>
<p><img src="/assets/RIvMLfCdh5rrb81bTPyBEaPuSO1d-zFoxpUOjAMwYo8=.png"></p>
<p>é€™é‚Šé‡é»æå…©å€‹æ¯”è¼ƒç‰¹åˆ¥çš„ key</p>
<h2 id="UserAssist"><a href="#UserAssist" class="headerlink" title="UserAssist"></a>UserAssist</h2><p>key è·¯å¾‘ï¼š<code>Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\&#123;GUID&#125;\Count</code></p>
<p>UserAssist æ˜¯ Windows ç”¨ä¾†è¿½è¹¤ä½¿ç”¨è€…é€éåœ–å½¢ä»‹é¢å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼æˆ–æ·å¾‘çš„çµ±è¨ˆè¨˜éŒ„æ©Ÿåˆ¶ï¼Œè£¡é¢æœƒåŒ…å«ç¨‹å¼çš„åŸ·è¡Œæ¬¡æ•¸ã€æœ€å¾ŒåŸ·è¡Œæ™‚é–“ã€<strong>Focus Countã€Focus Time</strong></p>
<p><img src="/assets/EX1XBHpXaNJ2rj-3d0M_GUZyaVjDpWQwmaKNE1NvYuY=.png"></p>
<hr>
<h2 id="ShellBags"><a href="#ShellBags" class="headerlink" title="ShellBags"></a>ShellBags</h2><p>ShellBags æ˜¯ Windows ç”¨æ–¼è¨˜éŒ„ä½¿ç”¨è€…åœ¨æª”æ¡ˆç¸½ç®¡ä¸­ç€è¦½<strong>è³‡æ–™å¤¾</strong>æ™‚çš„è¨­å®šåå¥½èˆ‡æª”æ¡ˆå¤¾è¨ªå•ç´€éŒ„ï¼ŒåŒ…æ‹¬è³‡æ–™å¤¾çš„è¦–çª—é…ç½® &#x2F; æª¢è¦–æ¨£å¼ &#x2F; æ’åˆ—æ–¹å¼ &#x2F; å¤§å° &#x2F; ä½ç½®ç­‰ï¼Œä»£è¡¨å¦‚æœ‰åˆªé™¤æˆ–å­˜å–è³‡æ–™å¤¾çš„æ“ä½œæœƒè¢«è¨˜éŒ„åœ¨ ShellBags ç•¶ä¸­ã€‚</p>
<p>å®ƒæœƒä¾ç…§ä½œæ¥­ç³»çµ±å­˜åœ¨ä¸åŒåœ°æ–¹</p>
<ul>
<li><code>&lt;NTUSER.DAT&gt;\Software\Microsoft\Windows\Shell\BagMRU </code></li>
<li><code>&lt;NTUSER.DAT&gt;\Software\Microsoft\Windows\Shell\Bags</code></li>
<li>åœ¨è¼ƒæ–° Windows ç‰ˆæœ¬ï¼ˆå¦‚ Windows 7 ä¹‹å¾Œï¼‰ï¼Œéƒ¨åˆ† ShellBags è³‡æ–™æœƒå­˜æ–¼ <code>C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows\UsrClass.dat</code></li>
<li>åœ¨æŸäº› Windows ç‰ˆæœ¬æˆ–ä½¿ç”¨è€…è¨­å®šä¸­ï¼Œéƒ¨åˆ† ShellBags æ¢ç›®åªå­˜åœ¨æ–¼ UsrClass.dat è€Œé NTUSER.DAT</li>
</ul>
<p><img src="/assets/pnKEJ4vqw21ZBolGw34xhCg7XGai0iP7POjOr8NtI2I=.png"></p>
<p>å¦‚æœç›´æ¥ä½¿ç”¨ RegistryExplorer æœƒå¾ˆé›£é–±è®€ï¼Œå»ºè­°ä½¿ç”¨ Eric Zimmermanâ€™s tools ä¸­çš„ ShellBags Explorer æŸ¥çœ‹</p>
<h3 id="ShellBags-Explorer"><a href="#ShellBags-Explorer" class="headerlink" title="ShellBags Explorer"></a>ShellBags Explorer</h3><p>ä¸‹è¼‰é€£çµï¼š<a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">https://ericzimmerman.github.io/#!index.md</a></p>
<p>ShellBags Explorer æ˜¯ç”± Eric Zimmerman æ‰€é–‹ç™¼çš„ä¸€æ¬¾å°ˆé–€ç”¨ä¾†ç€è¦½èˆ‡è§£æ Windows ShellBags è³‡æ–™çš„å·¥å…·ï¼Œå°‡ BagMRU &#x2F; Bags çš„è¨»å†Šè¡¨è³‡æ–™è§£æç‚ºè³‡æ–™å¤¾å±¤ç´šæ¨¹ç‹€è¦–åœ–ï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨è€…æ›¾ç€è¦½éå“ªäº›è³‡æ–™å¤¾</p>
<p>å®ƒçš„ä»‹é¢è·Ÿ RegistryExplorer å·®ä¸å¤šï¼Œä¸€æ¨£éœ€è¦åŒ¯å…¥ hiveï¼Œçœ‹ä½œæ¥­ç³»çµ±ç‰ˆæœ¬åŒ¯å…¥ <code>NTUSER.DAT</code> æˆ–è€… <code>UsrClass.dat</code></p>
<p><img src="/assets/MvUItWpVpa5jnJsYBxUDs0mF7EWLYanjudpkwnoJOs8=.png"></p>
<p>åŒ¯å…¥å¾Œå°±å¯ä»¥çœ‹åˆ° ShellBags è³‡è¨Š</p>
<p><img src="/assets/wVsOpk-GTmT9mXzGHEOn72qufR43sE350d2ofw13oh4=.png"></p>
<hr>
<h1 id="ç¸½çµ"><a href="#ç¸½çµ" class="headerlink" title="ç¸½çµ"></a>ç¸½çµ</h1><p>ä»Šå¤©åˆ†äº«äº† Amcache.hveã€NTUSER.DAT å…©å€‹ Hiveï¼Œå¤šäº†ä¸€é»ç·šç´¢å¯ä»¥åˆ†æï¼Œé€™å…©å€‹ Hive å°æ–¼ Disk Forensic ä¾†èªªæŒºé‡è¦ä¹ŸæŒºå¸¸ç”¨åˆ°çš„ï¼Œåœ¨æ‰“è—éšŠ Lab æˆ– CTF æ™‚å¦‚æœæ²’ä»€éº¼ç·šç´¢ä¹Ÿæœƒè·‘ä¾†çœ‹é€™å…©å€‹ Hiveï¼Œæ˜å¤©ä¹ŸæœƒæŒçºŒåˆ†äº«å…¶ä»–å¯åˆ†æçš„éƒ¨åˆ†ã€‚</p>
</div></article></div></main><footer><div class="paginator"></div><div class="copyright"><p>Â© 2025 - 2026 <a href="https://yunshiuan.com">yunshiuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-clike.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cpp.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
</script><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>