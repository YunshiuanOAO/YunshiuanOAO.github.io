<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Boss Of The SOC v1 ä¸Š Â· yunshiuan</title><meta name="description" content="Boss Of The SOC v1 ä¸Š - yunshiuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/assets/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yunshiuan.com/atom.xml" title="yunshiuan"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="yunshiuan" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/assets/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="https://github.com/YunshiuanOAO" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/assets/CV.pdf" target="_self" class="nav-list-link">CV</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Boss Of The SOC v1 ä¸Š</h1><div class="post-info">Oct 11, 2025</div><div class="post-content"><h1 id="Day27-Boss-Of-The-SOC-v1-ä¸Š"><a href="#Day27-Boss-Of-The-SOC-v1-ä¸Š" class="headerlink" title="Day27 Boss Of The SOC v1 ä¸Š"></a>Day27 Boss Of The SOC v1 ä¸Š</h1><h1 id="ğŸ§‚-å‰è¨€"><a href="#ğŸ§‚-å‰è¨€" class="headerlink" title="ğŸ§‚ å‰è¨€"></a>ğŸ§‚ å‰è¨€</h1><p>ä»Šå¤©æœƒåˆ†äº« Boss Of The SOC v1 Q1 ~ Q10 çš„è§£é¡Œéç¨‹ï¼Œè§£é¡Œå¹³å°æœƒä½¿ç”¨ CyberDefenderï¼Œå› ç‚º Splunk ç’°å¢ƒå·²ç¶“å¹«æˆ‘å€‘æ¶è¨­å¥½äº†ï¼Œä¹Ÿå¯ä»¥åœ¨å¹³å°ä¸Šé©—è­‰ç­”æ¡ˆçš„æ­£ç¢ºæ€§ã€‚</p>
<hr>
<h1 id="æƒ…å¢ƒ"><a href="#æƒ…å¢ƒ" class="headerlink" title="æƒ…å¢ƒ"></a>æƒ…å¢ƒ</h1><p>æœ¬æ¬¡å¯¦ä½œå¯¦é©—èšç„¦åœ¨ APTï¼ˆé«˜éšæŒçºŒæ€§å¨è„…ï¼‰æƒ…å¢ƒèˆ‡å‹’ç´¢è»Ÿé«”æƒ…å¢ƒã€‚ä½ å°‡æ‰®æ¼” Alice Bluebird çš„è§’è‰²â€”â€”å‰›è¢«è˜ç‚º Wayne Enterprises çš„ SOC åˆ†æå¸«ï¼Œè² è²¬åµæ¸¬èˆ‡é˜²ç¦¦å„é¡ç¶²è·¯æ”»æ“Šã€‚</p>
<h2 id="å ´æ™¯-1ï¼ˆAPTï¼‰ï¼š"><a href="#å ´æ™¯-1ï¼ˆAPTï¼‰ï¼š" class="headerlink" title="å ´æ™¯ 1ï¼ˆAPTï¼‰ï¼š"></a>å ´æ™¯ 1ï¼ˆAPTï¼‰ï¼š</h2><p>ä»Šå¤©æ˜¯ Alice åœ¨ Wayne Enterprises å®‰å…¨éƒ¨é–€ï¼ˆSecurity Operations Centerï¼ŒSOCï¼‰çš„ç¬¬ä¸€å¤©ã€‚Lucius å« Alice åä¸‹ä¸¦çµ¦å¥¹ç¬¬ä¸€å€‹ä»»å‹™ï¼šä¸€ä»½ä¾†è‡ªé«˜è­šå¸‚è­¦å¯Ÿå±€ï¼ˆGotham City Police Department, GCPDï¼‰çš„å‚™å¿˜éŒ„ã€‚GCPD ç™¼ç¾ç·šä¸Šæœ‰è­‰æ“šï¼ˆ<a target="_blank" rel="noopener" href="http://pastebin.com/Gw6dWjS9%EF%BC%89%E9%A1%AF%E7%A4%BA%E7%B6%B2%E7%AB%99">http://pastebin.com/Gw6dWjS9ï¼‰é¡¯ç¤ºç¶²ç«™</a> <a target="_blank" rel="noopener" href="http://www.imreallynotbatman.com/">www.imreallynotbatman.com</a> åœ¨ Wayne Enterprises çš„ IP ä½å€ç©ºé–“å…§è¢«å…¥ä¾µã€‚è©²é§­å®¢çµ„ç¹”æœ‰å¤šé‡ç›®æ¨™â€¦â€¦ä½†ä»–å€‘çš„ä½œæ¡ˆæ‰‹æ³•ä¹‹ä¸€æ˜¯ç¯¡æ”¹ç¶²ç«™ä»¥ç¾è¾±è¢«å®³è€…ã€‚Lucius è¦æ±‚ Alice åˆ¤å®š <a target="_blank" rel="noopener" href="http://www.imreallynotbatman.com(wayne/">www.imreallynotbatman.comï¼ˆWayne</a> ä¼æ¥­åŸ·è¡Œé•·çš„å€‹äººéƒ¨è½æ ¼ï¼‰æ˜¯å¦ç¢ºå¯¦é­åˆ°å…¥ä¾µã€‚</p>
<p>åœ¨æ­¤æƒ…å¢ƒä¸­ï¼Œä½¿ç”¨è€…ç¤¾ç¾¤åœ¨ç€è¦½ Wayne Enterprises ç¶²ç«™æ™‚å›å ±çœ‹åˆ°ä¸‹åˆ—è¢«ç¯¡æ”¹çš„åœ–ç‰‡ï¼Œä¸”éƒ¨åˆ†å›å ±æåˆ°ã€ŒP01s0n1vyã€ã€‚è‹¥ä½ ä¸ç†Ÿæ‚‰ï¼ŒP01s0n1vy æ˜¯ä¸€å€‹æ›¾é‡å° Wayne Enterprises çš„ APT çµ„ç¹”ã€‚ä½ ä½œç‚º Alice çš„ç›®æ¨™æ˜¯èª¿æŸ¥è©²ç¶²ç«™ç¯¡æ”¹äº‹ä»¶ï¼Œä¸¦å˜—è©¦ä¾ç…§ Lockheed Martin Kill Chain é‡å»ºæ”»æ“Šæµç¨‹ã€‚</p>
<p><img src="/assets/kNpb6q5LoVBZaQL696hxc5NUhEZYM2Y6amfiOkUtQXA=.png"></p>
<h2 id="å ´æ™¯-2ï¼ˆå‹’ç´¢è»Ÿé«”ï¼‰ï¼š"><a href="#å ´æ™¯-2ï¼ˆå‹’ç´¢è»Ÿé«”ï¼‰ï¼š" class="headerlink" title="å ´æ™¯ 2ï¼ˆå‹’ç´¢è»Ÿé«”ï¼‰ï¼š"></a>å ´æ™¯ 2ï¼ˆå‹’ç´¢è»Ÿé«”ï¼‰ï¼š</h2><p>åœ¨ç¬¬äºŒå€‹æƒ…å¢ƒä¸­ï¼Œä½ çš„ä¸€ä½ä½¿ç”¨è€…åœ¨ Windows æ¡Œé¢ä¸Šçœ‹åˆ°ä¸€å¼µåœ–ç‰‡ï¼Œè¡¨ç¤ºç³»çµ±ä¸Šçš„æª”æ¡ˆå·²è¢«åŠ å¯†ï¼Œå¿…é ˆä»˜æ¬¾æ‰èƒ½å–å›æª”æ¡ˆã€‚çœ‹èµ·ä¾† Wayne Enterprises æœ‰ä¸€å°ä¸»æ©Ÿæ„ŸæŸ“äº† Cerber å‹’ç´¢è»Ÿé«”ï¼Œä½ çš„ç›®æ¨™æ˜¯èª¿æŸ¥é€™èµ·å‹’ç´¢äº‹ä»¶ã€‚</p>
<p><img src="/assets/XMxnyYYAgsqi2e8fgkpYi93wDgWY461l01mIV_P_MgM=.png"></p>
<hr>
<blockquote>
<p>Q1 : This is a simple question to get you familiar with submitting answers. What is the name of the company that makes the software that you are using for this competition? Just a six-letter word with no punctuation.</p>
</blockquote>
<p>å› ç‚ºé¡Œç›®çµ¦çš„ç’°å¢ƒæ˜¯ Splunkï¼Œé€™é‚Šå›ç­” splunk å³å¯ã€‚</p>
<p><img src="/assets/icMNAy1R14lhSyuRYQVk2lmq8FB6TmKnw5bcI1zeRa8=.png"></p>
<blockquote>
<p>Ans :  splunk</p>
</blockquote>
<hr>
<blockquote>
<p>Q2 : Web Defacement: What content management system is imreallynotbatman.com likely using? (Please do not include punctuation such as . , ! ? in your answer. We are looking for alpha characters only.)</p>
</blockquote>
<p>é¡Œç›®æƒ³è¦æ‰¾å‡º <code>imreallynotbatman.com</code> ç¶²ç«™ä½¿ç”¨äº†ä»€éº¼ CMS ç³»çµ±ã€‚</p>
<p>å› æ­¤æˆ‘å€‘æœƒç”¨åˆ° Search åŠŸèƒ½ã€‚</p>
<p>ä¾†åˆ° Search &amp; Report é é¢åœ¨ Search æ¬„ä½æœå°‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;&quot;botsv1&quot; imreallynotbatman.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>åœ¨ Splunk æ”¶åˆ°æ—¥èªŒæˆ–äº‹ä»¶å¾Œï¼Œæœƒæ ¹æ“šè¨­å®šå„²å­˜åœ¨ä¸åŒçš„ index<br>é€™æ®µæœå°‹èªæ³•çš„æ„æ€æ˜¯åœ¨è³‡æ–™ç´¢å¼•ç‚ºbotsv1ä¸­ï¼Œæ‰¾å‡ºå­—ä¸²ä¸­åŒ…å« <code>imreallynotbatman.com</code>ã€‚<br>data indexes å¯ä»¥åœ¨ Setting-&gt; DATA -&gt; Index ä¸­å¾—çŸ¥<br><img src="/assets/s7Yn9AMSgsP7iMFp1_kteGCWUZgVydpg8wxoXVaY1Mw=.png"></p>
<p>çœ‹ç¬¬ä¸€å€‹ Log å°±å¯ä»¥ç™¼ç¾ä½¿ç”¨çš„æ˜¯ <code>joomla</code>ã€‚</p>
<p><img src="/assets/6KmCQjyMKDS5-zRyLEXLBBfFIzOziopvdBwhCd6LJiM=.png"></p>
<blockquote>
<p>ans : <code>joomla</code></p>
</blockquote>
<hr>
<blockquote>
<p>Q3 : Web Defacement: What is the likely IP address of someone from the Po1s0n1vy group scanning imreallynotbatman.com for web application vulnerabilities?</p>
</blockquote>
<p>æ¥ä¸‹ä¾†ä»–æƒ³è¦æ‰¾çš„æ˜¯ Po1s0n1vy ç”¨ä¾†æƒæ imreallynotbatman.com çš„ IP æ˜¯ä»€éº¼ï¼Ÿ</p>
<p>æœ‰ä¸€å€‹ç·šç´¢æ˜¯çŸ¥é“é€™å€‹ IP æœ‰é€²è¡Œç¶²é æ¼æ´æƒæï¼Œæœ‰ä¸€å€‹æ–¹å‘æ˜¯æˆ‘å€‘å¯ä»¥ä½¿ç”¨åœ¨ Day17 æåˆ°çš„ Suricataï¼Œå®ƒæœƒç”¢ç”Ÿç¶²è·¯é€£æ¥çš„ Logï¼Œå› æ­¤æˆ‘å€‘æœå°‹çš„ç¯„åœå¯ä»¥é™åˆ¶åœ¨ Suricata çš„ log ä¸‹ï¼Œæœå°‹æŒ‡ä»¤å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;suricata http.hostname&#x3D;imreallynotbatman.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/JxJw2skLZ9umeMi8nqi2Oawi__n6MDwXb8f9NJlSCYA=.png"></p>
<p>ç„¶å¾Œæˆ‘å€‘æƒ³è¦å°ˆæ³¨çš„æ˜¯<strong>ä¾†æº IP</strong>ï¼Œå› æ­¤æˆ‘å€‘æœƒéœ€è¦ç”¨åˆ° table èªæ³•ï¼Œå®ƒå¯ä»¥å°‡æˆ‘å€‘æƒ³è¦çš„æ¬„ä½å–®ç¨æ‹‰å‡ºä¾†åšä¸€å¼µè¡¨æ ¼ï¼Œè®“æˆ‘å€‘å¯ä»¥å°ˆæ³¨åœ¨åˆ†æé€™å€‹æ¬„ä½ä¸Šã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;suricata http.hostname&#x3D;imreallynotbatman.com 
| table src_ip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/OhDFwdXkJxXoIpb1xqzNuy-uyBeSzR4Ds3i5LoryWiw=.png"></p>
<p>é€™é‚Šæˆ‘å€‘ç²å¾—äº†æ¯å€‹ Suricata log çš„ä¾†æº IPï¼Œæ¥ä¸‹ä¾†é€²è¡Œçµ±è¨ˆï¼Œå› ç‚ºæˆ‘æƒ³è¦å¾—åˆ°çš„æ˜¯é€™å€‹ IP å‡ºç¾å¹¾æ¬¡ï¼Œæ•¸é‡å¾ˆå¤šæœƒæœ‰å¾ˆé«˜çš„æ©Ÿç‡æ˜¯é€²è¡Œæƒæï¼Œæ‰€ä»¥æ¥ä¸‹ä¾†æœƒä½¿ç”¨åˆ° stats èªæ³•ï¼Œå®ƒæä¾›äº†ä¸€äº›åŸºæœ¬çš„çµ±è¨ˆåŠŸèƒ½ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;suricata http.hostname&#x3D;imreallynotbatman.com 
| table src_ip 
| stats count by src_ip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/XOGDycf1lecuXmMmaM985JoLpyxsQW9OIUYvABV4ZMA=.png"></p>
<p>é€™æ¨£å°±çœ‹å¾—å‡ºä¾†ç­”æ¡ˆå°±æ˜¯ <code>40.80.148.42</code>ï¼Œå¦å¤–å¦‚æœæƒ³è¦æ•¸é‡ç”±å¤§æ’åˆ°å°ï¼Œå¯ä»¥ä½¿ç”¨ sort èªæ³•ï¼Œé è¨­æ˜¯ç”±å°æ’åˆ°å¤§ï¼ŒåŠ ä¸Š <code>-</code> å¯ä»¥è®“å®ƒè®Šæˆç”±å¤§æ’åˆ°å°ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;suricata http.hostname&#x3D;imreallynotbatman.com 
| table src_ip 
| stats count by src_ip 
| sort -count reverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/be5iJG9bbqLEDr3wZZV59naJ4B8Du_ciK_RTg4cMfdA=.png"></p>
<blockquote>
<p>ans : <code>40.80.148.42</code></p>
</blockquote>
<hr>
<blockquote>
<p>Q4 : Web Defacement: What company created the web vulnerability scanner used by Po1s0n1vy? Type the company name. (For example, â€œMicrosoftâ€ or â€œOracleâ€)</p>
</blockquote>
<p>é€™é¡Œæƒ³è¦æœå°‹åˆ°ä»–å€‘ä½¿ç”¨çš„ scanner å·¥å…·æ˜¯ä»€éº¼ã€‚</p>
<p>ä¸€æ¨£æˆ‘å€‘å¯ä»¥ä½¿ç”¨ Suricata å·¥å…·ï¼Œå®ƒé™¤äº†å¯ä»¥ç”¢ç”Ÿç¶²è·¯é€£æ¥ log ä¹‹å¤–ï¼Œé‚„å¯ä»¥æ ¹æ“šè‡ªè¨‚è¦å‰‡ç”¢ç”Ÿè­¦å ±ï¼Œå¦‚æŠ“åˆ°æŸå€‹æƒæå·¥å…·çš„ Signatureã€‚</p>
<p>æ‰€ä»¥æˆ‘å€‘å¯ä»¥é‡å° Suricata ç”¢ç”Ÿçš„ alert å»åˆ†æï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;suricata http.hostname&#x3D;imreallynotbatman.com src_ip&#x3D;40.80.148.42 alert<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/PF6XbKoFeldNiTIGNzQa2S3TylhVgZqSQfC96KNtyHA=.png"></p>
<p>signature æ¬„ä½é¡¯ç¤ºåµæ¸¬åˆ°çš„æ˜¯ä»€éº¼ç›¸é—œæ“ä½œï¼Œå› æ­¤æˆ‘å€‘ç”¨ table å°ˆæ³¨å»çœ‹ alert.signature æœ‰æ²’æœ‰ç›¸é—œçš„ç·šç´¢ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;suricata http.hostname&#x3D;imreallynotbatman.com src_ip&#x3D;40.80.148.42 alert
| table alert.signature<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/FFuDTSF0_gvnDMjyPdFes-eoxr2Iy8NVLD0YUvxLKZs=.png"></p>
<p>æ¥ä¸‹ä¾†å°±å¯ä»¥æ‰¾åˆ°é€™å€‹ valueï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">ET SCAN Acunetix Accept HTTP Header detected scan in progress<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¯ä»¥çœ‹å‡º Acunetix å°±æ˜¯æˆ‘å€‘éœ€è¦çš„ç­”æ¡ˆã€‚</p>
<blockquote>
<p>ans : Acunetix</p>
</blockquote>
<hr>
<blockquote>
<p>Q5 : Web Defacement: What IP address is likely attempting a brute force password attack against imreallynotbatman.com?</p>
</blockquote>
<p>è¦æ‰¾åˆ°å“ªå€‹ IP åœ¨å° imreallynotbatman.com é€²è¡Œæš´åŠ›ç ´è§£ã€‚</p>
<p>éœ€è¦å°ç¶²ç«™é€²è¡Œå¸³è™Ÿå¯†ç¢¼çš„æš´åŠ›ç ´è§£ï¼Œæœƒéœ€è¦ç”¨åˆ° POST çš„ methodï¼Œæˆ‘å€‘å¯ä»¥é‡å° POST æ“ä½œåšæŸ¥çœ‹ï¼Œä¸¦ä¸”ä¹Ÿæœƒéœ€è¦çŸ¥é“ POST å¸¶çš„è³‡æ–™ï¼Œç¢ºèªæ˜¯ä¸æ˜¯åœ¨åšæš´åŠ›ç ´è§£ï¼ŒæŸ¥è©¢å¯ä»¥ç”¨ä»¥ä¸‹æŒ‡ä»¤ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 http_method&#x3D;POST dest_ip&#x3D;192.168.250.70 sourcetype&#x3D;stream:http
| table src_ip, form_data, uri<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><code>sourcetype=stream:http</code> ä»£è¡¨æ˜¯æ‹¿ Splunk Stream app æ‰€æ”¶é›†åˆ°ä¸¦ä¸”å±¬æ–¼ HTTP æµé‡è³‡æ–™ï¼Œè€Œ <code>dest_ip=192.168.250.70</code> æ˜¯ imreallynotbatman.com çš„ IPï¼Œåœ¨å‰å¹¾é¡Œçš„æ“ä½œå¯ä»¥å¾—çŸ¥ã€‚</p>
<p><img src="/assets/YlPiSsFhTTIy4alIrPTC0E81cW-xZcJU14fKd8qyayo=.png"></p>
<p>é€™é‚Šå¯ä»¥çœ‹å‡ºä¾†æ˜¯ 23.22.63.114 åœ¨é€²è¡Œæš´åŠ›ç ´è§£ã€‚</p>
<blockquote>
<p>ans : 23.22.63.114</p>
</blockquote>
<hr>
<blockquote>
<p>Q6 : Web Defacement: What was the first brute force password used</p>
</blockquote>
<p>é€™é¡Œè¦ç²å¾—ç¬¬ä¸€å€‹æš´åŠ›ç ´è§£å˜—è©¦çš„å¯†ç¢¼ã€‚</p>
<p>é€™é¡Œå¯ä»¥ä½¿ç”¨ sort å°‡æ™‚é–“æ’åºï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 http_method&#x3D;POST dest_ip&#x3D;192.168.250.70 sourcetype&#x3D;stream:http src_ip&#x3D;23.22.63.114
| table src_ip, form_data, uri _time
| sort _time<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/39-8d3Nvl4wzQTMjMF4pyt3Z9T5fbnjtIBP4MTLXBnQ=.png"></p>
<p>çœ‹åˆ°ç¬¬ä¸€åˆ—çš„ password åƒæ•¸æ˜¯ 12345678ã€‚</p>
<blockquote>
<p>ans : 12345678</p>
</blockquote>
<hr>
<blockquote>
<p>Q7 : Web Defacement: What is the name of the executable uploaded by Po1s0n1vy? Please include the file extension. (For example, â€œnotepad.exeâ€ or â€œfavicon.icoâ€)</p>
</blockquote>
<p>é€™é¡Œè¦æ‰¾çš„æ˜¯ Po1s0n1vy ä¸Šå‚³çš„åŸ·è¡Œæª”çš„æª”åæ˜¯ä»€éº¼ã€‚</p>
<p>åœ¨ HTTP ä¸­ï¼Œå¦‚æœä¸Šå‚³ä¸€å€‹æª”æ¡ˆæœƒä½¿ç”¨ <code>multipart/form-data</code>ï¼Œä»£è¡¨æœƒå°‡ä¸åŒ type çš„è³‡æ–™é€éä¸€æ¬¡è«‹æ±‚å‚³é€å‡ºå»ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥ç”¨ <code>multipart/form-data</code> ç¸®å°æˆ‘å€‘çš„æœå°‹ç¯„åœï¼Œå¦å¤–èªæ³•ä¹Ÿæ”¯æ´ regexï¼Œåœ¨æœå°‹åŸ·è¡Œæª”ä¸Šæ¯”è¼ƒæ–¹ä¾¿ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 http_method&#x3D;POST dest_ip&#x3D;192.168.250.70 sourcetype&#x3D;stream:http multipart&#x2F;form-data *.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/YVwaJ7YoOM-RMWk-A5KU8bH-aYXv1Bg-BFKJo1a-ZSo=.png"></p>
<p>å¯ä»¥ç™¼ç¾åˆ°ä¸Šå‚³çš„åŸ·è¡Œæª”æª”åç‚º 3791.exeã€‚</p>
<blockquote>
<p>ans : 3791.exe</p>
</blockquote>
<hr>
<blockquote>
<p>Q8 : Web Defacement: What is the MD5 hash of the executable uploaded?</p>
</blockquote>
<p>é€™é¡Œå• 3791.exe çš„ MD5 å€¼æ˜¯å¤šå°‘ã€‚</p>
<p>è¦å–å¾— MD5 çš„å€¼ï¼Œæœƒéœ€è¦çœ‹é—œæ–¼ winlog çš„ç´€éŒ„ï¼Œé€™é‚Šæœƒæåˆ°ä¸€å€‹å·¥å…· - <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-tw/sysinternals/downloads/sysmon">Sysmon</a>ï¼Œå®ƒæœƒè¨˜éŒ„ç³»çµ±å…§ç™¼ç”Ÿçš„é‡è¦äº‹ä»¶ï¼ŒåŒ…å« Process Createã€Network Connectã€æª”æ¡ˆå»ºç«‹èˆ‡è®Šæ›´ã€Registry Modificationã€‚ </p>
<p>ä»¥ä¸‹æ˜¯ Sysmon çš„ Event IDï¼š</p>
<h3 id="Sysmon"><a href="#Sysmon" class="headerlink" title="Sysmon"></a>Sysmon</h3><table>
<thead>
<tr>
<th>Event ID</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Process Createï¼ˆç¨‹å¼å•Ÿå‹•ï¼‰</td>
</tr>
<tr>
<td>2</td>
<td>File creation time changedï¼ˆæ™‚é–“æˆ³è¢«ä¿®æ”¹ï¼‰</td>
</tr>
<tr>
<td>3</td>
<td>Network connectionï¼ˆTCP é€£ç·šï¼‰</td>
</tr>
<tr>
<td>5</td>
<td>Process Terminateï¼ˆç¨‹å¼çµ‚æ­¢ï¼‰</td>
</tr>
<tr>
<td>6</td>
<td>Driver Loadedï¼ˆé©…å‹•è¼‰å…¥ï¼‰</td>
</tr>
<tr>
<td>7</td>
<td>Image Loadedï¼ˆDLLè¼‰å…¥ï¼‰</td>
</tr>
<tr>
<td>8</td>
<td>CreateRemoteThreadï¼ˆé ç«¯åŸ·è¡Œç·’æ³¨å…¥ï¼‰</td>
</tr>
<tr>
<td>9</td>
<td>RawAccessReadï¼ˆç£ç¢ŸåŸå§‹å­˜å–ï¼‰</td>
</tr>
<tr>
<td>10</td>
<td>ProcessAccessï¼ˆç¨‹å¼å­˜å–ä»–äººè¨˜æ†¶é«”ï¼‰</td>
</tr>
<tr>
<td>11</td>
<td>File Createï¼ˆæª”æ¡ˆå»ºç«‹ï¼‰</td>
</tr>
<tr>
<td>12</td>
<td>Registry Key Createï¼ˆè¨»å†Šè¡¨éµå»ºç«‹ï¼‰</td>
</tr>
<tr>
<td>13</td>
<td>Registry Value Setï¼ˆè¨»å†Šè¡¨å€¼ä¿®æ”¹ï¼‰</td>
</tr>
<tr>
<td>14</td>
<td>Registry Key Deleteï¼ˆè¨»å†Šè¡¨éµåˆªé™¤ï¼‰</td>
</tr>
<tr>
<td>15</td>
<td>FileCreateStreamHashï¼ˆå»ºç«‹ ADSï¼‰</td>
</tr>
<tr>
<td>22</td>
<td>DNS Queryï¼ˆDNS æŸ¥è©¢äº‹ä»¶ï¼‰</td>
</tr>
<tr>
<td>23</td>
<td>File Deleteï¼ˆæª”æ¡ˆåˆªé™¤ï¼‰</td>
</tr>
<tr>
<td>25</td>
<td>Process Tamperingï¼ˆç¨‹å¼è¨˜æ†¶é«”è¢«ä¿®æ”¹ï¼‰</td>
</tr>
<tr>
<td>26</td>
<td>File Deleted and Overwrittenï¼ˆé˜²æ­¢å–è­‰ï¼‰</td>
</tr>
<tr>
<td>255</td>
<td>Sysmon è¨­å®šè¢«ä¿®æ”¹ï¼ˆConfig changeï¼‰</td>
</tr>
</tbody></table>
<p>å…¶ä¸­ Event ID &#x3D; 1 æœ‰ MD5 å¯ä»¥æŸ¥çœ‹ï¼Œé‚£é€™æ¨£æˆ‘å€‘å°±æœå°‹ 3791.exe çš„åŸ·è¡Œç´€éŒ„ï¼Œç²å¾—å®ƒçš„ MD5 å€¼ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 source &#x3D; WinEventLog:Microsoft-Windows-Sysmon&#x2F;Operational 3791.exe EventCode&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/juHx-R1ointkAU6o-_IgpSKURGIDc0xy64Q9Lcizq1g=.png"></p>
<p>è€Œæˆ‘å€‘å°ˆå¿ƒçœ‹é€™å€‹ç´€éŒ„ï¼š</p>
<p><img src="/assets/VtTVFx0LRq1LMC0GeOJe7sqZy9cI0_yULvm2phY2C7Q=.png"></p>
<p>å®ƒçš„ ParentCommandLine æ˜¯ <code>cmd.exe/c &quot;3791.exe2&amp;gt;&amp;amp;1</code>ï¼Œä»¥åŠé€™é‚Šé¡¯ç¤ºçš„ <code>&lt;DataName=&#39;Image&#39;&gt;C:\inetpub\wwwroot\joomla\3791.exe&lt;/Data&gt;&lt;DataName=&#39;CommandLine&#39;&gt;3791.exe</code>ï¼Œä»£è¡¨é€™å€‹ç´€éŒ„æ˜¯é—œæ–¼ 3791.exe çš„è³‡è¨Šï¼Œæ‰€ä»¥å¾€å¾Œé¢çœ‹å®ƒçš„ MD5 å€¼æ˜¯ AAE3F5A29935E6ABCC2C2754D12A9AF0ã€‚</p>
<blockquote>
<p>ans : AAE3F5A29935E6ABCC2C2754D12A9AF0</p>
</blockquote>
<hr>
<blockquote>
<p>Q9 : Web Defacement: What was the correct password for admin access to the content management system running â€œimreallynotbatman.comâ€?</p>
</blockquote>
<p>é€™é¡Œæƒ³è¦å•æ˜¯å“ªå€‹å¯†ç¢¼æˆåŠŸé€²å…¥äº† imreallynotbatman.comã€‚</p>
<p>æˆ‘å€‘å¯ä»¥åœ¨è§£ Q5 çš„æ™‚å€™çŸ¥é“ç™»å…¥çš„é é¢æ˜¯åœ¨ <code>/joomla/administrator/index.php</code>ï¼Œä¸¦ä¸”å®ƒæ˜¯ç”¨æš´åŠ›ç ´è§£çš„æ–¹å¼å˜—è©¦ç™»å…¥ç³»çµ±ï¼Œæ‰€ä»¥å¦‚æœæœ‰ä¸€å€‹å¯†ç¢¼èˆ‡å…¶ä»–ç™»å…¥æ¬¡æ•¸æ¯”å…¶ä»–çš„é‚„å¤šå°±æœ‰å¯èƒ½æœƒæ˜¯æ­£ç¢ºçš„å¯†ç¢¼ï¼Œä½†æ˜¯å®ƒçš„å¯†ç¢¼æ˜¯æ”¾åœ¨ form_data æ¬„ä½ï¼Œé€™å€‹æ¬„ä½æœƒåŒ…å«å…¶ä»–çš„æ–‡å­—è³‡è¨Šï¼Œå› æ­¤æˆ‘å€‘æœƒéœ€è¦ç”¨åˆ° rex èªæ³•ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 dest_ip&#x3D;192.168.250.70 sourcetype&#x3D;stream:http http_method&#x3D;POST uri&#x3D;&#x2F;joomla&#x2F;administrator&#x2F;index.php
| rex field&#x3D;form_data &quot;passwd&#x3D;(?&lt;pass&gt;\w+)&quot;
| stats count by pass<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>rex çš„æ¬„ä½èªªæ˜å¦‚ä¸‹ï¼š</p>
<ul>
<li>field&#x3D;form_dataï¼šè¡¨ç¤ºåªåœ¨äº‹ä»¶çš„ form_data æ¬„ä½å…§å®¹ä¸­åŸ·è¡Œæ­£è¦è¡¨é”å¼ï¼ˆè€Œä¸æ˜¯æ•´å€‹ _rawï¼‰ã€‚</li>
<li>â€œpasswd&#x3D;(?<pass>\w+)â€ï¼šæ­£è¦è¡¨é”å¼æœ¬é«”ï¼š<ul>
<li>passwd&#x3D;ï¼šå­—é¢åŒ¹é…å­—ä¸² passwd&#x3D;ï¼ˆä¾‹å¦‚ HTML è¡¨å–®æˆ– HTTP body è£¡çš„åƒæ•¸åï¼‰ã€‚</li>
<li>(?<pass>\w+)ï¼šå‘½åæ•ç²ç¾¤çµ„ï¼ŒæœƒæŠŠåŒ¹é…åˆ°çš„å…§å®¹æ”¾åˆ° Splunk æ¬„ä½ pass ä¸­ã€‚<ul>
<li>\w+ è¡¨ç¤ºä¸€æˆ–å¤šå€‹ã€Œå­—æ¯ã€æ•¸å­—æˆ–åº•ç·šï¼ˆunderscoreï¼‰ã€ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>åŸæœ¬çš„ form_data é•·é€™æ¨£ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">username&#x3D;admin&amp;task&#x3D;login&amp;return&#x3D;aW5kZXgucGhw&amp;option&#x3D;com_login&amp;passwd&#x3D;topgun&amp;49e63c55a9730eee52c7ea0448de3a01&#x3D;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å› æ­¤å®ƒæœƒæå– <code>passwd=</code> å¾Œé¢çš„å­—ä¸²ï¼Œç›´åˆ°ç¢°åˆ°ä¸æ˜¯å­—æ¯ã€æ•¸å­—æˆ–åº•ç·šç‚ºæ­¢ï¼Œç„¶å¾Œå®ƒæœƒè®Šæˆå–®ç¨çš„ pass æ¬„ä½ã€‚</p>
<p><img src="/assets/bDwPdvFgqR8HTS-_cHAqJUw8P4v7Kczqt2wjET1hwak=.png"></p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 dest_ip&#x3D;192.168.250.70 sourcetype&#x3D;stream:http http_method&#x3D;POST uri&#x3D;&#x2F;joomla&#x2F;administrator&#x2F;index.php
| rex field&#x3D;form_data &quot;passwd&#x3D;(?&lt;pass&gt;\w+)&quot;
| stats count by pass
| sort -count<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/O7MkDnpyKaqjyMnhCJipRzitRuH_45-EXW9K7hO0R2I=.png"></p>
<blockquote>
<p>ans : batman</p>
</blockquote>
<hr>
<blockquote>
<p>Q10 Web Defacement: What is the name of the file that defaced the imreallynotbatman.com website? Please submit only the name of the file with the extension (For example, â€œnotepad.exeâ€ or â€œfavicon.icoâ€).</p>
</blockquote>
<p>é¡Œç›®æƒ³å•æ˜¯å“ªå€‹æª”æ¡ˆåç¨±æ±¡æŸ“äº† imreallynotbatman.com ç¶²é ã€‚</p>
<p>é€™é‚Šæ‡‰è©²æ˜¯æƒ³è¦å•æƒ…å¢ƒ 1 ç•¶ä¸­é€²å…¥ç¶²ç«™å‡ºç¾ä¸€å¼µåœ–ç‰‡ã€‚</p>
<p>ä»£è¡¨å®ƒä¹‹å‰å¯èƒ½æœƒå»ä¸‹è¼‰éï¼Œå› æ­¤å¯ä»¥ç”¨ä»¥ä¸‹æŒ‡ä»¤æŸ¥è©¢å®ƒä¹‹å‰è«‹æ±‚çš„é é¢ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;stream:http src_ip&#x3D;192.168.250.70 
| table site src_headers<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/Q4BQsOFmAx6I7jH9goDcf-MGpRlOr2Ocb1LG0GUrdu8=.png"></p>
<p>é€™é‚Šå¯ä»¥çœ‹åˆ°å®ƒå»ä¸€å€‹ç¶²é è«‹æ±‚ <code>poisonivy-is-coming-for-you-batman.jpeg</code> åœ–ç‰‡ï¼Œé€™å€‹å°±æ˜¯ç­”æ¡ˆã€‚</p>
<blockquote>
<p>ans : poisonivy-is-coming-for-you-batman.jpeg</p>
</blockquote>
<hr>
<h1 id="ç¸½çµ"><a href="#ç¸½çµ" class="headerlink" title="ç¸½çµ"></a>ç¸½çµ</h1><p>ä»Šå¤©åˆ†äº«äº† Boss Of The SOC v1 çš„ Q1 ~ Q10 çš„è§£é¡Œéç¨‹ï¼Œç•¶ä¸­åˆ†äº«äº†ä¸€äº› Splunk çš„ç”¨æ³•ä»¥åŠ Threat Hunting çš„éç¨‹ï¼Œæ˜å¤©æœƒç¹¼çºŒåˆ†äº« Boss Of The SOC v1 å‰©é¤˜é¡Œç›®ã€‚</p>
</div></article></div></main><footer><div class="paginator"></div><div class="copyright"><p>Â© 2025 - 2026 <a href="https://yunshiuan.com">yunshiuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-clike.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cpp.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
</script><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>