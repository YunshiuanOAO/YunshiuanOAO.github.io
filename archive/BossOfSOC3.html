<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Boss Of The SOC v1 ä¸‹ Â· yunshiuan</title><meta name="description" content="Boss Of The SOC v1 ä¸‹ - yunshiuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/assets/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yunshiuan.com/atom.xml" title="yunshiuan"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="yunshiuan" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/assets/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="https://github.com/YunshiuanOAO" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/assets/CV.pdf" target="_self" class="nav-list-link">CV</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Boss Of The SOC v1 ä¸‹</h1><div class="post-info">Oct 13, 2025</div><div class="post-content"><h1 id="ğŸ§‚-å‰è¨€"><a href="#ğŸ§‚-å‰è¨€" class="headerlink" title="ğŸ§‚ å‰è¨€"></a>ğŸ§‚ å‰è¨€</h1><p>æ¥çºŒæ˜¨å¤©çš„å…§å®¹ï¼Œä»Šå¤©æœƒåˆ†äº« Boss Of The SOC v1 å‰©ä¸‹çš„  Q21~ Q32 çš„è§£é¡Œéç¨‹ï¼Œå­¸ç¿’ Threat Hunting çš„æµç¨‹ï¼Œè§£é¡Œå¹³å°åŒæ¨£æœƒä½¿ç”¨ CyberDefender</p>
<hr>
<h1 id="æƒ…å¢ƒ"><a href="#æƒ…å¢ƒ" class="headerlink" title="æƒ…å¢ƒ"></a>æƒ…å¢ƒ</h1><p>æœ¬æ¬¡å¯¦ä½œå¯¦é©—èšç„¦åœ¨ APTï¼ˆé«˜éšæŒçºŒæ€§å¨è„…ï¼‰æƒ…å¢ƒèˆ‡å‹’ç´¢è»Ÿé«”æƒ…å¢ƒã€‚ä½ å°‡æ‰®æ¼” Alice Bluebird çš„è§’è‰²â€”â€”å‰›è¢«è˜ç‚º Wayne Enterprises çš„ SOC åˆ†æå¸«ï¼Œè² è²¬åµæ¸¬èˆ‡é˜²ç¦¦å„é¡ç¶²è·¯æ”»æ“Šã€‚</p>
<h2 id="å ´æ™¯-1ï¼ˆAPTï¼‰ï¼š"><a href="#å ´æ™¯-1ï¼ˆAPTï¼‰ï¼š" class="headerlink" title="å ´æ™¯ 1ï¼ˆAPTï¼‰ï¼š"></a>å ´æ™¯ 1ï¼ˆAPTï¼‰ï¼š</h2><p>ä»Šå¤©æ˜¯ Alice åœ¨ Wayne Enterprises å®‰å…¨éƒ¨é–€ï¼ˆSecurity Operations Centerï¼ŒSOCï¼‰çš„ç¬¬ä¸€å¤©ã€‚Lucius å« Alice åä¸‹ä¸¦çµ¦å¥¹ç¬¬ä¸€å€‹ä»»å‹™ï¼šä¸€ä»½ä¾†è‡ªé«˜è­šå¸‚è­¦å¯Ÿå±€ï¼ˆGotham City Police Department, GCPDï¼‰çš„å‚™å¿˜éŒ„ã€‚GCPD ç™¼ç¾ç·šä¸Šæœ‰è­‰æ“šï¼ˆ<a target="_blank" rel="noopener" href="http://pastebin.com/Gw6dWjS9%EF%BC%89%E9%A1%AF%E7%A4%BA%E7%B6%B2%E7%AB%99">http://pastebin.com/Gw6dWjS9ï¼‰é¡¯ç¤ºç¶²ç«™</a> <a target="_blank" rel="noopener" href="http://www.imreallynotbatman.com/">www.imreallynotbatman.com</a> åœ¨ Wayne Enterprises çš„ IP ä½å€ç©ºé–“å…§è¢«å…¥ä¾µã€‚è©²é§­å®¢çµ„ç¹”æœ‰å¤šé‡ç›®æ¨™â€¦â€¦ä½†ä»–å€‘çš„ä½œæ¡ˆæ‰‹æ³•ä¹‹ä¸€æ˜¯ç¯¡æ”¹ç¶²ç«™ä»¥ç¾è¾±è¢«å®³è€…ã€‚Lucius è¦æ±‚ Alice åˆ¤å®š <a target="_blank" rel="noopener" href="http://www.imreallynotbatman.com(wayne/">www.imreallynotbatman.comï¼ˆWayne</a> ä¼æ¥­åŸ·è¡Œé•·çš„å€‹äººéƒ¨è½æ ¼ï¼‰æ˜¯å¦ç¢ºå¯¦é­åˆ°å…¥ä¾µã€‚</p>
<p>åœ¨æ­¤æƒ…å¢ƒä¸­ï¼Œä½¿ç”¨è€…ç¤¾ç¾¤åœ¨ç€è¦½ Wayne Enterprises ç¶²ç«™æ™‚å›å ±çœ‹åˆ°ä¸‹åˆ—è¢«ç¯¡æ”¹çš„åœ–ç‰‡ï¼Œä¸”éƒ¨åˆ†å›å ±æåˆ°ã€ŒP01s0n1vyã€ã€‚è‹¥ä½ ä¸ç†Ÿæ‚‰ï¼ŒP01s0n1vy æ˜¯ä¸€å€‹æ›¾é‡å° Wayne Enterprises çš„ APT çµ„ç¹”ã€‚ä½ ä½œç‚º Alice çš„ç›®æ¨™æ˜¯èª¿æŸ¥è©²ç¶²ç«™ç¯¡æ”¹äº‹ä»¶ï¼Œä¸¦å˜—è©¦ä¾ç…§ Lockheed Martin Kill Chain é‡å»ºæ”»æ“Šæµç¨‹ã€‚</p>
<p><img src="/assets/kNpb6q5LoVBZaQL696hxc5NUhEZYM2Y6amfiOkUtQXA=.png"></p>
<h2 id="å ´æ™¯-2ï¼ˆå‹’ç´¢è»Ÿé«”ï¼‰ï¼š"><a href="#å ´æ™¯-2ï¼ˆå‹’ç´¢è»Ÿé«”ï¼‰ï¼š" class="headerlink" title="å ´æ™¯ 2ï¼ˆå‹’ç´¢è»Ÿé«”ï¼‰ï¼š"></a>å ´æ™¯ 2ï¼ˆå‹’ç´¢è»Ÿé«”ï¼‰ï¼š</h2><p>åœ¨ç¬¬äºŒå€‹æƒ…å¢ƒä¸­ï¼Œä½ çš„ä¸€ä½ä½¿ç”¨è€…åœ¨ Windows æ¡Œé¢ä¸Šçœ‹åˆ°ä¸€å¼µåœ–ç‰‡ï¼Œè¡¨ç¤ºç³»çµ±ä¸Šçš„æª”æ¡ˆå·²è¢«åŠ å¯†ï¼Œå¿…é ˆä»˜æ¬¾æ‰èƒ½å–å›æª”æ¡ˆã€‚çœ‹èµ·ä¾† Wayne Enterprises æœ‰ä¸€å°ä¸»æ©Ÿæ„ŸæŸ“äº† Cerber å‹’ç´¢è»Ÿé«”ï¼Œä½ çš„ç›®æ¨™æ˜¯èª¿æŸ¥é€™èµ·å‹’ç´¢äº‹ä»¶ã€‚</p>
<p><img src="/assets/XMxnyYYAgsqi2e8fgkpYi93wDgWY461l01mIV_P_MgM=.png"></p>
<hr>
<blockquote>
<p>Q21 : Ransomware: What fully qualified domain name (FQDN) makes the Cerber ransomware attempt to direct the user to at the end of its encryption phase?</p>
</blockquote>
<p>é¡Œç›®æ•˜è¿°èªªæƒ¡æ„ç¨‹å¼æœƒè®“ä½¿ç”¨è€…å˜—è©¦å»è«‹æ±‚ domain ï¼Œè¦æ‰¾å‡ºFQDN</p>
<p>æˆ‘æƒ³è¦å…ˆçŸ¥é“å…§éƒ¨æœ‰å“ªäº› IP æœ‰åœ¨é€²è¡Œ DNS æŸ¥è©¢</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;&quot;botsv1&quot; sourcetype&#x3D;&quot;stream:dns&quot;
| table src_ip
| stats count by src_ip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/sYm2KnhgFYCkdM9sQJ_4SWm4Wfc7Cdngvk7lwpW0Jp8=.png"></p>
<p>é€™é‚ŠçŸ¥é“192.168.2.50ã€192.168.250.100ã€192.168.250.20ã€192.168.250.40ã€192.168.250.70 é€™äº›å…§éƒ¨ IP æœ‰åœ¨é€²è¡Œ DNS æŸ¥è©¢ï¼Œæ¥ä¸‹ä¾†æˆ‘å…ˆçœ‹192.168.250.0&#x2F;24 å…§ IP æŸ¥è©¢äº†å“ªäº› domainï¼Œ</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;&quot;botsv1&quot; sourcetype&#x3D;&quot;stream:dns&quot; src_ip&#x3D;192.168.250.0&#x2F;24 
| table  src_ip,dest_ip,query&#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/OMbF3JUJiANeRWwDsBVF2A-In4u5w0v0fjWPRff2WmE=.png"></p>
<p>æ¥ä¸‹ä¾†æœƒæœ‰å¾ˆå¤šå…¶ä»–çš„ DNS è¨˜éŒ„å‡ºä¾† æˆ‘å€‘å¯ä»¥é»æ“Šä¸å¯èƒ½æ˜¯ç­”æ¡ˆçš„ FQDN ï¼Œç„¶å¾Œé¸æ“‡ Exclude from result ï¼Œç„¶å¾Œå®ƒå°±æœƒåœ¨ Search æ¬„ä½ä¸­è‡ªå‹•ç”¢å‡ºå°‡æ­¤FQDN æ’é™¤æŸ¥è©¢çš„èªæ³•ã€‚</p>
<p><img src="/assets/IoBJChn4M4fthuMfAPQoc1e6b4G-eXwv6hstSV2nq_M=.png"></p>
<p>ç¶“éå±¤å±¤ç¯©é¸å¾Œæœ€å¾ŒæŸ¥è©¢å¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;&quot;botsv1&quot; sourcetype&#x3D;&quot;stream:dns&quot; src_ip&#x3D;192.168.250.0&#x2F;24  &quot;query&#123;&#125;&quot;!&#x3D;&quot;*.in-addr.arpa&quot; &quot;query&#123;&#125;&quot;!&#x3D;&quot;demo-01&quot;  &quot;query&#123;&#125;&quot;!&#x3D;&quot;*.authdns.ripe.net&quot;  &quot;query&#123;&#125;&quot;!&#x3D;&quot;*.microsoft.com&quot; &quot;query&#123;&#125;&quot;&#x3D;*.*.* &quot;query&#123;&#125;&quot;!&#x3D;&quot;*.waynecorpinc.local&quot;  &quot;query&#123;&#125;&quot;!&#x3D;&quot;dns.msftncsi.com&quot;  &quot;query&#123;&#125;&quot;!&#x3D;&quot;*.globalrootservers.net&quot; 
| table  src_ip,dest_ip,query&#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/jzPkKSf2XPhZ_kdZBN_vHdWs9SodRqw0Hdol4W8JsjY=.png"></p>
<p>é€™é‚Šå¯ä»¥çœ‹åˆ° cerberhhyed5frqa.xmfir0.win é€™å€‹ FQDNï¼Œè€Œé€™å€‹ç¶²å€åœ¨æƒ…å¢ƒçš„åœ–ç‰‡ä¸Šæœ‰å‡ºç¾ï¼Œå› æ­¤æ˜¯é€™é¡Œçš„ç­”æ¡ˆ</p>
<blockquote>
<p>ans : cerberhhyed5frqa.xmfir0.win</p>
</blockquote>
<hr>
<blockquote>
<p>Q22 : Ransomware: What was the most likely IP address of we8105desk in 24AUG2016?</p>
</blockquote>
<p>é¡Œç›®æƒ³è¦å• we8105desk é€™å€‹ host å®ƒæœ€æœ‰å¯èƒ½çš„ IP ä½ç½®æ˜¯ä»€éº¼ï¼Œæ™‚é–“é™åˆ¶åœ¨2016&#x2F;08&#x2F;24 ä¸­</p>
<p>é¦–å…ˆå…ˆä¾†èª¿æ•´æ™‚é–“ï¼Œé¸æ“‡æ™‚é–“ä¸¦é¸æ“‡ DataRangeï¼Œèª¿æ•´ç‚ºæŸ¥è©¢08&#x2F;24&#x2F;2016 åˆ° 08&#x2F;25&#x2F;2016é€™æ®µæ™‚é–“çš„è³‡æ–™</p>
<p><img src="/assets/l1jatLA2J8_nIfT-W0ySlWGVeQuBHTsKq6ZrZNWqTms=.png"></p>
<p>æ¥ä¸‹ä¾†æŸ¥è©¢ host ç‚º we8105desk çš„ source IP è¨˜éŒ„ï¼Œå› ç‚ºæ˜¯æŸ¥è©¢ Sysmon ä¾†æºçš„é—œä¿‚æ‰€ä»¥æ˜¯ä½¿ç”¨ SourceIp ç•¶ä½œæŸ¥è©¢ä¾†æº IP</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 host&#x3D;we8105desk source&#x3D;WinEventLog:Microsoft-Windows-Sysmon&#x2F;Operational
| stats count by SourceIp 
| sort -count<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/ZXDBGmZerwfzhgg20VYhTIab7F3el5JViBuBlzlz1qk=.png"></p>
<p>é€™é‚Šå¯ä»¥çœ‹åˆ°ç­”æ¡ˆæ˜¯ 192.168.250.100</p>
<blockquote>
<p>ans : 192.168.250.100</p>
</blockquote>
<hr>
<blockquote>
<p>Q23 : Ransomware: Amongst the Suricata signatures that detected the Cerber malware, which one alerted the fewest number of times? Submit ONLY the signature ID value as the answer. (No punctuation, just 7 integers.)</p>
</blockquote>
<p>é€™é¡Œæƒ³è¦å• Suricata ç”¢ç”Ÿçš„è­¦å ±ï¼Œç•¶ä¸­é—œæ–¼ Cerber malware å‡ºç¾æœ€å°‘çš„ signature æ˜¯å“ªä¸€å€‹</p>
<p>å¯ä»¥ç”¨ä»¥ä¸‹çš„èªæ³•æŸ¥è©¢ï¼Œå°‡ signature èˆ‡ signature_id æŠ“å‡ºä¾†</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;suricata Cerber 
| table alert.signature alert.signature_id<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/SUW4b8xNVYYgib6Y3L8SLD1NeyFdmlv0pC-9KT0GKzc=.png"></p>
<p>å¯ä»¥å¾ˆæ˜é¡¯çš„çœ‹åˆ° <code>ETPRO TROJAN Ransomware/Cerber Checkin 2</code> é€™å€‹ signature åªå‡ºç¾ä¸€æ¬¡ï¼Œè€Œå®ƒçš„ id ç‚º2816763 ï¼Œå‰‡ç‚ºç­”æ¡ˆ</p>
<blockquote>
<p>ans : 2816763</p>
</blockquote>
<hr>
<blockquote>
<p>Q24 : Ransomware: The VBScript found in question 25 launches 121214.tmp. What is the ParentProcessId of this initial launch?</p>
</blockquote>
<p>é€™é¡Œéœ€è¦å…ˆQ25ï¼Œå¯ä»¥å…ˆå»çœ‹ Q25 çš„è§£é¡Œéç¨‹</p>
<p>é¡Œç›®æ•˜è¿°èªªåœ¨Q25 æ‰¾åˆ° é—œæ–¼VBScript æ˜¯ 121214.tmpè¢«åŸ·è¡Œäº†ï¼Œè«‹å•å•Ÿå‹•é€™å€‹VBScript çš„çˆ¶é€²ç¨‹ ID æ˜¯ä»€éº¼ï¼Ÿ</p>
<p>å¯ä»¥å…ˆå°‡ParentImageã€ParentProcessIdä»¥åŠCommandLine æŠ“å‡ºä¾†æŸ¥çœ‹</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;xmlwineventlog *.vbs
| table ParentImage ParentProcessId CommandLine<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/cn-02vrj7Ro2hRDX_3l34zNpoDpJ3d--i0_5yj-7Lyo=.png"></p>
<p>é€™é‚Šå¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°å•Ÿå‹•121214.tmp çš„çˆ¶é€²ç¨‹æ˜¯ wscript.exe ï¼Œå®ƒçš„ID ç‚º3968ï¼Œé€™æ­£æ˜¯æˆ‘å€‘çš„ç­”æ¡ˆ</p>
<blockquote>
<p>ans : 3968</p>
</blockquote>
<hr>
<blockquote>
<p>Q25 : Ransomware: During the initial Cerber infection a VB script is run. The entire script from this execution, pre-pended by the name of the launching .exe, can be found in a field in Splunk. What is the length in characters of the value of this field?</p>
</blockquote>
<p>é¡Œç›®æ•˜è¿°èªªç•¶ Cerber æƒ¡æ„ç¨‹å¼åŸ·è¡Œæ™‚ï¼Œåˆå§‹æœƒå…ˆåŸ·è¡Œ VB scriptï¼Œè€Œé€™å€‹ VB script çš„ç”¢ç”ŸåŒ…å«å‰é¢å•Ÿå‹•å®ƒçš„ exe æª” å¯ä»¥åœ¨ Splunk çš„å…¶ä¸­ä¸€å€‹æ¬„ä½æ‰¾åˆ°ï¼Œæœ€å¾Œå•é€™å€‹æ¬„ä½è£¡é¢çš„å€¼ç¸½å…±æœ‰å¤šå°‘ characters</p>
<p>çœ‹åˆ°é¡Œç›®æ•˜è¿°ï¼Œå¯ä»¥ç›´æ¥è¯æƒ³åˆ°çš„æ˜¯ CommandLine æ¬„ä½ï¼Œæ‰€ä»¥æˆ‘å€‘å…ˆæŠŠ EventLog çš„ CommandLine æ¬„ä½æŠ“å‡ºä¾†ï¼Œä¸¦ä¸”é™åˆ¶æª”åç‚º .vbs</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;xmlwineventlog *.vbs
| table CommandLine<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/48ggord4P-7U5Euy77ESb7wgPZPyzklMo8loEzzXW_M=.png"></p>
<p>å¯ä»¥çœ‹åˆ°ä¸‹é¢ä¸€å¤§ä¸²çš„ cmd.exeâ€¦â€¦.. ä¸¦ä¸”å¾Œé¢æ¥ <code>GSI=%APPDATA%\%RANDOM%.vbs</code> é€™é‚Šå°±å¯ä»¥ç¢ºå®šæ˜¯é¡Œç›®æ‰€èªªã€‚</p>
<p>æ¥ä¸‹ä¾†è¦è¨ˆç®—è£¡é¢æœ‰å¤šå°‘å­—å…ƒï¼Œä½¿ç”¨çš„æ˜¯ eval çš„ len å‡½å¼</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;xmlwineventlog *.vbs
| eval cmdlenght&#x3D;len(CommandLine)
| table CommandLine cmdlenght<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/NsHJjeRVHk2NQIl9gw8oRwmXM2WSI3lcQOAvMZljaoU=.png"></p>
<p>é€™é‚Šå®ƒå¹«æˆ‘å€‘è¨ˆç®—å‡ºç­”æ¡ˆç‚º4490</p>
<blockquote>
<p>ans : 4490</p>
</blockquote>
<hr>
<blockquote>
<p>Q26 : Ransomware: The malware downloads a file that contains the Cerber ransomware crypto code. What is the name of that file?</p>
</blockquote>
<p>é¡Œç›®æ•˜è¿°èªªæƒ¡æ„ç¨‹å¼å»ä¸‹è¼‰ä¸€å€‹åŒ…å« Cerber å‹’ç´¢ç—…æ¯’åŠ å¯†ç¨‹å¼ç¢¼çš„æª”æ¡ˆï¼Œå®ƒçš„æª”æ¡ˆåç¨±æ˜¯ä»€éº¼</p>
<p>æˆ‘å…ˆæŠŠ 192.168.250.100 (we8105desk) HTTP çš„ GET è«‹æ±‚å…¨éƒ¨å…ˆæŠ“ä¸‹ä¾†</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 source&#x3D;&quot;stream:http&quot; src_ip&#x3D;192.168.250.100 http_method&#x3D;GET
| table  src_ip,dest_ip,site,src_headers<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/tO3hZ1-M67gHdIfdlzVWlYr4RjE5w5rVxvEXMrR_Ns4=.png"></p>
<p>ç•¶ä¸­æœ€å¯ç–‘çš„æ˜¯å®ƒå‘ <code>solidaritedeproximite.org</code> è«‹æ±‚ä¸€å€‹ mhtr.jpg æª”æ¡ˆ</p>
<p>æˆ‘å€‘å–®ç¨çœ‹ä¸€ä¸‹é—œæ–¼æœ‰åŒ…å« mhtr.jpg çš„è¨˜éŒ„</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 mhtr.jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/3qLVjpkrNx1j5OKEazxyKyRjn6aJd4IHKxs2-Th5SSQ=.png"></p>
<p>ç™¼ç¾åˆ°æœ‰ <code>fgt_utm</code> çš„è¨˜éŒ„è·³å‡ºä¾†ï¼Œåœ¨ Splunk ä¸­é€šå¸¸æŒ‡çš„æ˜¯ä¾†è‡ª FortiGate é˜²ç«ç‰†çš„ Unified Threat Management å®‰å…¨æ—¥èªŒé¡å‹çš„ sourcetypeï¼Œç”¨ä¾†è¨˜éŒ„é˜²æ¯’ã€å…¥ä¾µé˜²ç¦¦ã€ç¶²é éæ¿¾ç­‰å®‰å…¨äº‹ä»¶ã€‚</p>
<p>æˆ‘å€‘ä½¿ç”¨ fgt_utm è¨˜éŒ„ï¼Œä¸¦æŠŠ filename,msg,analyticscksum æ¬„ä½æŠ“å‡ºä¾†</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;&quot;fgt_utm&quot; mhtr.jpg
| table filename,msg,analyticscksum<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/wX3qtK3vMoJ_wBsisJ0D4TGBsSh3WWWES9-kVGMwxwM=.png"></p>
<p>å¯ä»¥çœ‹åˆ°å®ƒåµæ¸¬ mhtr.jpg ç‚ºæƒ¡æ„æª”æ¡ˆï¼Œä¸¦ä¸”æœ‰ sha256 çµ¦æˆ‘å€‘ï¼Œæˆ‘å€‘å°‡å®ƒä¸Ÿå…¥ <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/9c1cabc16826273ad69f59af06f12fe6484e2eb0b5d3c87a690993934675e459">VirusTotal</a></p>
<p><img src="/assets/KjYcIdDLUwD5_-oBYnxh2l1kwJn7bt6Nrmb71pDr14E=.png"></p>
<p>å¯ä»¥çœ‹åˆ°å®ƒæ˜¯æƒ¡æ„ç¨‹å¼ï¼Œé‚£ mhtr.jpg å°±æ˜¯æˆ‘å€‘çš„ç­”æ¡ˆ</p>
<blockquote>
<p>ans : mhtr.jpg</p>
</blockquote>
<hr>
<blockquote>
<p>Q27 : Ransomware: Now that you know the name of the ransomwareâ€™s encryptor file, what obfuscation technique does it likely use?</p>
</blockquote>
<p>é¡Œç›®å• mhtr.jpg ä½¿ç”¨äº†ä½•ç¨®æ··æ·†æŠ€è¡“</p>
<p>jpg å¯ä»¥è¢«è¾¨è­˜å‡ºæƒ¡æ„ç¨‹å¼ï¼Œæœ‰å¾ˆå¤§çš„å¯èƒ½ä½¿ç”¨äº†éš±å¯«è¡“ (Steganography)ï¼Œå°‡æƒ¡æ„ç¨‹å¼éš±è—åœ¨åœ–ç‰‡ä¸­ï¼Œå› æ­¤ç­”æ¡ˆå°±æ˜¯ Steganography</p>
<blockquote>
<p>ans : Steganography</p>
</blockquote>
<hr>
<blockquote>
<p>Q28 : Ransomware: What is the name of the USB key inserted by Bob Smith?</p>
</blockquote>
<p>é¡Œç›®å• Bob Smith æ’å…¥çš„ USB åç¨±æ˜¯ä»€éº¼</p>
<p>åœ¨ Splunk ä¸­æä¾›äº†ä¸€å€‹ sourcetypeï¼Œåç¨±ç‚º winregistryï¼Œç”¨ä¾†ç›£æ§ Windows è¨»å†Šè¡¨ keyï¼value çš„å»ºç«‹ã€ä¿®æ”¹ã€åˆªé™¤ç­‰æ“ä½œã€‚</p>
<p>å¦å¤–é—œæ–¼ USB çš„å…¶ä¸­ä¸€å€‹è¨»å†Šè¡¨è·¯å¾‘æœƒåœ¨ <code>SYSTEM\ControlSet001\USBSTOR</code>ï¼Œä¸»è¦ç”¨é€”æ˜¯è¨˜éŒ„æ›¾ç¶“é€£æ¥éçš„ USB è£ç½®è³‡è¨Šï¼Œä¾‹å¦‚è£½é€ å•†ã€ç”¢å“ã€åºè™Ÿã€FriendlyName ç­‰ç­‰</p>
<p>å› æ­¤æˆ‘å€‘å°‡ <code>USBSTOR</code> åº•ä¸‹çš„ value æŠ“å‡ºä¾†ï¼Œä¸¦ä¸”ç”¨ dedup å°‡é‡è¤‡çš„ value åˆªé™¤ï¼Œåªä¿ç•™ç¬¬ä¸€ç­†å‡ºä¾†çš„å€¼</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 source&#x3D;&quot;winregistry&quot; host&#x3D;we8105desk USBSTOR
| table registry_value_data | dedup registry_value_data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/B7j-ZowtUGr4m3r3GkRhOsm_eHvyijuT3v9bNfFIRzM=.png"></p>
<p>é€™é‚Šå°±å¯ä»¥çœ‹åˆ° USB çš„åç¨±ç‚º MIRANDA_PRI</p>
<blockquote>
<p>ans : MIRANDA_PRI</p>
</blockquote>
<hr>
<blockquote>
<p>Q29 : Ransomware: Bob Smithâ€™s workstation (we8105desk) was connected to a file server during the ransomware outbreak. What is the IP address of the file server?</p>
</blockquote>
<p>é¡Œç›®æ•˜è¿° Bob Smithâ€™s workstation åœ¨ ransomware åŸ·è¡ŒæœŸé–“å»é€£ç·šäº† file serverï¼Œè«‹å• file server çš„ IP æ˜¯ä»€éº¼ï¼Ÿ</p>
<p>é€£ç·š file server çš„ protocol å¯èƒ½æœƒæœ‰ SMB æˆ–è€… FTPï¼ŒFTP æ˜¯ç©ºçš„ï¼Œé‚£æˆ‘å€‘å¯ä»¥è‘—é‡å»çœ‹ SMB</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;&quot;stream:smb&quot; src_ip&#x3D;192.168.250.100
| table dest_ip
| dedup dest_ip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/yOqGwKrU-ZM7IjAYNdpFOfs2S1L4Z0hW5ixVwDSsEIU=.png"></p>
<p>æ¥ä¸‹ä¾†è¦å†æ›´ç¢ºèªä¸€é»ï¼Œfile server å¯èƒ½æœƒé€²è¡Œç™»å…¥ï¼Œå› æ­¤æˆ‘å€‘åŠ ä¸Š login&#x3D;â€bob.smithâ€</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;&quot;stream:smb&quot; src_ip&#x3D;192.168.250.100 login&#x3D;&quot;bob.smith&quot;
| table dest_ip
| dedup dest_ip<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="/assets/9yawfJ9r2QGw0qUBPTIYITVz6gXLxAQGGFcAJeFblNM=.png"></p>
<p>é€™æ¨£å°±ç¢ºå®šäº† 192.168.250.20 æ˜¯ file server </p>
<blockquote>
<p>ans : 192.168.250.20</p>
</blockquote>
<hr>
<blockquote>
<p>Q30 : Ransomware: How many distinct PDFs did the ransomware encrypt on the remote file server?</p>
</blockquote>
<p>é¡Œç›®å•æœ‰å¤šå°‘å€‹é ç«¯ pdf è¢«åŠ å¯†äº†</p>
<p>æˆ‘å€‘åœ¨ä¸Šä¸€é¡ŒçŸ¥é“ file server çš„ IP ç‚º 192.168.250.20ï¼Œæˆ‘å€‘å¦å¤–å…ˆæ‹¿ä¸€ä¸‹å®ƒçš„ domain name</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;&quot;stream:smb&quot; src_ip&#x3D;192.168.250.100 dest_ip&#x3D;192.168.250.20 path&#x3D;*
| table path<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/qEWsjAJB7FUV9Mq7acGsjdBlmDRUI1hj8Kd1x4wE9uo=.png"></p>
<p>é€™é‚Šå¾—çŸ¥äº† domain name ç‚º we9041srv.waynecorpinc.local</p>
<p>é¦–å…ˆæˆ‘å…ˆæœå°‹ wineventlog ä¸­æœ‰æ²’æœ‰é—œæ–¼ .pdf çš„è¨˜éŒ„</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;&quot;wineventlog&quot; *.pdf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/xJ0cOJW0DDg-M8pGh77C8_DVq-sVjUcXcwSXEbI-zOM=.png"></p>
<p>ç™¼ç¾åˆ°æœ‰ï¼Œä¸¦ä¸”æ˜¯å¾ 192.168.250.100 è«‹æ±‚ we9041srv.waynecorpinc.local çš„ä¸€å€‹ pdf<br>å› æ­¤æˆ‘å€‘å°‡æ‰€æœ‰é—œæ–¼é€™å€‹çš„è¨˜éŒ„æŠ“ä¸‹ä¾†ï¼Œä¸¦ç”¨ stats ä¸­çš„ dc å¹«æˆ‘å€‘ç®—ç¸½å…±æœ‰å¹¾å€‹æª”æ¡ˆ</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 sourcetype&#x3D;&quot;wineventlog&quot; *.pdf  EventCode&#x3D;5145 Source_Address&#x3D;192.168.250.100
| stats dc(Relative_Target_Name)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/B-ZLsIdRUo5P-2poxSx5cJ8Qark7Byogq2TCf8i5JyU=.png"></p>
<p>ç¸½å…±æ˜¯ 257 å€‹ï¼Œå‰‡ 257 ç‚ºç­”æ¡ˆ</p>
<blockquote>
<p>ans : 257</p>
</blockquote>
<hr>
<blockquote>
<p>Q31 : Ransomware: The Cerber ransomware encrypts files located in Bob Smithâ€™s Windows profile. How many .txt files does it encrypt?</p>
</blockquote>
<p>é€™é¡Œå•çš„æ˜¯åœ¨ Bob Smith çš„é›»è…¦ä¸Šæœ‰å¤šå°‘çš„ .txt æª”è¢« ransomware é–èµ·ä¾†äº†</p>
<p>é¦–å…ˆæˆ‘å€‘å…ˆä½¿ç”¨ Sysmon å°‡é‡å° Bob Smith å…§çš„ .txt çš„æ“ä½œæŠ“ä¸‹ä¾†ï¼Œä¸¦ä¸”çœ‹æ˜¯å“ªå€‹æª”æ¡ˆå° .txt æ“ä½œ</p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 source&#x3D;&quot;wineventlog:microsoft-windows-sysmon&#x2F;operational&quot; TargetFilename&#x3D;&quot;C:\\Users\\bob.smith.WAYNECORPINC\\*.txt&quot;
| table Image TargetFilename<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="/assets/aslGsxq9wbcm5wT5VeqfAuUnScwW0MXR-gC6Kb-YIZs=.png"></p>
<p>å¯ä»¥çœ‹åˆ°æ˜¯æœ‰ä¸€å€‹ osk.exe å° .txt æª”åšæ“ä½œï¼Œ</p>
<p>é‚£æˆ‘å€‘å¯ä»¥ EventID&#x3D;1 å»çœ‹é€™å€‹ osk.exe çš„ hash </p>
<pre class="line-numbers language-none"><code class="language-none">index&#x3D;botsv1 source&#x3D;&quot;wineventlog:microsoft-windows-sysmon&#x2F;operational&quot; EventCode&#x3D;1 Image&#x3D;&quot;C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\&#123;35ACA89F-933F-6A5D-2776-A3589FB99832&#125;\\osk.exe&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/bGRAyITwgDbzGkIxST7PVBbBAzYcou8g5XtO2PGhEQs=.png"></p>
<p>å¾—åˆ°çš„ MD5 hash ç‚º <a target="_blank" rel="noopener" href="https://189ccf15-ac01-4578-b319-8cf69e039163.cyberdefenders.network/en-US/app/search/search?q=search%20index=botsv1%20source=%22wineventlog:microsoft-windows-sysmon/operational%22%20EventCode=1%20Image=%22C:%5C%5CUsers%5C%5Cbob.smith.WAYNECORPINC%5C%5CAppData%5C%5CRoaming%5C%5C%7B35ACA89F-933F-6A5D-2776-A3589FB99832%7D%5C%5Cosk.exe%22&display.page.search.mode=smart&dispatch.sample_ratio=1&workload_pool=&earliest=0&latest=now&display.page.search.tab=events&display.general.type=events&sid=1760368198.162#">EE0828A4E4C195D97313BFC7D4B531F1</a>ï¼Œä¸Ÿé€²çµ¦ <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/37397f8d8e4b3731749094d7b7cd2cf56cacb12dd69e0131f07dd78dff6f262b">VirusTotal</a> å¾Œ</p>
<p><img src="/assets/wqQ9cuHeud9mqmV_is1wvugWnlvXxOlf-VlSPy-RNGE=.png"></p>
<p>å¯ä»¥ç¢ºå®šå®ƒæ˜¯æƒ¡æ„ç¨‹å¼</p>
<p>æ¥ä¸‹ä¾†é‡å°é€™å€‹ osk.exe å»è¨ˆç®—æ‰€æœ‰ .txt çš„æ•¸é‡</p>
<p><img src="/assets/gRO7TyyW0T3ZEP7-XUY6yZMG1GJPKE-N3D7Njwya-34=.png"></p>
<p>ç­”æ¡ˆå‡ºä¾†ç‚º 406ï¼Œå‰‡ 406 ç‚ºé€™é¡Œçš„ç­”æ¡ˆ</p>
<blockquote>
<p>ans : 406</p>
</blockquote>
<hr>
<blockquote>
<p>Q32 : Ransomware: What was the first suspicious domain visited by we8105desk in 24AUG2016?</p>
</blockquote>
<p>é¡Œç›®å• we8105desk åœ¨ 2016&#x2F;08&#x2F;24 æ™‚è¨ªå•äº†å“ªå€‹å¯ç–‘ domainï¼Ÿ</p>
<p>æˆ‘å€‘åœ¨ Q26 ä¸­ç™¼ç¾å®ƒæœƒå»å‘ <code>solidaritedeproximite.org</code> è«‹æ±‚ jpg æª”ï¼Œè€Œ <code>solidaritedeproximite.org</code> å‰‡ç‚ºé€™é¡Œçš„è§£ç­”ã€‚</p>
<blockquote>
<p>ans : solidaritedeproximite.org</p>
</blockquote>
<hr>
<h1 id="ç¸½çµ"><a href="#ç¸½çµ" class="headerlink" title="ç¸½çµ"></a>ç¸½çµ</h1><p>ä»Šå¤©æŠŠ Boss Of The SOC v1 æœ€å¾Œå¹¾é¡Œé¡Œç›®åˆ†äº«å®Œäº†ï¼Œä»Šå¤©ä¹Ÿå­¸åˆ°äº†æ›´å¤š Threat Hunting çš„æŠ€å·§ï¼Œé€™å ´ Boss Of The SOC v1 æˆ‘è¦ºå¾—é¡Œç›®éƒ½å‡ºå¾—å¾ˆå¥½ï¼Œéƒ½å¯ä»¥å­¸åˆ°éå¸¸å¤šçš„æ±è¥¿ï¼Œé™¤äº† v1 ä¹‹å¤–ä¹Ÿæœ‰ v2ã€v3ï¼Œæ­¡è¿å¤§å®¶å¯ä»¥æŒ‘æˆ°ã€‚</p>
</div></article></div></main><footer><div class="paginator"></div><div class="copyright"><p>Â© 2025 - 2026 <a href="https://yunshiuan.com">yunshiuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-clike.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cpp.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
</script><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>