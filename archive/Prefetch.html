<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 我偷看了你的 Prefetch，它告訴我你開過什麼 · yunshiuan</title><meta name="description" content="我偷看了你的 Prefetch，它告訴我你開過什麼 - yunshiuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/assets/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yunshiuan.com/atom.xml" title="yunshiuan"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="yunshiuan" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/assets/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="https://github.com/YunshiuanOAO" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/assets/CV.pdf" target="_self" class="nav-list-link">CV</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">我偷看了你的 Prefetch，它告訴我你開過什麼</h1><div class="post-info">Oct 5, 2025</div><div class="post-content"><h1 id="🧂-前言"><a href="#🧂-前言" class="headerlink" title="🧂 前言"></a>🧂 前言</h1><p>今天會分享在 Windows 底下的 Prefetch 資料夾內的檔案有什麼功能，以及如何使用 PECmd 分析，可以帶給鑑識人員什麼資訊</p>
<hr>
<h1 id="Prefetch-是什麼？"><a href="#Prefetch-是什麼？" class="headerlink" title="Prefetch 是什麼？"></a>Prefetch 是什麼？</h1><p>位置：<code>%WinDir%\prefetch</code></p>
<p>Prefetch（.pf）是 Windows 為了加速程式啟動而維護的快取檔案。系統會在 <code>%WinDir%\prefetch</code> 路徑下為執行過的可執行檔建立 .pf 檔，裡面包含：</p>
<ol>
<li><strong>執行時間戳</strong>：Windows 8 以後的 Prefetch 能記錄多達 8 個執行時間點，可用來建立事件時間線，另外 Prefetch 的時間戳在精確到秒時通常要減掉 10 秒，在做精細時間對帳時要留意此差異，<a target="_blank" rel="noopener" href="https://www.thedfirspot.com/post/artifacts-of-execution-i-know-what-you-did-last-incident?utm_source=chatqpt.com">參考網址</a>。 </li>
<li><strong>Run count</strong>：表示該程式被執行了多少次。 </li>
<li><strong>可執行檔名稱與路徑</strong>：指出實際被執行的檔案與來源路徑，對判斷惡意軟體的落點很重要。 </li>
<li><strong>程式啟動時存取過的檔案清單</strong>：有時會列出其他被呼叫或載入的 DLL、路徑，可用來找出程式的行為鏈，例如開啟哪些檔。 </li>
<li><strong>volume &#x2F; system info、執行檔雜湊等元資料</strong>：可用來確認是在哪個 volume &#x2F; 機器上被執行</li>
</ol>
<p>檔名通常會長得像 PROGRAM.EXE-XXXXXXXX.pf，後面的 8 字元為路徑雜湊，用來區分相同名稱但路徑不同的執行檔。</p>
<p><img src="/assets/Kq6MvDG5ev05EwQcxGDnrfk7YXkBzYtWCCX0F1_nnas=.png"></p>
<p>為了讀取裡面的資料，可以使用 Eric Zimmerman’s tools 當中的 PECmd 轉換成 CSV 檔</p>
<hr>
<h2 id="PECmd"><a href="#PECmd" class="headerlink" title="PECmd"></a>PECmd</h2><p>下載連結：<a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">https://ericzimmerman.github.io/#!index.md</a></p>
<p>PECmd 是由 Eric Zimmerman 開發的一個命令行工具，它的目的是解析 Windows 的 Prefetch 檔案（.pf），抽取其中的 metadata（如執行時間戳、執行次數、被參照的檔案清單等），以便用於鑑識分析</p>
<p>有一個很方便的功能是可以使用以下指令批量處理 Prefetch 裡面的所有檔案，並把它們合成一個 CSV 檔</p>
<pre class="line-numbers language-none"><code class="language-none">.\PECmd.exe -d C:\Users\yunshiuan\Desktop\The_Enduring_Echo\C\Windows\prefetch --csv &quot;C:\Users\yunshiuan\Desktop\output&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/YZQ4eHTHNW2nzsMq1S9CPq9H7CPp6_8kzmD9OzCkXTM=.png"></p>
<p>如果想要單獨轉換某個 .pf 檔的話可以使用 <code>-f</code> </p>
<p>接下來就會在 output 中出現轉換好的 CSV 檔</p>
<p><img src="/assets/vN3s7s5Ir8f6bWh_K-OBrUFXzhTtEFEzoj7px-EMmh8=.png"></p>
<p>可以使用 <a target="_blank" rel="noopener" href="https://ericzimmerman.github.io/#!index.md">Timeline Explorer</a> 或者其他查看 CSV 檔的軟體查看</p>
<p><img src="/assets/IZtn-xPIIX5IwNcA-FIRxiwXk3Aqu-eJfzpZnmt-W-Q=.png"></p>
<p>假設我想要知道 cmd.exe 執行了幾次，直接按照剛剛的步驟並搜尋 cmd.exe，發現它執行了 26 次</p>
<p><img src="/assets/EWcRoavCJbqZQ7VouNsE-FHXlJrmgvL1A8hxDCCG750=.png"></p>
<hr>
<h1 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h1><p>今天介紹了 Prefetch 的功用以及可以利用 Prefetch 去得知什麼線索，透過這些 .pf 檔案，我們可以看到哪個程式被執行過、從哪裡執行、跑了幾次，並利用了 PECmd 將這些 Prefetch 檔案轉成可以看懂的 CSV 樣式，明天繼續介紹其他可以分析的地方</p>
</div></article></div></main><footer><div class="paginator"></div><div class="copyright"><p>© 2025 - 2026 <a href="https://yunshiuan.com">yunshiuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-clike.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cpp.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
</script><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>