<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 尋找蟑螂是不是也算是一種威脅狩獵？ · yunshiuan</title><meta name="description" content="尋找蟑螂是不是也算是一種威脅狩獵？ - yunshiuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/assets/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yunshiuan.com/atom.xml" title="yunshiuan"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="yunshiuan" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/assets/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="https://github.com/YunshiuanOAO" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/assets/CV.pdf" target="_self" class="nav-list-link">CV</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">尋找蟑螂是不是也算是一種威脅狩獵？</h1><div class="post-info">Oct 10, 2025</div><div class="post-content"><p>現在科技持續進步的時代，網路架構與技術越來越複雜，攻擊也越來越精密，如果只是依賴原有的自動化工具去達成防禦效果，常常還是會有漏網之魚，因此今天會分享什麼是 Threat Hunting，以及在 Threat Hunting 中會需要使用到什麼技術或工具。</p>
<hr>
<h1 id="🔫-Threat-Hunting"><a href="#🔫-Threat-Hunting" class="headerlink" title="🔫 Threat Hunting"></a>🔫 Threat Hunting</h1><p>傳統的資安防禦方式是使用自動化工具（如：防火牆、IDS&#x2F;IPS）去偵測已知攻擊行為，像是病毒特徵碼、惡意 IP 或異常登入，如果自動化工具偵測到就會發送警報，資安人員接收到後就開始進行處理。</p>
<p>而 Threat Hunting 是一個<strong>主動式</strong>的防禦，資安人員會主動去看 SIEM（安全資訊與事件管理）或各式數據，分析可疑行為，而不是等警報出現才處理；分析過程會根據自己假設的攻擊情境或威脅情資，檢視日誌（Log）或網路流量（Network Traffic）。</p>
<p>例如：</p>
<ul>
<li>近期 PowerShell 活動量增加，由於攻擊者常利用 PowerShell 進行偵查、橫向移動或憑證竊取，會不會是遭受到了什麼攻擊？<ul>
<li>查詢 Event ID 4104（Script Block Logging） 的記錄</li>
</ul>
</li>
<li>如果近期某個漏洞被廣泛利用，我們的系統會不會也正遭到相同的攻擊？<ul>
<li><a target="_blank" rel="noopener" href="https://nvd.nist.gov/vuln/detail/cve-2021-44228">Log4Shell (CVE-2021-44228)</a></li>
<li>檢查是否有連接到可疑的 LDAP 或 RMI 伺服器</li>
<li>搜尋包含 <code>$&#123;jndi:</code> 字串的日誌記錄</li>
<li>查詢 Event ID 4688（Process Creation） 包含 <code>java</code> 且父進程是 Web 應用程式</li>
<li>搜尋是否有可疑的 .class 或 .jar 檔案被建立</li>
</ul>
</li>
</ul>
<p>如果發現蒐集到的證據使假設成立，會需要進一步地解析整個攻擊流程，後續也需要進行相關的處理，包括啟動事件回應程序、通報相關單位、隔離與清除威脅以及事件後檢討，但如果假設沒有成立，也可以當作一次經驗參考。</p>
<p>整體來說可以發現 Threat Hunting 的基本流程是 Trigger&#x2F;Hypotheses（從異常&#x2F;已知行為或威脅情資建立假設）→ Investigation（蒐集證據）→ Uncover（進一步分析）→ Inform &amp; Enrich，並且在威脅狩獵中這流程會持續循環。</p>
<p><img src="/assets/of-U2Ye_YQ9AateRbdTn0JX6zAyJ2iWWj6YU5isWn3o=.png"></p>
<p>source : <a target="_blank" rel="noopener" href="https://www.nist.gov/system/files/documents/2017/04/20/2017-04-10_-_sqrrl_enterprise.pdf">NIST</a></p>
<hr>
<p>在威脅狩獵的過程中會需要站在攻擊者的角度思考，<strong>MITRE ATT&amp;CK 框架</strong>可以很好地幫助我們預測攻擊者的下一步，並建立更精準的獵捕策略。</p>
<h1 id="MITRE-ATT-CK"><a href="#MITRE-ATT-CK" class="headerlink" title="MITRE ATT&amp;CK"></a>MITRE ATT&amp;CK</h1><p>網站：<a target="_blank" rel="noopener" href="https://attack.mitre.org/">https://attack.mitre.org/</a></p>
<p>MITRE ATT&amp;CK (Adversarial Tactics, Techniques, and Common Knowledge) 是一個全球可存取、基於現實世界觀察的網路對手戰術和技術知識庫。它由 MITRE 公司開發，旨在幫助資安專業人員更好地理解、檢測和防禦網路攻擊。</p>
<p>這個框架將攻擊行為分為三個層級：</p>
<ul>
<li><strong>Tactics（戰術）</strong>：攻擊者在特定階段的目標</li>
<li><strong>Techniques（技術）</strong>：達成該目標的方法。</li>
<li><strong>Sub-Techniques（子技術）</strong>：更細節的具體實作方式。</li>
</ul>
<p><img src="/assets/UdPk5OTiE-5Q08137RurBVranBuDvwPROyjrNzk0N5A=.png"></p>
<p>以下介紹常見的 ATT&amp;CK 戰術範例</p>
<table>
<thead>
<tr>
<th><strong>Initial Access（初始存取）</strong></th>
<th>攻擊者如何進入你的系統或網路</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Execution（執行）</strong></td>
<td>攻擊者如何執行惡意程式碼</td>
</tr>
<tr>
<td><strong>Persistence（持久化）</strong></td>
<td>攻擊者如何維持長期存取</td>
</tr>
<tr>
<td><strong>Discovery（探索）</strong></td>
<td>攻擊者如何蒐集環境資訊</td>
</tr>
<tr>
<td><strong>Privilege Escalation（權限提升）</strong></td>
<td>攻擊者如何取得更高權限</td>
</tr>
<tr>
<td><strong>Lateral Movement（橫向移動）</strong></td>
<td>攻擊者如何在網路內擴散</td>
</tr>
<tr>
<td><strong>Command and Control（C2 控制）</strong></td>
<td>攻擊者如何遠端操控受害系統</td>
</tr>
<tr>
<td><strong>Exfiltration（資料外洩）</strong></td>
<td>攻擊者如何竊取資料</td>
</tr>
</tbody></table>
<p>這邊舉昨天提到的釣魚攻擊為例，釣魚攻擊屬於 Initial Access 分類中的 Techniques，編號為 <a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1566/">T1566</a>。</p>
<p><img src="/assets/u_yIEtavx4bbjApsHpG1TQ3Yqv1d7OrxjrxVS9oiCfI=.png"></p>
<p>點進後會進入到關於釣魚攻擊介紹以及它的 Sub-Techniques，像是關於釣魚信件中的惡意附件的子技術就是 T1566.001。</p>
<p><img src="/assets/bEXBHcsJGE2XMfRSaNVultYj33MSp9nVu5yqYKOyCO4=.png"></p>
<hr>
<p>一開始提到 Threat Hunting 的過程中會需要主動去看 SIEM，目前最常見的 SIEM 分別是 ELK 以及 Splunk。</p>
<h2 id="Elastic-Stack"><a href="#Elastic-Stack" class="headerlink" title="Elastic Stack"></a>Elastic Stack</h2><p>官網：<a target="_blank" rel="noopener" href="https://www.elastic.co/elastic-stack">https://www.elastic.co/elastic-stack</a></p>
<p>Elastic Stack 是一套在業界非常常用的日誌／資料搜尋、分析、可視化平台，Elastic Stack 是由三個開源工具的縮寫：Elasticsearch、Logstash、Kibana，並將這三者整合起來，另外 Elastic Stack是開源軟體。</p>
<p><img src="/assets/QGoCaXWy-l_hx5rXtdkXyElqXszPLW75psYcSr19bus=.png"></p>
<p><code>source: https://www.geeksforgeeks.org/software-engineering/what-is-elastic-stack-and-elasticsearch/</code></p>
<table>
<thead>
<tr>
<th><strong>元件</strong></th>
<th><strong>功能 &#x2F; 角色</strong></th>
<th><strong>特點補充</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>Elasticsearch</strong></td>
<td>搜索與分析引擎：負責儲存、索引與查詢資料</td>
<td>基於 Lucene，支援分散式架構、橫向擴展、近即時查詢。</td>
</tr>
<tr>
<td><strong>Logstash</strong></td>
<td>資料收集與轉換管道</td>
<td>從多個來源收資料、做過濾／解析／變換，然後輸出到 Elasticsearch 或其他目標。</td>
</tr>
<tr>
<td><strong>Kibana</strong></td>
<td>資料視覺化與探索介面</td>
<td>對 Elasticsearch 中的資料做查詢、分析、繪圖、做 Dashboard／報表。</td>
</tr>
</tbody></table>
<h2 id="Splunk"><a href="#Splunk" class="headerlink" title="Splunk"></a>Splunk</h2><p>官網連結：<a target="_blank" rel="noopener" href="https://www.splunk.com/zh/_tw">https://www.splunk.com/zh\_tw</a></p>
<p>Splunk 是一套專為機器產生資料（machine-generated data，如日誌、事件、度量、流量資料等）而設計的平台，能將這些資料進行接收、索引、搜尋、分析、視覺化。</p>
<p><img src="/assets/YV0SlHH_JnWflN_GVbRkyNQBowxdGQ7fZMEbWiEC6kk=.png"></p>
<p><code>source: https://www.splunk.com/zh_tw/products.html</code></p>
<p>接下來的三天我會使用 Splunk 進行 Threat Hunting 挑戰，題目會來自 Splunk 舉辦的 Boss Of The SOC，過程中也會介紹 Splunk 的使用方式。</p>
<h2 id="Boss-Of-The-SOC"><a href="#Boss-Of-The-SOC" class="headerlink" title="Boss Of The SOC"></a>Boss Of The SOC</h2><p>Boss Of The SOC (BOTS) 是 Splunk 舉辦的全球性網路安全競賽，這是一個基於真實世界攻擊場景的威脅狩獵競賽，參賽者需要在模擬的企業環境中識別、分析和回應各種網路攻擊。</p>
<p><img src="/assets/EZVoHdZRfHrOWC7SjpB6d75R399yqpqqNj5Z9dV2yow=.png"></p>
<p><a target="_blank" rel="noopener" href="https://www.wepro180.com/221130_splunkbots/">相關報導</a></p>
<hr>
<h1 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h1><p>今天分享了 Threat Hunting 的概念以及當中使用到的 MITRE ATT&amp;CK 與 SIEM 工具；接下來三天會透過 Boss Of The SOC 學習並分享 Threat Hunting 的詳細過程。</p>
</div></article></div></main><footer><div class="paginator"></div><div class="copyright"><p>© 2025 - 2026 <a href="https://yunshiuan.com">yunshiuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-clike.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cpp.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
</script><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>