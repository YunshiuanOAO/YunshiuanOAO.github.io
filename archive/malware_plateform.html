<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 我不只想要 VirusTotal，我全都要 · yunshiuan</title><meta name="description" content="我不只想要 VirusTotal，我全都要 - yunshiuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/assets/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yunshiuan.com/atom.xml" title="yunshiuan"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="yunshiuan" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/assets/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="https://github.com/YunshiuanOAO" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/assets/CV.pdf" target="_self" class="nav-list-link">CV</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">我不只想要 VirusTotal，我全都要</h1><div class="post-info">Oct 8, 2025</div><div class="post-content"><h1 id="🧂-前言"><a href="#🧂-前言" class="headerlink" title="🧂 前言"></a>🧂 前言</h1><p>當在 Disk 中或在 Memory 中抓到了一個惡意程式，可能會想要把它丟進 VirusTotal 網站去看是不是已知的惡意軟體，或者去分析它有 Drop 什麼檔案以及連接什麼 IP，但是有時候只看 VirusTotal 獲得到的資訊是不夠的，透過不同的分析網站比對可以獲得完整惡意程式資訊。</p>
<p>今天會分享包含 VirusTotal 在內的惡意軟體檢測與分析網站</p>
<hr>
<h1 id="VirusTotal"><a href="#VirusTotal" class="headerlink" title="VirusTotal"></a>VirusTotal</h1><p>連結：<a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/home/upload">https://www.virustotal.com/gui/home/upload</a></p>
<p>VirusTotal 是一個線上服務，讓使用者可以上傳檔案、URL、Domain、IP 或 Hash 進行分析，以檢測是否含有惡意軟體、惡意連結、釣魚等威脅，VirusTotal 內把多個防毒引擎、網頁掃描器、威脅情報來源彙整在一起，並且裡面會跑沙箱獲得惡意程式行為</p>
<p><img src="/assets/gMfDOnx2P7vfSTa0t39KTSF4X51TsNEZ1JieQp1GN9Y=.png"></p>
<p>使用方式是在上方的搜尋欄輸入 Hash、IP、Domain，或至上傳頁面上傳惡意程式</p>
<p><img src="/assets/wVcdSKbGTJgrc4GYZeCk1VWOvjD2NKPOKSYt9_s5xPg=.png"></p>
<p>這裡介紹一下 VirusTotal 分析完後提供的頁面資訊</p>
<h2 id="Detection"><a href="#Detection" class="headerlink" title="Detection"></a>Detection</h2><p>這個頁面提供了多家的 antivirus 引擎的偵測結果，會顯示出辨識的惡意程式家族與標籤</p>
<p><img src="/assets/z3PpmUJlTskTOc-_l2CYf5VAZNTDMKlxMQ3i28g1sos=.png"></p>
<h2 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h2><p>這個頁面會列出惡意程式的大小、型態、雜湊，以及編譯、修改時間</p>
<p><img src="/assets/tvFgDnMjsBkHGBDXWKh2CtBid7nsv75o1We8A6U8X1E=.png"></p>
<p>PE 結構（Sections、Imports&#x2F;Exports）、簽章資訊、字串等</p>
<p><img src="/assets/-yTNwLT3_1naezKvF3WWA6if8ccs7-ctpuBf63FxELQ=.png"></p>
<h2 id="Relations"><a href="#Relations" class="headerlink" title="Relations"></a>Relations</h2><p>這個頁面會列出惡意程式連線的 IP、Domain </p>
<p><img src="/assets/rGfLfkJ0NLPqqubsITDG8YcSD_oXKpVZ90nQ10vh7T0=.png"></p>
<p>以及執行惡意程式時產生的檔案</p>
<p><img src="/assets/hNljM3GQjeIAib7Jbc6JH5X6n9aESH8pVix3NyaGWp4=.png"></p>
<h2 id="Behavior"><a href="#Behavior" class="headerlink" title="Behavior"></a>Behavior</h2><p>這裡會列出惡意程式跑在多種沙箱中的行為</p>
<p><img src="/assets/FbaXPCeyc1-V85aF3NNLqvM8J-bA8NuaXak9nMfQ4d8=.png"></p>
<p>當中會有 Network 的分析</p>
<p><img src="/assets/OhyS62SmzrqyOeKDsNXGOIr1k3M7VSM5kGmzncOPy9M=.png"></p>
<p>當中也有檔案的操作，包含檔案開啟、修改、刪除、創建</p>
<p><img src="/assets/6-oZNV1IMKjgu5wbtjl5TjhnAu7kPSfdVJ4m-kjurNA=.png"></p>
<p>Process 的創建以及 Command 的記錄</p>
<p><img src="/assets/zJdkjUtwInk-OW6R7zFKZaWdJmPniYZuo9vIRsHfHsk=.png"></p>
<h2 id="Community"><a href="#Community" class="headerlink" title="Community"></a>Community</h2><p>這個頁面大多數會有人分享其他惡意程式檢測平台的 Report </p>
<p><img src="/assets/KXXwfCJI5ITKqJD8oFD6YiINevnuM8DAk7YjVPM9kG0=.png"></p>
<hr>
<h1 id="ANY-RUN"><a href="#ANY-RUN" class="headerlink" title="ANY.RUN"></a>ANY.RUN</h1><p>連結：<a target="_blank" rel="noopener" href="https://any.run/">https://any.run/</a></p>
<p>ANY.RUN 是一個互動式線上惡意程式沙箱，允許使用者在受控的虛擬環境中動態執行可疑檔案或網址，觀察其行為、網路活動、檔案／登錄表操作等等</p>
<p><img src="/assets/-ipWo-VWZ1bBq9M0ip9AO1AW3ijwawfUVE_86kzXMPU=.png"></p>
<p>如果要使用它的沙箱功能，就像 VirusTotal 一樣可以直接丟惡意程式進去分析的話，會需要先註冊帳戶，如果不想註冊的話，可以直接前往 <a target="_blank" rel="noopener" href="https://app.any.run/submissions">https://app.any.run/submissions</a> 並使用 Hash 查詢有沒有人之前丟過的惡意程式</p>
<p>假設我查詢 hash 為 <code>ced525930c76834184b4e194077c8c4e7342b3323544365b714943519a0f92af</code> 的惡意程式</p>
<p><img src="/assets/wf3oQc9EpL8An_hXnvPKekdTlcrO5clXLA2HHXto9Gs=.png"></p>
<p>然後點選其中一個，也可以進入到沙箱分析結果頁面</p>
<p><img src="/assets/rgOQ9BgqW3CpsBVaEnONX00EBqyz8ce9z1Eoq5GmGQE=.png"></p>
<p>這邊介紹一下 Report 介面，首先可以先看右邊的功能列，功能包含你可以下載這個惡意程式，以及在惡意程式啟動時執行了什麼行為</p>
<p><img src="/assets/Pb8iPUJignS3owgETQh_oKV0DrQJy8eDm7t2yfmFQx0=.png"></p>
<p>如果想要詳細分析其中一個檔案，點擊他就會出現詳細訊息</p>
<p><img src="/assets/uDYCE6z7kaaGJyXNgruAqM7W3SB-CmNOx9XFiV8wLcY=.png"></p>
<p>點選 More Info 之後就會進入到這個程式的完整分析內容</p>
<p><img src="/assets/TuHLpPHsOnJkkZGA_e4CjCrF45L98ZXRK9mWvHOIq9s=.png"></p>
<p>這個頁面有一個很方便的功能，它會列出惡意程式行為的嚴重程度，假設我想要了解 <code>T1053.005 Scheduled Task (1)</code> 這個行為，並且想要知道它下的 Cmdline，可以點擊下方的 <code>Uses Task Scheduler to run other applications</code> 就會跳出視窗並顯示詳細內容</p>
<p><img src="/assets/ZL3yijW5pBAeEDHXbe6EVXN0sc9pld1JxCrkcPeBQDo=.png"></p>
<p>回到分析主頁，下方是顯示 Network 相關分析結果，也有看檔案操作的頁面</p>
<p><img src="/assets/yyT6D73zz3KtGYHdOElmGIztskP0I4j4MQNd2N0-Rj8=.png"></p>
<hr>
<h1 id="MalwareBazaar"><a href="#MalwareBazaar" class="headerlink" title="MalwareBazaar"></a>MalwareBazaar</h1><p>連結：<a target="_blank" rel="noopener" href="https://bazaar.abuse.ch/browse/">https://bazaar.abuse.ch/browse/</a></p>
<p>MalwareBazaar 是由 abuse.ch 所運營的惡意軟體樣本分享平台，旨在讓資安研究人員、antivirus 廠商、威脅情報團隊能夠更容易地交換與取得惡意軟體樣本，如果有想要查詢的惡意程式可以來這個網站查</p>
<p><img src="/assets/WjzEU8V90NjOlZCZa8f61be1PPxTNpUIJ-_39gDptlo=.png"></p>
<p>它有一個查詢的語法，需要照著它的語法不然會找不到</p>
<pre class="line-numbers language-none"><code class="language-none">Search syntax is as follow: keyword:search_term

Following is a list of accepted keywords along with an example search_term

md5:1b109efade90ace7d953507adb1f1563 ( run)
sha256:11b16ba733f2f4f10ac58021eecaf5668551a73e2a1acfae99745c50bfccbb44 ( run)
signature:CobaltStrike ( run)
tag:TA505 ( run)
file_type:rtf ( run)
user:malware_traffic ( run)
clamav:SecuriteInfo.com.Artemis1FBB04F6EAF7.17086.UNOFFICIAL ( run)
yara:win_asyncrat_j1 ( run)
serial_number:51CD5393514F7ACE2B407C3DBFB09D8D ( run)
issuer_cn:Sectigo RSA Code Signing CA ( run)
imphash:756fdea446bc618b4804509775306c0d ( run)
tlsh:8DD484F440EF10A2F25F852936ADBE9401B2B1C7DBDA5E08137DE5311BBDA633A0564D ( run)
telfhash:52d0a7c198b4972c99e60578ed5c5bb29106216620070b20cf10a5d4d83b440f40db59 ( run)
gimphash:b43f35a8610180bcb184238555a0858a6c160a2d872566e7e9633221308b34fd ( run)
dhash_icon:f8dcbeffbffecee8 ( run)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>假設我現在要查sha256 是<code>ced525930c76834184b4e194077c8c4e7342b3323544365b714943519a0f92af</code> 的惡意程式</p>
<p><img src="/assets/h5BRvZtDGV6UzkjnyWHJoiFVyPj1qiOAVfCeJ7KTCa8=.png"></p>
<p>這樣就成功找到了，首先會列出基本的訊息</p>
<p><img src="/assets/dhEkCdxVv7tqQkAy65vx9ZPsWCww_ZVAfR4ES2eojPM=.png"></p>
<p>這個網站不錯的地方是它會去整理各大惡意程式檢測平台的 Report，並列出來 Report 網址或者檢測結果</p>
<p><img src="/assets/MPS_tDeEXUcke389E3C6h51m7s3_fHIANLYQh00okQ=.png"></p>
<hr>
<h1 id="Malpedia"><a href="#Malpedia" class="headerlink" title="Malpedia"></a>Malpedia</h1><p>連結：<a target="_blank" rel="noopener" href="https://malpedia.caad.fkie.fraunhofer.de/">https://malpedia.caad.fkie.fraunhofer.de/</a></p>
<p>Malpedia 是由 Fraunhofer FKIE所維運的一個「惡意軟體百科 + 參考樣本集」平台，惡意軟體家族百科與研究資源，提供家族描述、別名、已知樣本參考、YARA 規則、相關研究連結。</p>
<p><img src="/assets/2dvHSIedbNMendmEHvAO8F2RepgjV8q_V2Of8pGfZi0=.png"></p>
<p>假設我們剛剛的 XWorm 惡意程式，可以直接在搜尋欄打上 XWorm</p>
<p><img src="/assets/QbiEpyzJnEPDzDRdwNEz7JdUil3UzOlx_OD_1ug3E_8=.png"></p>
<p>這些皆是針對於 XWorm 的研究，可以點進去參考</p>
<p>另外也可以尋找這是哪個組織發出來的</p>
<p>可以在 Family 頁面中搜尋 XWorm</p>
<p><img src="/assets/NSHxGJOQdrVMnCIB7qpIba_49beBljRTv3kp9hmIss=.png"></p>
<p>點進去後可以看到這隻惡意程式相關的訊息，包含 Actor</p>
<p><img src="/assets/w6h7nMg7-aII3T313yGWoVOqf72mqCKIPX7RPRfIQZU=.png"></p>
<p>那這邊就可以看到 Actor 是 <code>Hive0137</code> </p>
<p>點擊後可以看到該 Actor 的相關資訊</p>
<p><img src="/assets/QzHW9EOxvKz5xMAcFYHqeUAO6nFinJiYTmo4Tdfx9cc=.png"></p>
<hr>
<h1 id="Triage"><a href="#Triage" class="headerlink" title="Triage"></a>Triage</h1><p>連結： <a target="_blank" rel="noopener" href="https://tria.ge/reports/public">https://tria.ge/reports/public</a></p>
<p>Triage 是由 Hatching 提供的線上惡意程式沙箱台，用來自動執行、分析可疑檔案並生成行為報告，協助安全分析師快速篩選與分類威脅樣本。</p>
<p><img src="/assets/tur58FvV11eeExk1BKcPqd2fqstHnhwZd39997p7hCI=.png"></p>
<p>它可以像 VirusTotal 一樣上傳惡意程式並分析或者搜尋之前已經上傳過的惡意程式</p>
<p>搜尋的方式就是點選右上角的 Search 後也是可以用 Hash 搜尋</p>
<p><img src="/assets/fgbYNIkhdgIgR5syn8hEHZAzsxh33-q_IKZMooswMmI=.png"></p>
<p>點進去後就會出現分析報告</p>
<p><img src="/assets/LSq6C5CnL3srr-davFhRkk2fxAeZAvhPQnt6kGkVyAk=.png"></p>
<p>而如果是要上傳惡意程式，需要先進行登入，登入後上面列的 Submit 是上傳惡意程式的頁面</p>
<p><img src="/assets/XLiYnj_Z4f0BPL-Azp2DnSM75KXVZGJUKYSCCspUbus=.png"></p>
<p>上傳完後也會出現 Report 的頁面</p>
<p>Report 頁面有包含</p>
<ul>
<li>環境與 metadata</li>
<li>樣本基本資訊（雜湊、大小、評分、標籤）</li>
<li>提取出的惡意設定（C2、安裝位置、檔案名）</li>
<li>偵測簽章 &#x2F; 行為標記</li>
<li>進程行為</li>
<li>網路行為</li>
<li>MITRE ATT&amp;CK 對應技術</li>
<li>可下載的記憶體 &#x2F; 生成檔案</li>
</ul>
<hr>
<h1 id="為什麼需要多方參考？"><a href="#為什麼需要多方參考？" class="headerlink" title="為什麼需要多方參考？"></a>為什麼需要多方參考？</h1><p>這邊舉一個例子<a target="_blank" rel="noopener" href="https://cyberdefenders.org/blueteam-ctf-challenges/icedid/"> CyberDefender IcedID</a></p>
<blockquote>
<p>Q5 : Could you specify the threat actor linked to the sample provided?</p>
</blockquote>
<p>在 <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/d86405130184186154daa4a5132dd1364ab05d1f14034c7f0a0cda690a91116d/behavior">VirusTotal</a> 中沒有關於 threat actor 的線索，但它有偵測到惡意軟體的 Family 是 <strong>IcedID</strong></p>
<p>因此可以去我們剛剛介紹到的 <a target="_blank" rel="noopener" href="https://malpedia.caad.fkie.fraunhofer.de/details/win.icedid">Malpedia</a> 尋找相關線索</p>
<p><img src="/assets/Aug_2ivQYiQDV_m94jHTrm8tplsH8oivmSwJKqQwSmQ=.png"></p>
<blockquote>
<p>Q6 : In the Execution phase, what function does the malware employ to fetch extra payloads onto the system?</p>
</blockquote>
<p>如果去 <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/d86405130184186154daa4a5132dd1364ab05d1f14034c7f0a0cda690a91116d/behavior">VirusTotal</a> 看的話會找不太到答案是什麼，但是去 <a target="_blank" rel="noopener" href="https://tria.ge/250903-lnktqaap7v">Triage</a> 一下就看到了答案是 <code>URLDownloadToFileA</code> </p>
<p><img src="/assets/wdadI6YwpcvvD1IPJqAb3H7bHP8hAUzgawiw3tp1HPo=.png"></p>
<hr>
<h1 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h1><p>今天介紹了幾個常用的惡意軟體檢測與分析平台，透過多平台分析找出惡意程式的行為與資訊，並且省去自行逆向的時間。</p>
</div></article></div></main><footer><div class="paginator"></div><div class="copyright"><p>© 2025 - 2026 <a href="https://yunshiuan.com">yunshiuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-clike.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cpp.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
</script><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>