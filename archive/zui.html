<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> ZED USER INTERFACE Â· yunshiuan</title><meta name="description" content="ZED USER INTERFACE - yunshiuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/assets/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/prism-line-numbers.css"><link rel="search" type="application/opensearchdescription+xml" href="https://yunshiuan.com/atom.xml" title="yunshiuan"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="yunshiuan" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/assets/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="https://github.com/YunshiuanOAO" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/assets/CV.pdf" target="_self" class="nav-list-link">CV</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">ZED USER INTERFACE</h1><div class="post-info">Oct 1, 2025</div><div class="post-content"><h1 id="ğŸ§‚-å‰è¨€"><a href="#ğŸ§‚-å‰è¨€" class="headerlink" title="ğŸ§‚ å‰è¨€"></a>ğŸ§‚ å‰è¨€</h1><p>ä»Šå¤©æœƒä»‹ç´¹å¦ä¸€å€‹network forensic å·¥å…·-Zui ï¼Œå¦å¤–ä¹Ÿæœƒä»‹ç´¹ä¸€ä¸‹ Zui ç•¶ä¸­ä½¿ç”¨åˆ°çš„ Zeek èˆ‡ä»¥åŠSuricata pcap åˆ†æå·¥å…· </p>
<hr>
<h1 id="Zui"><a href="#Zui" class="headerlink" title="Zui"></a>Zui</h1><p>ä¸‹è¼‰é€£çµï¼š<a target="_blank" rel="noopener" href="https://zui.brimdata.io/docs">https://zui.brimdata.io/docs</a></p>
<p>Zui å®ƒçš„å‰èº«æ˜¯Brim ï¼Œ æ˜¯ä¸€æ¬¾ç”¨æ–¼ç¶²è·¯æµé‡åˆ†æçš„å·¥å…·ï¼Œå®ƒæä¾›äº†ä½¿ç”¨è€…å‹å–„çš„åœ–å½¢åŒ–ä»‹é¢ï¼Œå¯ä»¥è®“ä½¿ç”¨è€…èƒ½å¤ å¿«é€Ÿåˆ†æèˆ‡è¦–è¦ºåŒ–å¤§é‡ç¶²è·¯æµé‡</p>
<p><img src="/assets/aEB_E59Bb6Ghcjk57wLkzd5kCFR_ATktueWQUMrKugE=.png"></p>
<p>é€™å€‹å·¥å…·è£¡é¢æ•´åˆäº†å…©å€‹ç¶²è·¯å°åŒ…åˆ†æå·¥å…·ï¼Œåˆ†åˆ¥æ˜¯Zeekã€Suricata</p>
<hr>
<h2 id="Zeek"><a href="#Zeek" class="headerlink" title="Zeek"></a>Zeek</h2><p>é€£çµï¼š<a target="_blank" rel="noopener" href="https://github.com/zeek/zeek">https://github.com/zeek/zeek</a></p>
<p>Zeek æ˜¯ä¸€å€‹é–‹æºçš„ç¶²è·¯å®‰å…¨ç›£æ§å·¥å…·ï¼Œä»¥å¼·å¤§çš„è³‡æ–™è¨˜éŒ„åŠŸèƒ½èåã€‚å®ƒèƒ½å°‡åŸå§‹çš„ pcap å°åŒ…æª”è½‰æ›æˆçµæ§‹åŒ–çš„æ—¥èªŒï¼Œæ–¹ä¾¿åœ¨ Zeek å…§æŸ¥è©¢èˆ‡åˆ†æï¼Œå¿«é€Ÿæä¾›ç¶²è·¯è¡Œç‚ºçš„æ¦‚è¦½ã€‚</p>
<p>æŒ‡ä»¤å¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">zeek -C -r B33F50up_blog.pcapng<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä»–æœƒç”¢ç”Ÿä»¥ä¸‹æª”æ¡ˆ</p>
<ul>
<li>conn.log  : è¨˜éŒ„äº†æ‰€æœ‰çš„ç¶²è·¯é€£æ¥</li>
<li>dns.logï¼šè¨˜éŒ„äº†æ‰€æœ‰çš„ DNSæŸ¥è©¢æ´»å‹•</li>
<li>files.logï¼šè¨˜éŒ„äº†é€šé HTTP å‚³è¼¸çš„æª”æ¡ˆ</li>
<li>http.logï¼šé€™æ˜¯ä¸€å€‹ HTTP å”è­°çš„æµé‡æ—¥èªŒï¼Œè¨˜éŒ„äº†ç¶²é ç€è¦½å’ŒAPI è«‹æ±‚</li>
<li>packet_filter.logï¼šè¨˜éŒ„äº†å°åŒ…éæ¿¾å™¨çš„é…ç½®</li>
</ul>
<p><img src="/assets/wEXC7MUEGLZqmjPBWvXxb9gL4cWzTN2L6JHdh9dc1cA=.png"></p>
<p>ä»¥ä¸‹æ˜¯http.log çš„å½¢å¼</p>
<pre class="line-numbers language-none"><code class="language-none">#separator \x09
#set_separator	,
#empty_field	(empty)
#unset_field	-
#path	http
#open	2025-09-27-22-26-52
#fields	ts	uid	id.orig_h	id.orig_p	id.resp_h	id.resp_p	trans_depth	method	host	uri	referrer	version	user_agent	origin	request_body_len	response_body_len	status_code	status_msg	info_code	info_msg	tags	username	password	proxied	orig_fuids	orig_filenames	orig_mime_types	resp_fuids	resp_filenames	resp_mime_types
#types	time	string	addr	port	addr	port	count	string	string	string	string	string	string	string	count	count	count	string	count	string	set[enum]	string	string	set[string]	vector[string]	vector[string]	vector[string]	vector[string]	vector[string]	vector[string]
1754678828.272075	CAuRo91flufxXutAke	100.112.165.2	60665	192.168.1.125	5000	1	GET	192.168.1.125:5000	&#x2F;	-	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	-	0	24859	200	OK	-	-	(empty)	-	-	-	-	-	-	FA9Bk7Ikrr1LVrys	-	text&#x2F;html
1754678857.820963	CIRhMK1X97Z1MzFRD1	100.112.165.2	60676	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	15	727	200	OK	-	-	(empty)	-	-	-	FIUrzJ3sbt6deYBXf3	-	text&#x2F;plain	FyILV9CHbcmUMGtc6	-	text&#x2F;json
1754678865.293310	CZnidTF5LIgaMzbRe	100.112.165.2	60677	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;system	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	141	185	200	OK	-	-	(empty)	-	-	-	Fvs6lg41SIyuYsReh2	-	-	FqFYD91bNrEWRNR501	-	text&#x2F;json
1754679070.738945	CWlCIn4qK2ntw6CuJl	100.112.165.2	60757	192.168.1.125	5000	1	GET	192.168.1.125:5000	&#x2F;	-	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	-	0	24859	200	OK	-	-	(empty)	-	-	-	-	-	-	FG2QH72aF2jeG9CYC9	-	text&#x2F;html
1754679165.228123	C5V1Fn3nYAvFuSQeE	100.112.165.2	60778	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;system	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	141	287	200	OK	-	-	(empty)	-	-	-	FnwtMr2TZ1qIS6LLmj	-	-	Fq827u4xABcX563I21	-	text&#x2F;json
1754679173.669096	CWXpsv3zrBE7Lx66Sg	100.112.165.2	60779	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;system	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	144	13177	200	OK	-	-	(empty)	-	-	-	FxvTqN3Pid7VWQP7y3	-	-	Fi4rGH32Y4P77kznf3	-	text&#x2F;json
1754679180.268390	Co6odn3WTbf9HKGcO6	100.112.165.2	60780	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	15	728	200	OK	-	-	(empty)	-	-	-	FYW00SjDihqYC30xe	-	text&#x2F;plain	FQGbYm3SH1rsO8o9ng	-	text&#x2F;json
1754679196.383809	CGjLWoznypKV0Pgt	100.112.165.2	60809	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	16	738	200	OK	-	-	(empty)	-	-	-	FVCJDglco6ai9lzi4	-	text&#x2F;plain	FB2a4L3x3ZELSSdCQ1	-	text&#x2F;json
1754679223.696243	C0s1KA7ZrfQvnIpj	100.112.165.2	60865	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	30	851	200	OK	-	-	(empty)	-	-	-	FA2p79sD6MkhyaCEb	-	text&#x2F;plain	FwUGICEULGQRyBs78	-	text&#x2F;json
1754679257.891805	CtwrhY2Kw9bscBOsX7	100.112.165.2	60874	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	34	755	200	OK	-	-	(empty)	-	-	-	FybSTDKXBk5dCiaYl	-	text&#x2F;plain	F55jsD1S1vWW8IVBY4	-	text&#x2F;json
1754679265.650887	CFgfqH2IasZxXsovkd	100.112.165.2	60875	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	30	869	200	OK	-	-	(empty)	-	-	-	FtvRcZ3D5kRIP1ijy5	-	text&#x2F;plain	FTYdr5iKtJX11Efma	-	text&#x2F;json
1754679315.090163	CEAuN63ly0lHS2zRrj	100.112.165.2	60895	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	30	869	200	OK	-	-	(empty)	-	-	-	Fyt7jP30AEKPs4C0Uj	-	text&#x2F;plain	F0zHt852ycC25Gpkf	-	text&#x2F;json
1754679319.217264	CRWcyt2bda4K3g6Xub	100.112.165.2	60912	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	36	900	200	OK	-	-	(empty)	-	-	-	FUAgus1sr4pPeGnidg	-	text&#x2F;plain	FqnOWw20dfXD0koyIi	-	text&#x2F;json
1754679354.845803	CulPOq3A9IP8ab4Zqd	100.112.165.2	60981	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	48	769	200	OK	-	-	(empty)	-	-	-	FZw17aZHAnZltVkJ	-	text&#x2F;plain	FQvAYSOVPIbUCfRm7	-	text&#x2F;json
1754679406.575000	C9iy0scrJKJuDpi07	100.112.165.2	61207	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	49	2621	200	OK	-	-	(empty)	-	-	-	FiejrYnJjwTaJ5db7	-	text&#x2F;plain	FKZoSb4yddnL4uzkZf	-	text&#x2F;json
1754679827.575533	CV2dqm3aNuGOi4EC0h	100.112.165.2	63113	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	36	912	200	OK	-	-	(empty)	-	-	-	FDaXYp2bh8hJpHMYCi	-	text&#x2F;plain	FdsBU41nDrcCQ9mTV9	-	text&#x2F;json
1754679851.757452	CWSzgl4AsTyJVyRpJf	100.112.165.2	63213	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	44	800	200	OK	-	-	(empty)	-	-	-	FAGwfWDdjCLhcrZX2	-	text&#x2F;plain	F89dhl1uFy7r4oRtf	-	text&#x2F;json
1754679859.655497	C0LErP2jTxCqKmUESd	100.112.165.2	63216	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	47	781	200	OK	-	-	(empty)	-	-	-	FoNYJj2QlLyZkd9tEe	-	text&#x2F;plain	FUaGCH2RbcOlDQcaOi	-	text&#x2F;json
1754679875.655339	CqC0qj2SMoQnSfaju6	100.112.165.2	63217	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	31	762	200	OK	-	-	(empty)	-	-	-	FRGjia4iHeyPzIDRC3	-	text&#x2F;plain	FwGgDTGi2gHDik2P5	-	text&#x2F;json
1754679999.499748	CtN1Vk4RrwIRGOgwHc	100.112.165.2	63280	192.168.1.125	5000	1	POST	192.168.1.125:5000	&#x2F;ping	http:&#x2F;&#x2F;192.168.1.125:5000&#x2F;	1.1	Mozilla&#x2F;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;139.0.0.0 Safari&#x2F;537.36	http:&#x2F;&#x2F;192.168.1.125:5000	142	836	200	OK	-	-	(empty)	-	-	-	FFJx4j4PnbpIi0mfD6	-	text&#x2F;plain	FYpDmc37JMpCuz4Zac	-	text&#x2F;json
#close	2025-09-27-22-26-52
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦å¤–ä»–ä¹Ÿæœƒæ ¹æ“š pcap æª”ç”¢ç”Ÿå…¶ä»–log ï¼Œåƒè€ƒç¶²å€ï¼š<a target="_blank" rel="noopener" href="https://docs.zeek.org/en/master/logs/index.html">https://docs.zeek.org/en/master/logs/index.html</a> </p>
<hr>
<h2 id="Suricata"><a href="#Suricata" class="headerlink" title="Suricata"></a>Suricata</h2><p>é€£çµï¼š<a target="_blank" rel="noopener" href="https://suricata.io/">https://suricata.io/</a></p>
<p>Suricata æ˜¯ä¸€å€‹é–‹æºçš„å…¥ä¾µåµæ¸¬ç³»çµ±ï¼ˆIDSï¼‰èˆ‡å…¥ä¾µé˜²ç¦¦ç³»çµ±ï¼ˆIPSï¼‰ï¼Œä»¥æ·±åº¦å°åŒ…æª¢æ¸¬ã€æµé‡åˆ†æèˆ‡å¨è„…åµæ¸¬èåã€‚èƒ½ä½¿ç”¨ Suricata çš„é¾å¤§è¦å‰‡é›†å¿«é€Ÿè©•ä¼°ç¶²è·¯è³‡æ–™ä¸¦è¾¨è­˜ç•°å¸¸ã€‚</p>
<p>æŒ‡ä»¤å¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">suricata -r B33F50up_blog.pcapng <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä»–æœƒç”¢ç”Ÿå››å€‹æª”æ¡ˆ</p>
<ul>
<li>eve.json : Suricataçš„çµæ§‹åŒ–æ—¥èªŒæª”æ¡ˆï¼ŒåŒ…å«å¤šç¨®äº‹ä»¶é¡å‹çš„è©³ç´°è¨˜éŒ„</li>
<li>fast.log : Suricata å¿«é€Ÿè­¦å ±æ—¥èªŒï¼ŒåŒ…å«æª¢æ¸¬åˆ°çš„å®‰å…¨å¨è„…è­¦å ±</li>
<li>stats.log : Suricata é‹è¡Œçµ±è¨ˆè³‡æ–™ï¼ŒåŒ…å«è©³ç´°çš„ç³»çµ±é‹è¡Œçµ±è¨ˆ</li>
<li>suricata.log : Suricata ä¸»è¦é‹è¡Œæ—¥èªŒï¼ŒåŒ…å«ç³»çµ±å•Ÿå‹•å’Œé‹è¡Œè³‡è¨Š</li>
</ul>
<p><img src="/assets/5LROwbAnig-tGtRpsi7V6Ig8OL3X9F9e3CxpqHcjWvs=.png"></p>
<p>ä»¥ä¸‹æ˜¯ fast.log è³‡è¨Š</p>
<pre class="line-numbers language-none"><code class="language-none">08&#x2F;09&#x2F;2025-02:53:47.165861  [**] [1:2019284:3] ET ATTACK_RESPONSE Output of id command from HTTP server [**] [Classification: Potentially Bad Traffic] [Priority: 2] &#123;TCP&#125; 192.168.1.125:5000 -&gt; 100.112.165.2:60865
08&#x2F;09&#x2F;2025-02:56:49.767871  [**] [1:2002034:13] ET ATTACK_RESPONSE Possible &#x2F;etc&#x2F;passwd via HTTP (linux style) [**] [Classification: Information Leak] [Priority: 2] &#123;TCP&#125; 192.168.1.125:5000 -&gt; 100.112.165.2:61207<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<p>ç¸½çµä¾†èªª Zui çš„åšæ³•æ˜¯å…ˆç”¨ <a target="_blank" rel="noopener" href="https://github.com/brimdata/brimcap">brimcap</a> å°‡ pcap é€åˆ° Zeek&#x2F;Suricata åš summary&#x2F;logï¼Œå†åœ¨ Zui å…§ç”¨ correlation viewã€alert è¦–çª—ã€æˆ– detail pane åˆ†æäº‹ä»¶èˆ‡åŸå§‹å°åŒ…ã€‚</p>
<p>æ‰€ä»¥åªè¦å°‡pcap å°åŒ…ä¸Ÿé€²å» zeek ï¼Œä»–å°±æœƒé–‹å§‹é€²è¡Œåˆ†æ</p>
<p><img src="/assets/gyCnmYGl_VfYEuqKAOa8TyKLnNYYC6tohyAziYN13Ck=.png"></p>
<p>åˆ†æå®Œå¾ŒæŒ‰ä¸‹<code>Query Pool</code> å°±å¯ä»¥çœ‹åˆ°è¦–è¦ºåŒ–çš„é é¢</p>
<p><img src="/assets/aEB_E59Bb6Ghcjk57wLkzd5kCFR_ATktueWQUMrKugE=.png"></p>
<p>å¦å¤– Zui ä½¿ç”¨ Zedï¼ˆæˆ–ç¨± Zed query &#x2F; SuperSQLï¼‰ä¾†åšéæ¿¾èˆ‡è½‰æ›æŸ¥è©¢å¯ä»¥æ›´å¿«è™•ç†å¤§é‡è³‡æ–™</p>
<p>ä»¥ä¸‹åˆ†äº«å¹¾å€‹æ“ä½œ</p>
<p>é¦–å…ˆå¯ä»¥ç¯©é¸å‡ºSuricata è­¦å ±</p>
<pre class="line-numbers language-none"><code class="language-none">event_type&#x3D;&#x3D;&quot;alert&quot; #å¯ç¯©é¸å‡º Suricata è­¦å ±<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/s_W7IAAYyK-10fAyW9KpXLDpZhCSm8jgPMVAQABdehY=.png"></p>
<p>ä¹Ÿæœ‰åƒwireshark ä¸€æ¨£å¯ä»¥ç¯©é¸ ip scr or ip dst </p>
<pre class="line-numbers language-none"><code class="language-none">id.orig_h&#x3D;&#x3D;100.112.165.2 and id.resp_p&#x3D;&#x3D;53 #ä¾†æºip &#x3D; 100.112.165.2 ç›®æ¨™port &#x3D; 53<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/tWu_XB4kP452AJbgpcIQ0vOiRSROoPhmTNH13gBxRPg=.png"></p>
<p>å¦å¤–ä»–ä¹Ÿå¯ä»¥é€²è¡Œçµ±è¨ˆèˆ‡æ’åº</p>
<pre class="line-numbers language-none"><code class="language-none">count() by id.resp_p | sort -r  # å°ç›®æ¨™port é€²è¡Œçµ±è¨ˆï¼Œä¸¦é™å†ªæ’åº<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/assets/mq6sPm0cAJqgKEiREZUwTYXNAvnegIR2DAfkVtRs4GQ=.png"></p>
<p>å°ä½ æƒ³è¦ç¯©é¸çš„è³‡æ–™æŒ‰å³éµå¯ä»¥è‡ªå‹•ç”ŸæˆæŸ¥è©¢æŒ‡ä»¤</p>
<p><img src="/assets/T2wzAhndl8-IWt4PObDgOI8JbPrlO9uiPokk5yl27do=.png"></p>
<p>æœ€å¾Œä¹Ÿå¯ä»¥ä¸‹è¼‰å®˜æ–¹æä¾›é å…ˆå¯«å¥½çš„æŸ¥è©¢</p>
<p>é€£çµï¼š[<a target="_blank" rel="noopener" href="https://github.com/brimdata/brimcap?tab=readme-ov-file#brimcap-queries">https://github.com/brimdata/brimcap?tab=readme-ov-file#brimcap-queries</a></p>
<p>](<a target="_blank" rel="noopener" href="https://github.com/brimdata/brimcap?tab=readme-ov-file#brimcap-queries)%E4%B8%8B%E8%BC%89%E5%BE%8Cqueries.json">https://github.com/brimdata/brimcap?tab=readme-ov-file#brimcap-queries)ä¸‹è¼‰å¾Œqueries.json</a> å¾ŒæŒ‰ä¸‹+çš„è—è‰²æŒ‰éˆ•ï¼Œé»é¸Import Queries</p>
<p><img src="/assets/777onBmZHXrrhqyTl2BNjPp328hH_BsS0lh761qK6Aw=.png"></p>
<p>æŠŠå‰›å‰›ä¸‹è¼‰çš„json æª”ä¸Ÿé€²å»ï¼Œå°±æœƒåŒ¯å…¥é å…ˆå¯«å¥½çš„query </p>
<p><img src="/assets/kndUjYMJJCjbP4n4KenQWusY9yA4lv4sKzYL_6Ke0lA=.png"></p>
<hr>
<h1 id="ç¸½çµ"><a href="#ç¸½çµ" class="headerlink" title="ç¸½çµ"></a>ç¸½çµ</h1><p>ä»Šå¤©ä»‹ç´¹äº†Zui ä»¥åŠå…¶ä¸­Zeek èˆ‡SuricataåŠŸèƒ½ï¼Œä¹Ÿæœ‰åˆ†äº«zui çš„åŸºæœ¬æ“ä½œï¼Œzui åœ¨è§£ä¸€äº›CTF é¡Œæ™‚ä¹Ÿæœƒæœ‰å¥‡æ•ˆï¼Œé›–ç„¶æ²’è¾¦æ³•æŸ¥çœ‹è©³ç´°å°åŒ…å…§å®¹ï¼Œä½†åœ¨å¿«é€ŸæŸ¥è©¢å¯ç–‘è¡Œç‚ºæˆ–å¯ç–‘æµé‡æ™‚æœƒå¾ˆå¥½ç”¨ã€‚</p>
</div></article></div></main><footer><div class="paginator"></div><div class="copyright"><p>Â© 2025 - 2026 <a href="https://yunshiuan.com">yunshiuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-clike.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cpp.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>Prism.plugins.autoloader.languages_path = 'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
</script><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>